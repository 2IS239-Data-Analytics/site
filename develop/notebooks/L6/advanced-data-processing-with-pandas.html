

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-105019106-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data processing with Pandas, part 2 &mdash; Geo-Python site documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'site',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dealing with errors" href="errors.html" />
    <link rel="prev" title="Lesson overview" href="../../lessons/L6/overview.html" />
    <link href="../../_static/geo-python.css" rel="stylesheet" type="text/css">
     

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Geo-Python
          

          
            
            <img src="../../_static/HY-logo-2017.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2019
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/course-info.html">General info</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/course-info.html#course-meetings-in-period-i">Course meetings in Period I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/course-info.html#instructors">Instructors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/course-info.html#lecturers">Lecturers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/course-info.html#course-assistants">Course assistants</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/course-info.html#course-websites">Course websites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/learning-goals.html">Learning goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/grading.html">Grading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/grading.html#general-grading-breakdown">General grading breakdown</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/installing-anacondas.html">Installing Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#install-python-on-windows">Install Python on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#install-python-on-macos">Install Python on macOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#install-python-on-linux">Install Python on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#installing-packages-using-conda">Installing packages using Conda</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/installing-anacondas.html#the-easiest-way">The easiest way</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/installing-anacondas.html#installing-jupyter-lab-using-conda">Installing Jupyter Lab using conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/installing-anacondas.html#alternative-way-to-install-packages-if-typical-doesn-t-work">Alternative way to install packages if typical doesn’t work</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/python-vocabulary.html">Vocabulary - Basic terms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/python-vocabulary.html#python-vocabulary">Python vocabulary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/python-vocabulary.html#basic-vocabulary-of-version-control">Basic vocabulary of Version Control</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/resources.html">Resources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/resources.html#books">Books</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/resources.html#python-tutorials">Python tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/resources.html#git-github-tutorials">Git + Github tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/licensing.html">License and terms of usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/licensing.html#instructional-materials">Instructional materials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/licensing.html#you-are-free-to">you are free to</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/licensing.html#under-the-following-terms">Under the following terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/licensing.html#notices">Notices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/licensing.html#code-snippets-software">Code snippets / software</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/motivation.html">Motivation for the course</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/motivation.html#effective-data-visualization">Effective data visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/overview.html#lecture-video">Lecture video</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/overview.html#lecture-slides">Lecture slides</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/course-environment-components.html">Course environment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#jupyterlab">JupyterLab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#cloud-computing-environments">Cloud computing environments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#binder">Binder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#csc-notebooks">CSC Notebooks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#using-your-own-computer">Using your own computer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#git-and-github">Git and GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#slack">Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#voting-and-polling">Voting and polling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#page-summary">Page summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/slack-usage.html">Communicating with Slack</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#accessing-the-workspace-in-slack">Accessing the workspace in Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#overview-of-slack">Overview of Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#basic-usage-of-slack">Basic usage of Slack</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/slack-usage.html#notifying-a-user">Notifying a user</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/slack-usage.html#using-threads">Using threads</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#general-guidelines-for-communication">General guidelines for communication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L1/a-taste-of-python.html">A taste of Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/a-taste-of-python.html#General-information">General information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Sources">Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#About-this-document">About this document</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Getting-started">Getting started</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L1/a-taste-of-python.html#Variables,-math-and-functions">Variables, math and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Simple-Python-math">Simple Python math</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Math-operations">Math operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L1/a-taste-of-python.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Combining-functions">Combining functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Variables">Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L1/a-taste-of-python.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Updating-variables">Updating variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Variable-values">Variable values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Data-types">Data types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L1/a-taste-of-python.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Character-input">Character input</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L1/gcp-1-variable-naming.html">Good coding practices - Selecting “good” variable names</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/gcp-1-variable-naming.html#Some-&quot;not-so-good&quot;-variable-names">Some “not-so-good” variable names</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L1/gcp-1-variable-naming.html#Selecting-&quot;good&quot;-variable-names">Selecting “good” variable names</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L1/gcp-1-variable-naming.html#Formatting-&quot;good&quot;-variable-names">Formatting “good” variable names</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/exercise-1.html">Exercise 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/exercise-1.html#part-1-creating-a-github-com-account-and-using-slack">Part 1 - Creating a GitHub.com account and using Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/exercise-1.html#part-2-cooking-up-some-python">Part 2 - Cooking up some Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/exercise-1.html#summary-what-to-submit">Summary (what to submit)</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/overview.html#lecture-video">Lecture video</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L2/Python-basic-elements.html">Basic elements of Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L2/Python-basic-elements.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L2/Python-basic-elements.html#Data-types-revisited">Data types revisited</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Let's-start-with-some-data">Let’s start with some data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Reminder:-Data-types-and-their-compatibility">Reminder: Data types and their compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Converting-data-from-one-type-to-another">Converting data from one type to another</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Combining-text-and-numbers">Combining text and numbers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L2/Python-basic-elements.html#Lists-and-indices">Lists and indices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Creating-a-list">Creating a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Index-values">Index values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#A-useful-analog---Bill-the-vending-machine">A useful analog - Bill the vending machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Number-of-items-in-a-list">Number of items in a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Index-value-tips">Index value tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Modifying-list-values">Modifying list values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Data-types-in-lists">Data types in lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Adding-and-removing-values-from-lists">Adding and removing values from lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Appending-to-an-integer?-Not-so-fast...">Appending to an integer? Not so fast…</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Some-other-useful-list-methods">Some other useful list methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Reversing-a-list">Reversing a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Sorting-a-list">Sorting a list</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L2/gcp-2-describing-code.html">Good coding practices - Describing your code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Do-I-need-to-describe-my-code?">Do I need to describe my code?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#But-seriously,-the-Internet-says-I-shouldn't-comment-my-code">But seriously, the Internet says I shouldn’t comment my code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Code-comments">Code comments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Line-comments">Line comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Block-comments">Block comments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Markdown-text">Markdown text</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Data-source">Data source</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html">Introduction to Version Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#familiar">Familiar?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#what-is-version-control">What is version control?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#what-is-git">What is Git?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#what-is-github">What is GitHub?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#relies-on-git">Relies on Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#social-collaborative-network">Social (collaborative) network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#open-source-science">Open source / science</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#online-tools">Online tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#issue-tracking">Issue tracking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#basic-vocabulary">Basic vocabulary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/git-basics.html">Meet Git</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#overview-and-preparations">Overview and preparations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#key-concepts-and-tools">Key concepts and tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#using-git-from-the-command-line">Using Git from the command line</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#clone-a-repository-from-github">Clone a repository from GitHub</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#add-changes-to-the-staging-area">Add changes to the staging area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#commit-changes">Commit changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#publish-your-local-commits-to-github">Publish your local commits to GitHub</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#using-the-jupyterlab-git-plugin">Using the JupyterLab Git plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#preparations-in-the-terminal">Preparations in the Terminal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#stage-changes-in-the-plugin">Stage changes in the plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#commit-changes-in-the-plugin">Commit changes in the plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#pull-and-push-using-the-plugin">Pull and push using the plugin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#if-everything-else-fails">If everything else fails…</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/GitHub-classroom.html">Using Classroom for Github</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/GitHub-classroom.html#classroom-for-github">Classroom for GitHub</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/exercise-2.html">Exercise 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/exercise-2.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/exercise-2.html#exercise-2-hints">Exercise 2 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/exercise-2.html#git">Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/exercise-2.html#list-methods">List methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/exercise-2.html#indentation-woes">Indentation woes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L3/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/overview.html#lecture">Lecture</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/for-loops.html">for loops</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/for-loops.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/for-loops.html#Basics-of-for-loops">Basics of for loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#A-(bad)-example">A (bad) example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#Introducing-the-for-loop">Introducing the for loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#for-loop-format">for loop format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L3/for-loops.html#Your-daily-for-loop">Your daily for loop</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#for-loop-variables">for loop variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#for-loops-and-the-range()-function">for loops and the range() function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L3/for-loops.html#Poll-question-pause">Poll question pause</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#Looping-over-the-length-of-lists-using-index-values">Looping over the length of lists using index values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#Why-bother-looping-over-a-list-by-the-index-value?">Why bother looping over a list by the index value?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L3/for-loops.html#Poll-question-pause">Poll question pause</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/conditional-statements.html">Conditional statements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/conditional-statements.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/conditional-statements.html#Basics-of-conditional-statements">Basics of conditional statements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#A-simple-conditional-statement">A simple conditional statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#Comparison-operators-and-boolean-values">Comparison operators and boolean values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#if,-elif-and-else">if, elif and else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#Combining-conditions">Combining conditions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L3/conditional-statements.html#Combining-for-loops-and-conditional-statements">Combining for-loops and conditional statements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/gcp-3-pep8.html">Good coding practices - writing readable code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/gcp-3-pep8.html#Working-code-vs-readable-code">Working code vs readable code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/gcp-3-pep8.html#PEP-8-Style-Guide">PEP 8 Style Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Maximum-line-length">Maximum line length</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Indentation">Indentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Whitespace-and-binary-operators">Whitespace and binary operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Avoid-extraneous-whitespace">Avoid extraneous whitespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Write-one-statement-per-line">Write one statement per line</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L3/exercise-3.html">Exercise 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/exercise-3.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/exercise-3.html#exercise-3-hints">Exercise 3 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#general-tips">General tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#tests">Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#combining-strings">Combining strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#nested-if-statements">Nested if statements</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L4/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/overview.html#lecture">Lecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/overview.html#id1">Lecture</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L4/functions.html">Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#What-is-a-function?">What is a function?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Anatomy-of-a-function">Anatomy of a function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Our-first-function-(aww...)">Our first function (aww…)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Calling-functions">Calling functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-new-function">Using our new function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Let's-make-another-function">Let’s make another function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-second-function">Using our second function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Functions-within-a-function-(Yo-dawg...)">Functions within a function (Yo dawg…)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-combined-functions">Using our combined functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#An-introduction-to-script-files">An introduction to script files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#The-general-concept-of-a-.py-script-file">The general concept of a .py script file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Getting-started">Getting started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Saving-a-text-file-as-a-Python-file">Saving a text file as a Python file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Saving-and-loading-functions">Saving and loading functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Saving-functions-in-a-script-file">Saving functions in a script file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Calling-functions-from-a-script-file">Calling functions from a script file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Making-sure-we're-in-the-right-working-directory">Making sure we’re in the right working directory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Binder-users">Binder users</a></li>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#CSC-notebooks-users">CSC notebooks users</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Changing-the-working-directory">Changing the working directory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Binder-users">Binder users</a></li>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#CSC-notebooks-users">CSC notebooks users</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Importing-our-script-functions">Importing our script functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-script-functions">Using our script functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Importing-multiple-functions">Importing multiple functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Importing-all-functions-from-a-script">Importing all functions from a script</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Temperature-calculator-(optional,-advanced-topic)">Temperature calculator (<em>optional, advanced topic</em>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Defining-the-function">Defining the function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Adding-some-conditional-statements">Adding some conditional statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Returning-the-result">Returning the result</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Adding-a-docstring">Adding a docstring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Testing-the-new-function">Testing the new function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-the-tempCalculator">Using the tempCalculator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L4/modules.html">Loading and using modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Modules,-packages-and-libraries?">Modules, packages and libraries?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Loading-modules">Loading modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Renaming-imported-modules">Renaming imported modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Importing-a-single-function">Importing a single function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Importing-a-submodule">Importing a submodule</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Using-module-functions">Using module functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#What-should-I-not-do?">What should I not do?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#from-X-import-*">from X import *</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Poor-names-when-renaming-on-import">Poor names when renaming on import</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Extra:-installing-packages">Extra: installing packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L4/writing-scripts.html">Good coding practices - Writing our scripts the “right” way</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Inline-comments">Inline comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Use-line-breaks-wisely">Use line breaks wisely</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Use-a-docstring">Use a docstring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Advanced-topics">Advanced topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/writing-scripts.html#Adding-a-license">Adding a license</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/writing-scripts.html#Starting-with-a-shebang">Starting with a shebang</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Page-summary">Page summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L4/exercise-4.html">Exercise 4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/exercise-4.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/exercise-4.html#exercise-4-hints">Exercise 4 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L4/exercise-4.html#importing-variables-from-a-script">Importing variables from a script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L4/exercise-4.html#counting-values-from-a-list">Counting values from a list</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/overview.html#lecture-videos">Lecture videos</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/pandas-overview.html">What is Pandas?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/pandas-overview.html#easy-to-use-data-structures">Easy-to-use data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/pandas-overview.html#combines-functionalities-from-many-python-modules">Combines functionalities from many Python modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/pandas-overview.html#supports-data-read-write-from-multiple-formats">Supports data read/write from multiple formats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L5/exploring-data-using-pandas.html">Exploring data using Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Input-data:-weather-statistics">Input data: weather statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Reading-a-data-file-with-Pandas">Reading a data file with Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#DataFrame-properties">DataFrame properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Selecting-columns">Selecting columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Descriptive-statistics">Descriptive statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Extra:-Very-basic-plots">Extra: Very basic plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Extra:-From-lists-to-pandas-objects">Extra: From lists to pandas objects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L5/processing-data-with-pandas.html">Processing data with Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Basic-calculations">Basic calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Selecting-rows-and-columns">Selecting rows and columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Filtering-and-updating-data">Filtering and updating data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Dealing-with-missing-data">Dealing with missing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Data-type-conversions">Data type conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Unique-values">Unique values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Sorting-data">Sorting data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Writing-data-to-a-file">Writing data to a file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/exercise-5.html">Exercise 5</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/exercise-5.html#exercise-5-hints-for-pandas">Exercise 5 hints for Pandas</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 6</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L6/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/overview.html#lesson-videos">Lesson videos</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data processing with Pandas, part 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Input-data">Input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Reading-the-data">Reading the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Renaming-columns">Renaming columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Check-dataframe-properties">Check dataframe properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Using-your-own-functions-in-pandas">Using your own functions in pandas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Iterating-over-rows">Iterating over rows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Applying-a-function">Applying a function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Parsing-dates">Parsing dates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#String-slicing">String slicing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#datetime">datetime</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Aggregating-data-in-Pandas-by-grouping">Aggregating data in Pandas by grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Detecting-warm-months">Detecting warm months</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Repeating-the-data-analysis-with-larger-dataset">Repeating the data analysis with larger dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">Dealing with errors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="errors.html#Interpreting-error-messages">Interpreting error messages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="errors.html#Reading-error-messages">Reading error messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="errors.html#Common-errors-and-exceptions">Common errors and exceptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="errors.html#IndexErrors">IndexErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#NameErrors">NameErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#IndentationErrors">IndentationErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#TypeErrors">TypeErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#Other-kinds-of-errors">Other kinds of errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="errors.html#More-information">More information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gcp-assertions.html">Good coding practices - Using assertions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gcp-assertions.html#Assertions">Assertions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gcp-assertions.html#Multiple-assertions">Multiple assertions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gcp-assertions.html#A-bad-example">A bad example</a></li>
<li class="toctree-l4"><a class="reference internal" href="gcp-assertions.html#A-better-example">A better example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gcp-assertions.html#More-information">More information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging your Python code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Source">Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Test-your-code-with-known-outputs">Test your code with known outputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="debugging.html#Testing-with-a-simplified-data-file">Testing with a simplified data file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Make-your-code-crash-quickly-and-regularly">Make your code crash quickly and regularly</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Make-small-changes-and-track-them">Make small changes and track them</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L6/exercise-6.html">Exercise 6</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/exercise-6.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/exercise-6.html#exercise-6-hints">Exercise 6 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#data-format-for-problems-1-3">Data format for problems 1-3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#reading-in-fixed-width-text-files">Reading in fixed-width text files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#skipping-the-second-row-of-a-file">Skipping the second row of a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#joining-data-from-one-dataframe-to-another">Joining data from one DataFrame to another</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Geo-Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Data processing with Pandas, part 2</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/geo-python/site/blob/develop/source/notebooks/L6/advanced-data-processing-with-pandas.ipynb" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  


    
    



    <p class="scv-banner scv-sphinx_rtd_theme"><a href="../../../master/notebooks/L6/advanced-data-processing-with-pandas.html"><b>Warning:</b> This document is for the development version of Geo-Python. The main version is master.</a></p>

<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
This page was generated from <a class="reference external" href="https://github.com/Geo-Python/site/blob/master/source/notebooks/L6/advanced-data-processing-with-pandas.ipynb">source/notebooks/L6/advanced-data-processing-with-pandas.ipynb</a>.
<span class="raw-html"><br/><a href="https://mybinder.org/v2/gh/geo-python/site/master?urlpath=lab/tree/source/notebooks/L6/advanced-data-processing-with-pandas.ipynb"><img alt="Binder badge" src="https://img.shields.io/badge/launch-full%20binder-red.svg" style="vertical-align:text-bottom"></a></span>
<span class="raw-html"><a href="https://mybinder.org/v2/gh/geo-python/notebooks/master?urlpath=lab/tree/notebooks/L6/advanced-data-processing-with-pandas.ipynb"><img alt="Binder badge" src="https://img.shields.io/badge/launch-student%20binder-red.svg" style="vertical-align:text-bottom"></a></span>
<span class="raw-html"><a href="https://notebooks.csc.fi/#/blueprint/df93f30d14e44b51907d135726eb6ef4"><img alt="CSC badge" src="https://img.shields.io/badge/launch-CSC%20notebook-blue.svg" style="vertical-align:text-bottom"></a></span></div>
<div class="section" id="Data-processing-with-Pandas,-part-2">
<h1>Data processing with Pandas, part 2<a class="headerlink" href="#Data-processing-with-Pandas,-part-2" title="Permalink to this headline">¶</a></h1>
<p>This week we will continue developing our skills using <a class="reference external" href="https://pandas.pydata.org/">pandas</a> to process real data.</p>
<p>Case: April 2019 happened to be the second warmest April on record globally. In this lesson, we will use our data manipulation and analysis skills to analyze weather data from Finland, and see if April 2019 was exceptionally warm also here.</p>
<p>We will cover a number of useful techniques in pandas including:</p>
<ul class="simple">
<li>renaming columns</li>
<li>iterating data frame rows and applying functions</li>
<li>data aggregation</li>
<li>repeating the analysis task for several input files</li>
</ul>
<div class="section" id="Input-data">
<h2>Input data<a class="headerlink" href="#Input-data" title="Permalink to this headline">¶</a></h2>
<p>In the lesson this week we are using weather observation data from Finland downloaded from NOAA. We have data for 15 different weather obsercation stations from Finland.</p>
<p><strong>METADATA:</strong></p>
<ul class="simple">
<li>List of available stations: <a class="reference external" href="metadata/6367598020644stn.txt">metadata/6367598020644stn.txt</a></li>
<li>More details about weather observatios per station: <a class="reference external" href="metadata/6367598020644inv.txt">metadata/6367598020644inv.txt</a></li>
<li>Data description (column names): <a class="reference external" href="metadata/3505doc.txt">metadata/3505doc.txt</a></li>
</ul>
<p>The input data for this week is separated with varying amount of spaces (fixed width). The first lines and columns of the data looks like following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">USAF</span>  <span class="n">WBAN</span> <span class="n">YR</span><span class="o">--</span><span class="n">MODAHRMN</span> <span class="n">DIR</span> <span class="n">SPD</span> <span class="n">GUS</span> <span class="n">CLG</span> <span class="n">SKC</span> <span class="n">L</span> <span class="n">M</span> <span class="n">H</span>  <span class="n">VSB</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">W</span> <span class="n">TEMP</span> <span class="n">DEWP</span>    <span class="n">SLP</span>  <span class="o">...</span> <span class="n">SD</span>
<span class="mi">028360</span> <span class="mi">99999</span> <span class="mi">191701010600</span> <span class="mi">360</span>   <span class="mi">5</span> <span class="o">***</span> <span class="o">***</span> <span class="n">SCT</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">0.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>    <span class="mi">3</span> <span class="o">****</span>  <span class="mf">986.0</span>  <span class="o">...</span> <span class="o">**</span>
<span class="mi">028360</span> <span class="mi">99999</span> <span class="mi">191701011300</span> <span class="o">***</span>   <span class="mi">0</span> <span class="o">***</span> <span class="o">***</span> <span class="n">OVC</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">0.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>  <span class="o">-</span><span class="mi">14</span> <span class="o">****</span>  <span class="mf">986.6</span>  <span class="o">...</span> <span class="o">**</span>
<span class="mi">028360</span> <span class="mi">99999</span> <span class="mi">191701012000</span> <span class="o">***</span>   <span class="mi">0</span> <span class="o">***</span> <span class="o">***</span> <span class="n">BKN</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">0.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="o">-</span><span class="mi">7</span> <span class="o">****</span>  <span class="mf">986.6</span>  <span class="o">...</span> <span class="o">**</span>
<span class="mi">028360</span> <span class="mi">99999</span> <span class="mi">191701020600</span> <span class="mi">360</span>   <span class="mi">2</span> <span class="o">***</span> <span class="o">***</span> <span class="n">OVC</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">0.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>  <span class="o">-</span><span class="mi">14</span> <span class="o">****</span>  <span class="mf">984.7</span>  <span class="o">...</span> <span class="o">**</span>
</pre></div>
</div>
<p><strong>We will develop our analysis workflow using data for one station. Then’ we will repeat the same process for all the stations.</strong></p>
</div>
<div class="section" id="Reading-the-data">
<h2>Reading the data<a class="headerlink" href="#Reading-the-data" title="Permalink to this headline">¶</a></h2>
<p>In order to get startet, let’s import pandas:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<p>At this point, you should have already had a look at the input file and how it is structured. We can notice at least two things we need to consider when reading in the data:</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>NOTE: Input data structure</strong></p>
<ul class="simple">
<li><strong>Delimiter:</strong> The data are <strong>separated with varying amount of spaces</strong>. If you check out the documentation for the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">read_csv() method</a>, you can see that there are two different ways of doing this. We can either use the <code class="docutils literal notranslate"><span class="pre">sep</span></code> or <code class="docutils literal notranslate"><span class="pre">delim_whitespace</span></code> parameter; <code class="docutils literal notranslate"><span class="pre">sep='\s+'</span></code> or <code class="docutils literal notranslate"><span class="pre">delim_whitespace=True</span></code> but not both. In this case, we prefer to use <code class="docutils literal notranslate"><span class="pre">delim_whitespace</span></code>.</li>
<li><strong>No Data values:</strong> No data values in the NOAA data are coded with varyingg number of <code class="docutils literal notranslate"><span class="pre">*</span></code>. We can tell pandas to consider those characters as NaNs by specifying <code class="docutils literal notranslate"><span class="pre">na_values=['*',</span> <span class="pre">'**',</span> <span class="pre">'***',</span> <span class="pre">'****',</span> <span class="pre">'*****',</span> <span class="pre">'******']</span></code>.</li>
</ul>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fp</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029350.txt&quot;</span>

<span class="c1"># Read data using varying amount of spaces as separator and specifying * characters as NoData values</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\HYapp\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py:3058: DtypeWarning: Columns (29,30,31) have mixed types. Specify dtype option on import or set low_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)
</pre></div></div>
</div>
<ul class="simple">
<li>Let’s see how the data looks by printing the first five rows with <code class="docutils literal notranslate"><span class="pre">head()</span></code> function</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    USAF   WBAN  YR--MODAHRMN    DIR  SPD  GUS  CLG  SKC   L   M ...    SLP  \
0  29350  99999  191701010600  320.0  5.0  NaN  NaN  CLR NaN NaN ...  993.2
1  29350  99999  191701011300  320.0  7.0  NaN  NaN  CLR NaN NaN ...  995.1
2  29350  99999  191701012000  320.0  5.0  NaN  NaN  SCT NaN NaN ...  996.8
3  29350  99999  191701021300    NaN  0.0  NaN  NaN  OVC NaN NaN ...  996.7
4  29350  99999  191701022000    NaN  0.0  NaN  NaN  CLR NaN NaN ...  997.0

   ALT  STP  MAX  MIN  PCP01  PCP06  PCP24  PCPXX  SD
0  NaN  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN
1  NaN  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN
2  NaN  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN
3  NaN  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN
4  NaN  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN

[5 rows x 33 columns]
</pre></div></div>
</div>
<p>All seems ok. However, we won’t be needing all of the 33 columns for detecting warm temperatures in April. We can check all column names by running <code class="docutils literal notranslate"><span class="pre">data.columns</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;USAF&#39;, &#39;WBAN&#39;, &#39;YR--MODAHRMN&#39;, &#39;DIR&#39;, &#39;SPD&#39;, &#39;GUS&#39;, &#39;CLG&#39;, &#39;SKC&#39;, &#39;L&#39;,
       &#39;M&#39;, &#39;H&#39;, &#39;VSB&#39;, &#39;MW&#39;, &#39;MW.1&#39;, &#39;MW.2&#39;, &#39;MW.3&#39;, &#39;AW&#39;, &#39;AW.1&#39;, &#39;AW.2&#39;,
       &#39;AW.3&#39;, &#39;W&#39;, &#39;TEMP&#39;, &#39;DEWP&#39;, &#39;SLP&#39;, &#39;ALT&#39;, &#39;STP&#39;, &#39;MAX&#39;, &#39;MIN&#39;, &#39;PCP01&#39;,
       &#39;PCP06&#39;, &#39;PCP24&#39;, &#39;PCPXX&#39;, &#39;SD&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<p>Description for all these columns is available in the metadata file <a class="reference external" href="metadata/3505doc.txt">metadata/3505doc.txt</a>.</p>
<p><strong>Let’s read in the data one more time.</strong> This time, we will read in only some of the columns using the <code class="docutils literal notranslate"><span class="pre">usecols</span></code> parameter. Let’s read in columns that might be somehow useful to our analysis, or at least that contain some values that are meaningful to us, including the station name, timestamp, and data about wind and temperature: <code class="docutils literal notranslate"><span class="pre">'USAF','YR--MODAHRMN',</span> <span class="pre">'DIR',</span> <span class="pre">'SPD',</span> <span class="pre">'GUS','TEMP',</span> <span class="pre">'MAX',</span> <span class="pre">'MIN'</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;USAF&#39;</span><span class="p">,</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">,</span> <span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">],</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>USAF</th>
      <th>YR--MODAHRMN</th>
      <th>DIR</th>
      <th>SPD</th>
      <th>GUS</th>
      <th>TEMP</th>
      <th>MAX</th>
      <th>MIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29350</td>
      <td>191701010600</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29350</td>
      <td>191701011300</td>
      <td>320.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350</td>
      <td>191701012000</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>-8.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350</td>
      <td>191701021300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350</td>
      <td>191701022000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-12.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Okay so we can see that the data was successfully read to the DataFrame and we also seemed to be able to convert the asterix (*) characters into <code class="docutils literal notranslate"><span class="pre">NaN</span></code> -values.</p>
</div>
<div class="section" id="Renaming-columns">
<h2>Renaming columns<a class="headerlink" href="#Renaming-columns" title="Permalink to this headline">¶</a></h2>
<p>Check again the column names in our DataFrame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;USAF&#39;, &#39;YR--MODAHRMN&#39;, &#39;DIR&#39;, &#39;SPD&#39;, &#39;GUS&#39;, &#39;TEMP&#39;, &#39;MAX&#39;, &#39;MIN&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<p>The column names that we have are somewhat ackward. Let’s change them into more intuitive ones. This can be done easily using the <code class="docutils literal notranslate"><span class="pre">rename()</span></code> -method and a dictionary that lists old and new column names.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Dictionaries</strong></p>
<p><a class="reference external" href="https://docs.python.org/2/tutorial/datastructures.html#dictionaries">Dictionary</a> is a spesific data structure in Python for storing key-value pairs. During this course, we will use dictionaries mainly when renaming columns in a pandas series, but dictionaries are useful for many different purposes! For more information about Python dictionaries, check out <a class="reference external" href="https://realpython.com/python-dicts/">this tutorial</a>.</p>
</div>
<p>We can define the new column names using a <a class="reference external" href="https://www.tutorialspoint.com/python/python_dictionary.htm">dictionary</a> where we determine “<code class="docutils literal notranslate"><span class="pre">key:</span> <span class="pre">value</span></code>” -pairs, in which the original column name (the one which will be replaced) is the key, and the new column name is the value.</p>
<ul class="simple">
<li>Let’s change:</li>
<li><code class="docutils literal notranslate"><span class="pre">YR--MODAHRMN</span></code> column into <code class="docutils literal notranslate"><span class="pre">TIME</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">SPD</span></code> into <code class="docutils literal notranslate"><span class="pre">SPEED</span></code>, and</li>
<li><code class="docutils literal notranslate"><span class="pre">GUS</span></code> into <code class="docutils literal notranslate"><span class="pre">GUST</span></code></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create the dictionary with old and new names</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">:</span> <span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">:</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">:</span> <span class="s1">&#39;GUST&#39;</span><span class="p">}</span>

<span class="c1"># Let&#39;s see what they look like and what is the type</span>
<span class="k">print</span><span class="p">(</span><span class="n">new_names</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new_names</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;SPD&#39;: &#39;SPEED&#39;, &#39;YR--MODAHRMN&#39;: &#39;TIME&#39;, &#39;GUS&#39;: &#39;GUST&#39;}
&lt;class &#39;dict&#39;&gt;
</pre></div></div>
</div>
<p>From above we can see that we have successfully created a dictionary that is of type <code class="docutils literal notranslate"><span class="pre">dict</span></code>.</p>
<ul class="simple">
<li>Now we can change the column names by passing that dictionary into parameter <code class="docutils literal notranslate"><span class="pre">columns</span></code> in <code class="docutils literal notranslate"><span class="pre">rename()</span></code> -function.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Rename the columns</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_names</span><span class="p">)</span>

<span class="c1"># Print the new columns</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;USAF&#39;, &#39;TIME&#39;, &#39;DIR&#39;, &#39;SPEED&#39;, &#39;GUST&#39;, &#39;TEMP&#39;, &#39;MAX&#39;, &#39;MIN&#39;], dtype=&#39;object&#39;)
</pre></div></div>
</div>
<p>Perfect, now our column names are more easy to understand and use.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>TASK: Renaming columns</strong></p>
<p>The temperature values are again in Fahrenheit. As you might guess, we will soon convert these temperatures in to Celsius. In order to avoid confusion with the columns, rename column <code class="docutils literal notranslate"><span class="pre">TEMP</span></code> into <code class="docutils literal notranslate"><span class="pre">TEMP_F</span></code>. Also, we could rename <code class="docutils literal notranslate"><span class="pre">USAF</span></code> as<code class="docutils literal notranslate"><span class="pre">STATION_NUMBER</span></code>.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create the dictionary with old and new names</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;USAF&#39;</span><span class="p">:</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">:</span> <span class="s1">&#39;TEMP_F&#39;</span><span class="p">}</span>

<span class="c1"># Rename the columns</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_names</span><span class="p">)</span>

<span class="c1"># Check the output</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29350</td>
      <td>191701010600</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29350</td>
      <td>191701011300</td>
      <td>320.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350</td>
      <td>191701012000</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>-8.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350</td>
      <td>191701021300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350</td>
      <td>191701022000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-12.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Check-dataframe-properties">
<h2>Check dataframe properties<a class="headerlink" href="#Check-dataframe-properties" title="Permalink to this headline">¶</a></h2>
<p>As we learned last week, it’s always a good idea to check basic properties of the input data before proceeding with data analysis. Let’s check:</p>
<ul class="simple">
<li>How many rows and columns we have:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(559667, 8)
</pre></div>
</div>
</div>
<ul class="simple">
<li>Top and bottom rows:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29350</td>
      <td>191701010600</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29350</td>
      <td>191701011300</td>
      <td>320.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350</td>
      <td>191701012000</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>-8.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350</td>
      <td>191701021300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350</td>
      <td>191701022000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-12.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>559662</th>
      <td>29350</td>
      <td>201910012220</td>
      <td>990.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>37.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>559663</th>
      <td>29350</td>
      <td>201910012250</td>
      <td>990.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>37.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>559664</th>
      <td>29350</td>
      <td>201910012300</td>
      <td>260.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>38.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>559665</th>
      <td>29350</td>
      <td>201910012320</td>
      <td>990.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>37.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>559666</th>
      <td>29350</td>
      <td>201910012350</td>
      <td>990.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>37.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<ul class="simple">
<li>Data types of the columns:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>STATION_NUMBER      int64
TIME                int64
DIR               float64
SPEED             float64
GUST              float64
TEMP_F            float64
MAX               float64
MIN               float64
dtype: object
</pre></div>
</div>
</div>
<ul class="simple">
<li>Descriptive statistics:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
       STATION_NUMBER          TIME            DIR          SPEED  \
count        559667.0  5.596670e+05  519843.000000  553514.000000
mean          29350.0  2.002912e+11     282.237183       6.235060
std               0.0  1.800321e+09     247.127478       4.216836
min           29350.0  1.917010e+11       1.000000       0.000000
25%           29350.0  2.001122e+11     140.000000       3.000000
50%           29350.0  2.008061e+11     220.000000       6.000000
75%           29350.0  2.013110e+11     320.000000       9.000000
max           29350.0  2.019100e+11     990.000000      66.000000

              GUST         TEMP_F           MAX           MIN
count  9916.000000  555794.000000  30271.000000  30268.000000
mean     21.325534      39.039754     43.731030     32.457975
std       7.367612      18.833681     19.378822     18.427926
min      11.000000     -37.000000    -28.000000    -48.000000
25%      15.000000      28.000000     30.000000     23.000000
50%      21.000000      39.000000     43.000000     33.000000
75%      26.000000      54.000000     60.000000     46.000000
max      54.000000      95.000000     94.000000     81.000000
</pre></div></div>
</div>
<p>Here we can see that there are varying number of observations per column (see the <code class="docutils literal notranslate"><span class="pre">count</span></code> -information), because some of the columns have missing values.</p>
</div>
<div class="section" id="Using-your-own-functions-in-pandas">
<h2>Using your own functions in pandas<a class="headerlink" href="#Using-your-own-functions-in-pandas" title="Permalink to this headline">¶</a></h2>
<p>Now it’s again time to convert temperatures from Fahrenheit to Celsius! Yes, we have already done this many times before, but this time we will learn how to apply self-made functions to data in a pandas DataFrame. <strong>In short, our task is to define a function for the temperature conversion, and to apply this function for each Celsius value on each row of the DataFrame. Output celsius values should be stored in a new column called</strong> <code class="docutils literal notranslate"><span class="pre">TEMP_C</span></code>.</p>
<p>Knowing how to use your own function in pandas can be really useful when doing your own analyses. Here, we will introduce two different approaches for using function in pandas. First, we will see how we can apply the function row-by-row using a <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop and the <code class="docutils literal notranslate"><span class="pre">DataFrame.iterrows()</span></code>-method, and then we will learn how to apply the method to all rows at once using <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.apply.html">DataFrame.apply</a>.</p>
<p>For both of these approaches, we first need to define our temperature conversion function from Fahrenheit to Celsius:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">fahr_to_celsius</span><span class="p">(</span><span class="n">temp_fahrenheit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to convert Fahrenheit temperature into Celsius.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    temp_fahrenheit: int | float</span>
<span class="sd">        Input temperature in Fahrenheit (should be a number)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    Temperature in Celsius (float)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Convert the Fahrenheit into Celsius and return it</span>
    <span class="n">converted_temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_fahrenheit</span> <span class="o">-</span> <span class="mi">32</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.8</span>
    <span class="k">return</span> <span class="n">converted_temp</span>
</pre></div>
</div>
</div>
<p><strong>Note:</strong> with such a simple example, we could use the function direcly on a column in the DataFrame in order to conver the values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fahr_to_celsius</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_F&quot;</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29350</td>
      <td>191701010600</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-14.444444</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29350</td>
      <td>191701011300</td>
      <td>320.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-16.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350</td>
      <td>191701012000</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>-8.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-22.222222</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350</td>
      <td>191701021300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-20.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350</td>
      <td>191701022000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-12.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-24.444444</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>If we want to do something more complicated, we need to know how to apply the function row-by-row.</p>
<div class="section" id="Iterating-over-rows">
<h3>Iterating over rows<a class="headerlink" href="#Iterating-over-rows" title="Permalink to this headline">¶</a></h3>
<p>We can iterate over the rows of Pandas DataFrame by using the <code class="docutils literal notranslate"><span class="pre">iterrows()</span></code> -method and use the function one row at a time.</p>
<p>When iterating over the rows in our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, it is noteworthy to understand that the Pandas actually keeps track on the <code class="docutils literal notranslate"><span class="pre">index</span></code> value as well. Hence, the contents of a single row actually contains not only the values, but also the <code class="docutils literal notranslate"><span class="pre">index</span></code> of that row (each row is a pandas Series!).</p>
<ul class="simple">
<li>Let’s see how <code class="docutils literal notranslate"><span class="pre">iterrows()</span></code> works by printing out the <code class="docutils literal notranslate"><span class="pre">TEMP</span></code> value on each row using a <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Iterate over the rows</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Print the index value</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Index:&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>

    <span class="c1"># Print the row</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Temp F:&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;TEMP_F&quot;</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index: 0
Temp F: 6.0

</pre></div></div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>break</strong></p>
<p>When developing a for-loop, you don’t always need to go trough the whole loop if you just want to test things out. <a class="reference external" href="https://www.tutorialspoint.com/python/python_break_statement.htm">break</a> statement in Python terminates the current loop after the first iteration and we used it here just to test check out the values on the first row.</p>
</div>
<p>We can see that the <code class="docutils literal notranslate"><span class="pre">idx</span></code> variable indeed contains the index value at position 0 (the first row) and the <code class="docutils literal notranslate"><span class="pre">row</span></code> variable contains all the data from that given row stored as a pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<ul class="simple">
<li>Let’s now create an empty column <code class="docutils literal notranslate"><span class="pre">TEMP_C</span></code> for the Celsius temperatures and update the values into that column using the <code class="docutils literal notranslate"><span class="pre">fahr_to_celsius</span></code> function we defined earlier:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty column for the DataFrame where the values will be stored</span>
<span class="n">new_column</span> <span class="o">=</span> <span class="s2">&quot;TEMP_C&quot;</span>
<span class="n">data</span><span class="p">[</span><span class="n">new_column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c1"># Iterate over the rows</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Convert the Fahrenheit to Celsius</span>
    <span class="n">celsius</span> <span class="o">=</span> <span class="n">fahr_to_celsius</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">])</span>

    <span class="c1"># Update the value of &#39;Celsius&#39; column with the converted value</span>
    <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">new_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">celsius</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>.at or .loc?</strong></p>
<p>Here, you could also use <code class="docutils literal notranslate"><span class="pre">data.loc[idx,</span> <span class="pre">new_column]</span> <span class="pre">=</span> <span class="pre">celsius</span></code> to achieve the same result.</p>
<p>If you only need to access a single value in a DataFrame, <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/0.25/reference/api/pandas.DataFrame.at.html">DataFrame.at</a> is faster compared to <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html">DataFrame.loc</a> which is designed for accessing groups of rows and columns.</p>
</div>
<ul class="simple">
<li>Let’s see what we have now.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29350</td>
      <td>191701010600</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-14.4444</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29350</td>
      <td>191701011300</td>
      <td>320.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-16.6667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350</td>
      <td>191701012000</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>-8.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-22.2222</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350</td>
      <td>191701021300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350</td>
      <td>191701022000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-12.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-24.4444</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29350</td>
      <td>191701030600</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-8.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-22.2222</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29350</td>
      <td>191701031300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-17.7778</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29350</td>
      <td>191701032000</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-16.6667</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29350</td>
      <td>191701040600</td>
      <td>110.0</td>
      <td>14.0</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-15</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29350</td>
      <td>191701041300</td>
      <td>70.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-14.4444</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Great! Now we have converted our temperatures into Celsius by using our self-made function.</p>
</div>
<div class="section" id="Applying-a-function">
<h3>Applying a function<a class="headerlink" href="#Applying-a-function" title="Permalink to this headline">¶</a></h3>
<p>Pandas DataFrames and Series also have a dedicated method <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> for applying functions on columns (or rows!). When using <code class="docutils literal notranslate"><span class="pre">.apply()</span></code>, we pass the function name (without parenthesis!) as an argument:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fahr_to_celsius</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29350</td>
      <td>191701010600</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-14.444444</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29350</td>
      <td>191701011300</td>
      <td>320.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-16.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350</td>
      <td>191701012000</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>-8.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-22.222222</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350</td>
      <td>191701021300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-20.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350</td>
      <td>191701022000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-12.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-24.444444</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Note:</strong> pay attention which column you are applying the function on! Running this code: <code class="docutils literal notranslate"><span class="pre">data.apply(fahr_to_celsius)</span></code> would not give an error, but the results also don’t make much sense.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Should I use .iterrows() or .apply()?</strong></p>
<p>We are teaching the <code class="docutils literal notranslate"><span class="pre">.iterrows()</span></code> method because it helps to understand the structure of a DataFrame and the process of looping trough DataFrame rows. However, using <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> is often more efficient in terms of execution time.</p>
<p>At this point, the most important thing is that you understand what happens when you are modifying the values in a pandas DataFrame. When doing the course exercises, either of these approaches is ok!</p>
</div>
</div>
</div>
<div class="section" id="Parsing-dates">
<h2>Parsing dates<a class="headerlink" href="#Parsing-dates" title="Permalink to this headline">¶</a></h2>
<p>We will eventually want to group our data based on month in order to see if April temperatures in 2019 were higher than average. Currently, the date and time information is stored in the column <code class="docutils literal notranslate"><span class="pre">TIME</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">YR--MODAHRMN</span> <span class="pre">=</span> <span class="pre">YEAR-MONTH-DAY-HOUR-MINUTE</span> <span class="pre">IN</span> <span class="pre">GREENWICH</span> <span class="pre">MEAN</span> <span class="pre">TIME</span> <span class="pre">(GMT)</span></code></p>
<p>Let’s have a closer look at the date and time information we have by checking the values in that column, and their data type:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    191701010600
1    191701011300
2    191701012000
3    191701021300
4    191701022000
5    191701030600
6    191701031300
7    191701032000
8    191701040600
9    191701041300
Name: TIME, dtype: int64
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>559657    201910012050
559658    201910012100
559659    201910012120
559660    201910012150
559661    201910012200
559662    201910012220
559663    201910012250
559664    201910012300
559665    201910012320
559666    201910012350
Name: TIME, dtype: int64
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">TIME</span></code> column contains several observations per day (and even several observations per hour). The timestamp for the first observation is <code class="docutils literal notranslate"><span class="pre">191701010600</span></code>, i.e. from 1st of January 1917, and the timestamp for the latest observation is <code class="docutils literal notranslate"><span class="pre">201910012350</span></code> (from last week, by the time of writing this!)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>dtype(&#39;int64&#39;)
</pre></div>
</div>
</div>
<p>And the information is stored as integer values.</p>
<p>There are several different options for proceeding from here. The bottom line is, that we would want to <strong>aggregate the data on a monthly level</strong>, and in order to do so we need to “label” each row of data based on the month when the record was observed. In practice, we could create a new column (or an index), which contains information about the month (including the year, but excluding hours and minutes).</p>
<div class="section" id="String-slicing">
<h3>String slicing<a class="headerlink" href="#String-slicing" title="Permalink to this headline">¶</a></h3>
<p>One approach would be to convert the date and time information into character strings and “cut” the needed information from the <a class="reference external" href="https://docs.python.org/3/tutorial/introduction.html#strings">string objects</a>. If we look at the latest time stamp in the data (<code class="docutils literal notranslate"><span class="pre">201910012350</span></code>), you can see that there is a systematic pattern <code class="docutils literal notranslate"><span class="pre">YEAR-MONTH-DAY-HOUR-MINUTE</span></code>. Four first characters represent the year, and six first characters are year + month!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">date</span> <span class="o">=</span> <span class="s2">&quot;201910012350&quot;</span>
<span class="n">date</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;201910&#39;
</pre></div>
</div>
</div>
<p>Doing this in pandas requires two steps: 1. Convert the <code class="docutils literal notranslate"><span class="pre">TIME</span></code> column from <code class="docutils literal notranslate"><span class="pre">int</span></code> into <code class="docutils literal notranslate"><span class="pre">str</span></code> datatype. 2. Slice the correct range of characters from the character string using <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.slice.html">pandas.Series.str.slice()</a></p>
<ul class="simple">
<li>Let’s convert the time into string. And check that the data type changes:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Convert to string</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># SLice the string</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH_STR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   STATION_NUMBER          TIME    DIR  SPEED  GUST  TEMP_F  MAX  MIN  \
0           29350  191701010600  320.0    5.0   NaN     6.0  NaN  NaN
1           29350  191701011300  320.0    7.0   NaN     2.0  NaN  NaN
2           29350  191701012000  320.0    5.0   NaN    -8.0  NaN  NaN
3           29350  191701021300    NaN    0.0   NaN    -4.0  NaN  NaN
4           29350  191701022000    NaN    0.0   NaN   -12.0  NaN  NaN

      TEMP_C      TIME_STR MONTH_STR
0 -14.444444  191701010600    191701
1 -16.666667  191701011300    191701
2 -22.222222  191701012000    191701
3 -20.000000  191701021300    191701
4 -24.444444  191701022000    191701
</pre></div></div>
</div>
<p>Nice! Now we have “labeled” the rows based on information about day of the year and hour of the day. However, let’s have a look at a more clever way of dealing with dates and times..</p>
</div>
<div class="section" id="datetime">
<h3>datetime<a class="headerlink" href="#datetime" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Pandas datetime</strong></p>
<p>In pandas, we can convert dates and times into a new data type <a class="reference external" href="https://docs.python.org/3.7/library/datetime.html">datetime</a> using <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html">pandas.to_datetime</a> function. First, it is important to understand the structure of the input data in order to avoid erroneous conversions, and that’s why we first learned string slicing before introducing the datetime functionalities.</p>
<p>Here is one example of how to convert the <code class="docutils literal notranslate"><span class="pre">TIME_STR</span></code>-column in our data set to datetime:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME_STR&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>If needed, you can use the <code class="docutils literal notranslate"><span class="pre">format</span></code> parameter to define the output datetime format according to <a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior">strftime(format) method</a>. together with <code class="docutils literal notranslate"><span class="pre">exact=False</span></code>, for example like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME_STR&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H&#39;</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">exact=False</span></code> drops out minutes and secods, because they are not included in the specified formatting.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Convert to datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME_STR&quot;</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0   1917-01-01 06:00:00
1   1917-01-01 13:00:00
2   1917-01-01 20:00:00
3   1917-01-02 13:00:00
4   1917-01-02 20:00:00
Name: DATE, dtype: datetime64[ns]
</pre></div>
</div>
</div>
<p>Note: in this case, the data type of the values is <code class="docutils literal notranslate"><span class="pre">datetime</span></code>.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Pandas Series datetime properties</strong></p>
<p>There are several methods available for accessing information about the properties of datetime values. Read more from the pandas documentation about <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/series.html#datetime-properties">datetime properties</a>.</p>
</div>
<p>Now, we can extract different time units based on the datetime-column using the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.dt.html">pandas.Series.dt accessor</a>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0         1917
1         1917
2         1917
3         1917
4         1917
5         1917
6         1917
7         1917
8         1917
9         1917
10        1917
11        1917
12        1917
13        1917
14        1917
15        1917
16        1917
17        1917
18        1917
19        1917
20        1917
21        1917
22        1917
23        1917
24        1917
25        1917
26        1917
27        1917
28        1917
29        1917
          ...
559637    2019
559638    2019
559639    2019
559640    2019
559641    2019
559642    2019
559643    2019
559644    2019
559645    2019
559646    2019
559647    2019
559648    2019
559649    2019
559650    2019
559651    2019
559652    2019
559653    2019
559654    2019
559655    2019
559656    2019
559657    2019
559658    2019
559659    2019
559660    2019
559661    2019
559662    2019
559663    2019
559664    2019
559665    2019
559666    2019
Name: DATE, Length: 559667, dtype: int64
</pre></div>
</div>
</div>
<p>We can also combine the datetime functionalities with other methods from pandas. For example, we can check the number of unique years in our input data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>69
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>TASK:</strong></p>
<ul class="simple">
<li>Create two new columns: <code class="docutils literal notranslate"><span class="pre">YEAR</span></code> and <code class="docutils literal notranslate"><span class="pre">MONTH</span></code> based on the date column</li>
</ul>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
      <th>TIME_STR</th>
      <th>MONTH_STR</th>
      <th>DATE</th>
      <th>YEAR</th>
      <th>MONTH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29350</td>
      <td>191701010600</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-14.444444</td>
      <td>191701010600</td>
      <td>191701</td>
      <td>1917-01-01 06:00:00</td>
      <td>1917</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29350</td>
      <td>191701011300</td>
      <td>320.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-16.666667</td>
      <td>191701011300</td>
      <td>191701</td>
      <td>1917-01-01 13:00:00</td>
      <td>1917</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350</td>
      <td>191701012000</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>-8.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-22.222222</td>
      <td>191701012000</td>
      <td>191701</td>
      <td>1917-01-01 20:00:00</td>
      <td>1917</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350</td>
      <td>191701021300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-20.000000</td>
      <td>191701021300</td>
      <td>191701</td>
      <td>1917-01-02 13:00:00</td>
      <td>1917</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350</td>
      <td>191701022000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-12.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-24.444444</td>
      <td>191701022000</td>
      <td>191701</td>
      <td>1917-01-02 20:00:00</td>
      <td>1917</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>
<div class="section" id="Aggregating-data-in-Pandas-by-grouping">
<h2>Aggregating data in Pandas by grouping<a class="headerlink" href="#Aggregating-data-in-Pandas-by-grouping" title="Permalink to this headline">¶</a></h2>
<p>Here, we will learn how to use <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">pandas.DataFrame.groupby</a> which is a handy method for compressing large amounts of data and computing statistics for subgroups.</p>
<p>Our practical task is to calculate the average temperatures for each month</p>
<p>This can be done by aggregating the data, i.e.:</p>
<ol class="arabic simple">
<li><strong>grouping the data</strong> based on year and month</li>
<li>Calculating the average for each month (each group) either by using a for-loop or directly from the grouped object</li>
<li>Storing those values into <strong>a new DataFrame</strong> <code class="docutils literal notranslate"><span class="pre">monthly_data</span></code></li>
</ol>
<p>Before we start grouping the data, let’s once more check how our input data looks like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;number of rows:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
number of rows: 559667
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
      <th>TIME_STR</th>
      <th>MONTH_STR</th>
      <th>DATE</th>
      <th>YEAR</th>
      <th>MONTH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29350</td>
      <td>191701010600</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-14.444444</td>
      <td>191701010600</td>
      <td>191701</td>
      <td>1917-01-01 06:00:00</td>
      <td>1917</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29350</td>
      <td>191701011300</td>
      <td>320.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-16.666667</td>
      <td>191701011300</td>
      <td>191701</td>
      <td>1917-01-01 13:00:00</td>
      <td>1917</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350</td>
      <td>191701012000</td>
      <td>320.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>-8.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-22.222222</td>
      <td>191701012000</td>
      <td>191701</td>
      <td>1917-01-01 20:00:00</td>
      <td>1917</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350</td>
      <td>191701021300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-20.000000</td>
      <td>191701021300</td>
      <td>191701</td>
      <td>1917-01-02 13:00:00</td>
      <td>1917</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350</td>
      <td>191701022000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>-12.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-24.444444</td>
      <td>191701022000</td>
      <td>191701</td>
      <td>1917-01-02 20:00:00</td>
      <td>1917</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We have quite a few rows of weather data, and several observations per day (and even per hour). <strong>Our goal is to create an aggreated data frame that would have only one row per month!</strong></p>
<p>Let’s <strong>group</strong> our data based on unique year and month combinations</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;YEAR&quot;</span><span class="p">,</span> <span class="s2">&quot;MONTH&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>NOTE:</strong></p>
<p>Here you could also group the data based on the <code class="docutils literal notranslate"><span class="pre">MONTH_STR</span></code> column to achieve the same result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Group the data</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;MONTH_STR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>Let’s see what we have now.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># What is the type?</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Type:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">grouped</span><span class="p">))</span>

<span class="c1"># How many?</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Length:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Type:
 &lt;class &#39;pandas.core.groupby.groupby.DataFrameGroupBy&#39;&gt;
Length:
 826
</pre></div></div>
</div>
<p>Okey, interesting. Now we have a new object with type <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code>.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>TASK:</strong></p>
<p>Think: what does the number of groups (length of the grouped object) tell us?</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Answer: the length of the grouped object should be the same as</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;MONTH_STR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="c1"># in other words, the number of groups is the number of unique year and month combinations in our data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>826
</pre></div>
</div>
</div>
<p>There are several methods we can use for extracting information from the grouped data. See <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/groupby.html">documentation for Pandas GroupBy objects</a> for a comprehensive overview.</p>
<p><strong>Checking group names:</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Check the &quot;names&quot; of each group (comment out the next row if you want to print out the result!)</span>
<span class="c1">#grouped.groups.keys()</span>
</pre></div>
</div>
</div>
<p><strong>Accessing data for one group:</strong></p>
<ul class="simple">
<li>Let’s check the contents for a group representing August 2019 (name of that group is <code class="docutils literal notranslate"><span class="pre">(2019,</span> <span class="pre">4)</span></code> if you grouped the data based on datetime columns <code class="docutils literal notranslate"><span class="pre">YEAR</span></code> and <code class="docutils literal notranslate"><span class="pre">MONTH</span></code>). We can get the values of that hour from the grouped object using the <code class="docutils literal notranslate"><span class="pre">get_group()</span></code> -method:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specify the time of the first hour (as text)</span>
<span class="n">month</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># Select the group</span>
<span class="n">group1</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">month</span><span class="p">)</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">group1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
        STATION_NUMBER          TIME    DIR  SPEED  GUST  TEMP_F   MAX   MIN  \
546832           29350  201904010000  290.0    9.0   NaN    29.0   NaN   NaN
546833           29350  201904010050  330.0    6.0   NaN    28.0   NaN   NaN
546834           29350  201904010100  280.0    9.0   NaN    29.0   NaN   NaN
546835           29350  201904010120  310.0    7.0   NaN    28.0   NaN   NaN
546836           29350  201904010150  320.0    3.0   NaN    27.0   NaN   NaN
546837           29350  201904010200  290.0    2.0   NaN    28.0   NaN   NaN
546838           29350  201904010220  290.0    5.0   NaN    27.0   NaN   NaN
546839           29350  201904010250  300.0    6.0   NaN    27.0   NaN   NaN
546840           29350  201904010300  300.0    9.0   NaN    28.0   NaN   NaN
546841           29350  201904010320  320.0    8.0   NaN    27.0   NaN   NaN
546842           29350  201904010350  310.0   10.0   NaN    27.0   NaN   NaN
546843           29350  201904010400  300.0   13.0   NaN    28.0   NaN   NaN
546844           29350  201904010420  290.0   13.0   NaN    28.0   NaN   NaN
546845           29350  201904010450  290.0   13.0   NaN    28.0   NaN   NaN
546846           29350  201904010500  290.0   13.0   NaN    29.0   NaN   NaN
546847           29350  201904010520  300.0   14.0   NaN    28.0   NaN   NaN
546848           29350  201904010550  300.0   15.0   NaN    28.0   NaN   NaN
546849           29350  201904010600  300.0   16.0   NaN    30.0  33.0  24.0
546850           29350  201904010620  300.0   15.0   NaN    30.0   NaN   NaN
546851           29350  201904010650  300.0   17.0   NaN    30.0   NaN   NaN
546852           29350  201904010700  310.0   16.0   NaN    31.0   NaN   NaN
546853           29350  201904010720  300.0   14.0   NaN    32.0   NaN   NaN
546854           29350  201904010750  300.0   11.0   NaN    32.0   NaN   NaN
546855           29350  201904010800  290.0   11.0   NaN    34.0   NaN   NaN
546856           29350  201904010820  290.0   14.0   NaN    34.0   NaN   NaN
546857           29350  201904010850  290.0   14.0   NaN    34.0   NaN   NaN
546858           29350  201904010900  300.0   16.0   NaN    35.0   NaN   NaN
546859           29350  201904010920  990.0   13.0   NaN    36.0   NaN   NaN
546860           29350  201904010950  270.0   17.0   NaN    36.0   NaN   NaN
546861           29350  201904011000  280.0    9.0   NaN    37.0   NaN   NaN
...                ...           ...    ...    ...   ...     ...   ...   ...
548949           29350  201904301400  240.0    4.0   NaN    59.0   NaN   NaN
548950           29350  201904301420  990.0    8.0   NaN    61.0   NaN   NaN
548951           29350  201904301450  990.0    8.0   NaN    61.0   NaN   NaN
548952           29350  201904301500  290.0    7.0   NaN    62.0   NaN   NaN
548953           29350  201904301520  280.0    9.0   NaN    61.0   NaN   NaN
548954           29350  201904301550  990.0   10.0   NaN    61.0   NaN   NaN
548955           29350  201904301600  260.0    7.0   NaN    61.0   NaN   NaN
548956           29350  201904301620  990.0    8.0   NaN    59.0   NaN   NaN
548957           29350  201904301650  990.0    7.0   NaN    57.0   NaN   NaN
548958           29350  201904301700  230.0    4.0   NaN    57.0   NaN   NaN
548959           29350  201904301720  990.0   10.0   NaN    57.0   NaN   NaN
548960           29350  201904301750  270.0   10.0   NaN    55.0   NaN   NaN
548961           29350  201904301800  270.0    9.0   NaN    54.0  62.0  46.0
548962           29350  201904301820  270.0    9.0   NaN    54.0   NaN   NaN
548963           29350  201904301850  260.0    8.0   NaN    52.0   NaN   NaN
548964           29350  201904301900  270.0    7.0   NaN    52.0   NaN   NaN
548965           29350  201904301920  270.0    7.0   NaN    50.0   NaN   NaN
548966           29350  201904301950  260.0    9.0   NaN    50.0   NaN   NaN
548967           29350  201904302000  270.0    7.0   NaN    49.0   NaN   NaN
548968           29350  201904302020  280.0    8.0   NaN    48.0   NaN   NaN
548969           29350  201904302050  260.0    6.0   NaN    48.0   NaN   NaN
548970           29350  201904302100  260.0    4.0   NaN    47.0   NaN   NaN
548971           29350  201904302120  260.0    6.0   NaN    46.0   NaN   NaN
548972           29350  201904302150  990.0    3.0   NaN    45.0   NaN   NaN
548973           29350  201904302200  280.0    4.0   NaN    45.0   NaN   NaN
548974           29350  201904302220  990.0    2.0   NaN    43.0   NaN   NaN
548975           29350  201904302250  990.0    1.0   NaN    41.0   NaN   NaN
548976           29350  201904302300  240.0    2.0   NaN    40.0   NaN   NaN
548977           29350  201904302320  990.0    2.0   NaN    39.0   NaN   NaN
548978           29350  201904302350  110.0    2.0   NaN    37.0   NaN   NaN

           TEMP_C      TIME_STR MONTH_STR                DATE  YEAR  MONTH
546832  -1.666667  201904010000    201904 2019-04-01 00:00:00  2019      4
546833  -2.222222  201904010050    201904 2019-04-01 00:50:00  2019      4
546834  -1.666667  201904010100    201904 2019-04-01 01:00:00  2019      4
546835  -2.222222  201904010120    201904 2019-04-01 01:20:00  2019      4
546836  -2.777778  201904010150    201904 2019-04-01 01:50:00  2019      4
546837  -2.222222  201904010200    201904 2019-04-01 02:00:00  2019      4
546838  -2.777778  201904010220    201904 2019-04-01 02:20:00  2019      4
546839  -2.777778  201904010250    201904 2019-04-01 02:50:00  2019      4
546840  -2.222222  201904010300    201904 2019-04-01 03:00:00  2019      4
546841  -2.777778  201904010320    201904 2019-04-01 03:20:00  2019      4
546842  -2.777778  201904010350    201904 2019-04-01 03:50:00  2019      4
546843  -2.222222  201904010400    201904 2019-04-01 04:00:00  2019      4
546844  -2.222222  201904010420    201904 2019-04-01 04:20:00  2019      4
546845  -2.222222  201904010450    201904 2019-04-01 04:50:00  2019      4
546846  -1.666667  201904010500    201904 2019-04-01 05:00:00  2019      4
546847  -2.222222  201904010520    201904 2019-04-01 05:20:00  2019      4
546848  -2.222222  201904010550    201904 2019-04-01 05:50:00  2019      4
546849  -1.111111  201904010600    201904 2019-04-01 06:00:00  2019      4
546850  -1.111111  201904010620    201904 2019-04-01 06:20:00  2019      4
546851  -1.111111  201904010650    201904 2019-04-01 06:50:00  2019      4
546852  -0.555556  201904010700    201904 2019-04-01 07:00:00  2019      4
546853   0.000000  201904010720    201904 2019-04-01 07:20:00  2019      4
546854   0.000000  201904010750    201904 2019-04-01 07:50:00  2019      4
546855   1.111111  201904010800    201904 2019-04-01 08:00:00  2019      4
546856   1.111111  201904010820    201904 2019-04-01 08:20:00  2019      4
546857   1.111111  201904010850    201904 2019-04-01 08:50:00  2019      4
546858   1.666667  201904010900    201904 2019-04-01 09:00:00  2019      4
546859   2.222222  201904010920    201904 2019-04-01 09:20:00  2019      4
546860   2.222222  201904010950    201904 2019-04-01 09:50:00  2019      4
546861   2.777778  201904011000    201904 2019-04-01 10:00:00  2019      4
...           ...           ...       ...                 ...   ...    ...
548949  15.000000  201904301400    201904 2019-04-30 14:00:00  2019      4
548950  16.111111  201904301420    201904 2019-04-30 14:20:00  2019      4
548951  16.111111  201904301450    201904 2019-04-30 14:50:00  2019      4
548952  16.666667  201904301500    201904 2019-04-30 15:00:00  2019      4
548953  16.111111  201904301520    201904 2019-04-30 15:20:00  2019      4
548954  16.111111  201904301550    201904 2019-04-30 15:50:00  2019      4
548955  16.111111  201904301600    201904 2019-04-30 16:00:00  2019      4
548956  15.000000  201904301620    201904 2019-04-30 16:20:00  2019      4
548957  13.888889  201904301650    201904 2019-04-30 16:50:00  2019      4
548958  13.888889  201904301700    201904 2019-04-30 17:00:00  2019      4
548959  13.888889  201904301720    201904 2019-04-30 17:20:00  2019      4
548960  12.777778  201904301750    201904 2019-04-30 17:50:00  2019      4
548961  12.222222  201904301800    201904 2019-04-30 18:00:00  2019      4
548962  12.222222  201904301820    201904 2019-04-30 18:20:00  2019      4
548963  11.111111  201904301850    201904 2019-04-30 18:50:00  2019      4
548964  11.111111  201904301900    201904 2019-04-30 19:00:00  2019      4
548965  10.000000  201904301920    201904 2019-04-30 19:20:00  2019      4
548966  10.000000  201904301950    201904 2019-04-30 19:50:00  2019      4
548967   9.444444  201904302000    201904 2019-04-30 20:00:00  2019      4
548968   8.888889  201904302020    201904 2019-04-30 20:20:00  2019      4
548969   8.888889  201904302050    201904 2019-04-30 20:50:00  2019      4
548970   8.333333  201904302100    201904 2019-04-30 21:00:00  2019      4
548971   7.777778  201904302120    201904 2019-04-30 21:20:00  2019      4
548972   7.222222  201904302150    201904 2019-04-30 21:50:00  2019      4
548973   7.222222  201904302200    201904 2019-04-30 22:00:00  2019      4
548974   6.111111  201904302220    201904 2019-04-30 22:20:00  2019      4
548975   5.000000  201904302250    201904 2019-04-30 22:50:00  2019      4
548976   4.444444  201904302300    201904 2019-04-30 23:00:00  2019      4
548977   3.888889  201904302320    201904 2019-04-30 23:20:00  2019      4
548978   2.777778  201904302350    201904 2019-04-30 23:50:00  2019      4

[2147 rows x 14 columns]
</pre></div></div>
</div>
<p>Ahaa! As we can see, a single group contains a <strong>DataFrame</strong> with values only for that specific month. Let’s check the DataType of this group:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">type</span><span class="p">(</span><span class="n">group1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
<p>So, one group is a pandas DataFrame! This is really useful, because we can now use all the familiar DataFrame methods for calculating statistics etc for this spesific group. We can, for example, calculate the average values for all variables using the statistical functions that we have seen already (e.g. mean, std, min, max, median, etc.).</p>
<p>We can do that by using the <code class="docutils literal notranslate"><span class="pre">mean()</span></code> -function that we already used during the Lesson 5.</p>
<ul class="simple">
<li>Let’s calculate the mean for following attributes all at once:</li>
<li><code class="docutils literal notranslate"><span class="pre">DIR</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">SPEED</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">GUST</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">TEMP</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">TEMP_C</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">MONTH</span></code></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specify the columns that will be part of the calculation</span>
<span class="n">mean_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_F&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">,</span> <span class="s1">&#39;MONTH&#39;</span><span class="p">]</span>

<span class="c1"># Calculate the mean values all at one go</span>
<span class="n">mean_values</span> <span class="o">=</span> <span class="n">group1</span><span class="p">[</span><span class="n">mean_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">mean_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DIR       399.197218
SPEED       6.020893
GUST       21.416667
TEMP_F     40.585002
TEMP_C      4.769446
MONTH       4.000000
dtype: float64
</pre></div></div>
</div>
<p>Nice, now we have averaged our data and e.g. the mean Celsius temperature seems to be about right when comparing to the original values above.</p>
<p>Here we saw how you can access data from a single group. For getting information about all groups (all months)we can a <code class="docutils literal notranslate"><span class="pre">for</span></code> -loop or methods available in the grouped object.</p>
<p><strong>For-loops and grouped objects:</strong></p>
<p>When iterating over the groups in our <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> -object it is important to understand that a single group in our <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> actually contains not only the actual values, but also information about the <code class="docutils literal notranslate"><span class="pre">key</span></code> that was used to do the grouping. Hence, when iterating over the data we need to assign the <code class="docutils literal notranslate"><span class="pre">key</span></code> and the values into separate variables.</p>
<ul class="simple">
<li>Let’s see how we can iterate over the groups and print the key and the data from a single group (again using <code class="docutils literal notranslate"><span class="pre">break</span></code> to only see what is happening).</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Iterate over groups</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="c1"># Print key and group</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Key:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">First rows of data in this group:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

    <span class="c1"># Stop iteration with break command</span>
    <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Key:
 (1917, 1)

First rows of data in this group:
    STATION_NUMBER          TIME    DIR  SPEED  GUST  TEMP_F  MAX  MIN  \
0           29350  191701010600  320.0    5.0   NaN     6.0  NaN  NaN
1           29350  191701011300  320.0    7.0   NaN     2.0  NaN  NaN
2           29350  191701012000  320.0    5.0   NaN    -8.0  NaN  NaN
3           29350  191701021300    NaN    0.0   NaN    -4.0  NaN  NaN
4           29350  191701022000    NaN    0.0   NaN   -12.0  NaN  NaN

      TEMP_C      TIME_STR MONTH_STR                DATE  YEAR  MONTH
0 -14.444444  191701010600    191701 1917-01-01 06:00:00  1917      1
1 -16.666667  191701011300    191701 1917-01-01 13:00:00  1917      1
2 -22.222222  191701012000    191701 1917-01-01 20:00:00  1917      1
3 -20.000000  191701021300    191701 1917-01-02 13:00:00  1917      1
4 -24.444444  191701022000    191701 1917-01-02 20:00:00  1917      1
</pre></div></div>
</div>
<p>Okey so from here we can see that the <code class="docutils literal notranslate"><span class="pre">key</span></code> contains the name of the group (year, month).</p>
<ul class="simple">
<li>Let’s see how we can create a DataFrame where we calculate the mean values for all those weather attributes that we were interested in. I will repeate slightly the earlier steps so that you can see and better understand what is happening.</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty DataFrame for the aggregated values</span>
<span class="n">hourly_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># The columns that we want to aggregate</span>
<span class="n">mean_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_F&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">,</span> <span class="s2">&quot;MONTH&quot;</span><span class="p">]</span>

<span class="c1"># Iterate over the groups</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
   <span class="c1"># Aggregate the data</span>
   <span class="n">mean_values</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="n">mean_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

   <span class="c1"># Add the ´key´ (i.e. the date+time information) into the aggregated values</span>
   <span class="n">mean_values</span><span class="p">[</span><span class="s1">&#39;YEAR_MONTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

   <span class="c1"># Append the aggregated values into the DataFrame</span>
   <span class="n">hourly_data</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_values</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>Let’s see what we have now:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">hourly_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
            DIR       GUST  MONTH      SPEED     TEMP_C     TEMP_F  YEAR_MONTH
0    226.250000        NaN    1.0   7.184783 -10.996377  12.206522   (1917, 1)
1    215.945946        NaN    2.0  11.738095 -14.212963   6.416667   (1917, 2)
2    185.769231        NaN    3.0   9.032258 -10.890084  12.397849   (1917, 3)
3    173.717949        NaN    4.0   8.611111   0.746914  33.344444   (1917, 4)
4    261.851852        NaN    5.0  11.591398   6.911589  44.440860   (1917, 5)
5    211.315789        NaN    6.0   7.777778  17.820988  64.077778   (1917, 6)
6    225.487805        NaN    7.0   6.677419  16.612903  61.903226   (1917, 7)
7    161.971831        NaN    8.0   6.150538  18.500597  65.301075   (1917, 8)
8    237.027027        NaN    9.0   9.966667   9.098765  48.377778   (1917, 9)
9    162.619048        NaN   10.0  12.784946   6.164875  43.096774  (1917, 10)
10   199.529412        NaN   11.0  13.322222  -0.364198  31.344444  (1917, 11)
11   186.956522        NaN   12.0   8.096774  -5.746714  21.655914  (1917, 12)
12   213.924051        NaN    1.0  11.580645 -12.968937   8.655914   (1918, 1)
13   201.285714        NaN    2.0   8.011905  -7.810847  17.940476   (1918, 2)
14   229.714286        NaN    3.0   8.838710  -3.130227  26.365591   (1918, 3)
15   171.692308        NaN    4.0   6.244444   3.783951  38.811111   (1918, 4)
16   213.294118        NaN    5.0   9.913978   8.160096  46.688172   (1918, 5)
17   211.666667        NaN    6.0  10.800000  12.938272  55.288889   (1918, 6)
18   195.810811        NaN    7.0   7.860215  18.207885  64.774194   (1918, 7)
19   205.909091        NaN    8.0   6.182796  12.431302  54.376344   (1918, 8)
20   190.142857        NaN    9.0   9.444444   8.604938  47.488889   (1918, 9)
21   185.925926        NaN   10.0   9.408602   6.063321  42.913978  (1918, 10)
22   189.610390        NaN   11.0  10.363636   1.445707  34.602273  (1918, 11)
23   149.746835        NaN   12.0  10.333333  -5.537634  22.032258  (1918, 12)
24   129.589041        NaN    1.0   6.526882  -6.057348  21.096774   (1919, 1)
25   241.551724        NaN    2.0   7.702381 -11.170635  11.892857   (1919, 2)
26   202.750000        NaN    3.0  12.688172  -7.072879  19.268817   (1919, 3)
27   198.030303        NaN    4.0   9.149425   1.104651  33.988372   (1919, 4)
28   211.617647        NaN    5.0   7.827957  10.585424  51.053763   (1919, 5)
29   189.846154        NaN    6.0   8.275862  15.421456  59.758621   (1919, 6)
..          ...        ...    ...        ...        ...        ...         ...
796  405.082453  17.250000    5.0   7.452416   6.882535  44.388564   (2017, 5)
797  406.696117  18.533613    6.0   7.273412  12.455373  54.419672   (2017, 6)
798  395.458746  14.882353    7.0   5.807256  14.436690  57.986042   (2017, 7)
799  425.223558  15.767196    8.0   5.856287  14.093661  57.368590   (2017, 8)
800  346.161481  15.480000    9.0   5.072941   9.104895  48.388811   (2017, 9)
801  305.445283  16.729469   10.0   6.762276   3.596545  38.473780  (2017, 10)
802  363.135977  15.989189   11.0   6.149673   0.780164  33.404295  (2017, 11)
803  353.396004  16.781116   12.0   7.093086  -1.333083  29.600451  (2017, 12)
804  343.304731  16.835294    1.0   6.006312  -5.228581  22.588553   (2018, 1)
805  278.572392  14.370968    2.0   6.137827 -11.126866  11.971642   (2018, 2)
806  357.101570  25.312500    3.0   6.394347  -7.250687  18.948764   (2018, 3)
807  375.255561  23.125000    4.0   5.652785   2.984090  37.371362   (2018, 4)
808  421.332520  24.476190    5.0   6.625115  13.666265  56.599276   (2018, 5)
809  433.026392  27.115942    6.0   8.346118  13.970058  57.146104   (2018, 6)
810  363.347531  20.000000    7.0   6.089236  20.188452  68.339213   (2018, 7)
811  473.589453  24.724138    8.0   5.978913  16.576768  61.838182   (2018, 8)
812  445.613356  23.695238    9.0   6.511075  11.428909  52.572036   (2018, 9)
813  405.446437  18.812500   10.0   6.158283   4.383959  39.891125  (2018, 10)
814  421.499102  22.871795   11.0   6.546313   1.686590  35.035861  (2018, 11)
815  315.282321  26.000000   12.0   6.215385  -4.089957  24.638078  (2018, 12)
816  358.878037  27.666667    1.0   6.080845 -10.344629  13.379667   (2019, 1)
817  380.936620  31.093333    2.0   8.733899  -3.324484  26.015928   (2019, 2)
818  388.804775  26.846154    3.0   8.178588  -2.338365  27.790942   (2019, 3)
819  399.197218  21.416667    4.0   6.020893   4.769446  40.585002   (2019, 4)
820  426.542763  26.754386    5.0   7.283957   7.926650  46.267970   (2019, 5)
821  541.790176  23.243902    6.0   7.209586  15.643554  60.158397   (2019, 6)
822  516.388684  18.555556    7.0   6.825789  15.403457  59.726223   (2019, 7)
823  487.433531  21.923077    8.0   6.374659  14.214327  57.585788   (2019, 8)
824  435.173012  16.500000    9.0   5.931363   8.643044  47.557480   (2019, 9)
825  488.700000  13.200000   10.0   6.700000   5.538462  41.969231  (2019, 10)

[826 rows x 7 columns]
</pre></div></div>
</div>
<p>Awesome! Now we have aggregated our data based on daily averages and we have a new DataFrame called <code class="docutils literal notranslate"><span class="pre">hourly_data</span></code> where all those aggregated values are stored.</p>
<p><strong>Mean for all groups at once</strong></p>
<p>We can also achieve the same result by computing the mean of all columns for all groups in the grouped object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
    <tr>
      <th>YEAR</th>
      <th>MONTH</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="12" valign="top">1917</th>
      <th>1</th>
      <td>29350.0</td>
      <td>1.917012e+11</td>
      <td>226.250000</td>
      <td>7.184783</td>
      <td>NaN</td>
      <td>12.206522</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-10.996377</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350.0</td>
      <td>1.917021e+11</td>
      <td>215.945946</td>
      <td>11.738095</td>
      <td>NaN</td>
      <td>6.416667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-14.212963</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350.0</td>
      <td>1.917032e+11</td>
      <td>185.769231</td>
      <td>9.032258</td>
      <td>NaN</td>
      <td>12.397849</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-10.890084</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350.0</td>
      <td>1.917042e+11</td>
      <td>173.717949</td>
      <td>8.611111</td>
      <td>NaN</td>
      <td>33.344444</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.746914</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29350.0</td>
      <td>1.917052e+11</td>
      <td>261.851852</td>
      <td>11.591398</td>
      <td>NaN</td>
      <td>44.440860</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.911589</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29350.0</td>
      <td>1.917062e+11</td>
      <td>211.315789</td>
      <td>7.777778</td>
      <td>NaN</td>
      <td>64.077778</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.820988</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29350.0</td>
      <td>1.917072e+11</td>
      <td>225.487805</td>
      <td>6.677419</td>
      <td>NaN</td>
      <td>61.903226</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.612903</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29350.0</td>
      <td>1.917082e+11</td>
      <td>161.971831</td>
      <td>6.150538</td>
      <td>NaN</td>
      <td>65.301075</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.500597</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29350.0</td>
      <td>1.917092e+11</td>
      <td>237.027027</td>
      <td>9.966667</td>
      <td>NaN</td>
      <td>48.377778</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.098765</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29350.0</td>
      <td>1.917102e+11</td>
      <td>162.619048</td>
      <td>12.784946</td>
      <td>NaN</td>
      <td>43.096774</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.164875</td>
    </tr>
    <tr>
      <th>11</th>
      <td>29350.0</td>
      <td>1.917112e+11</td>
      <td>199.529412</td>
      <td>13.322222</td>
      <td>NaN</td>
      <td>31.344444</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.364198</td>
    </tr>
    <tr>
      <th>12</th>
      <td>29350.0</td>
      <td>1.917122e+11</td>
      <td>186.956522</td>
      <td>8.096774</td>
      <td>NaN</td>
      <td>21.655914</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-5.746714</td>
    </tr>
    <tr>
      <th rowspan="12" valign="top">1918</th>
      <th>1</th>
      <td>29350.0</td>
      <td>1.918012e+11</td>
      <td>213.924051</td>
      <td>11.580645</td>
      <td>NaN</td>
      <td>8.655914</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-12.968937</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350.0</td>
      <td>1.918021e+11</td>
      <td>201.285714</td>
      <td>8.011905</td>
      <td>NaN</td>
      <td>17.940476</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-7.810847</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350.0</td>
      <td>1.918032e+11</td>
      <td>229.714286</td>
      <td>8.838710</td>
      <td>NaN</td>
      <td>26.365591</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.130227</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350.0</td>
      <td>1.918042e+11</td>
      <td>171.692308</td>
      <td>6.244444</td>
      <td>NaN</td>
      <td>38.811111</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.783951</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29350.0</td>
      <td>1.918052e+11</td>
      <td>213.294118</td>
      <td>9.913978</td>
      <td>NaN</td>
      <td>46.688172</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.160096</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29350.0</td>
      <td>1.918062e+11</td>
      <td>211.666667</td>
      <td>10.800000</td>
      <td>NaN</td>
      <td>55.288889</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.938272</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29350.0</td>
      <td>1.918072e+11</td>
      <td>195.810811</td>
      <td>7.860215</td>
      <td>NaN</td>
      <td>64.774194</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.207885</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29350.0</td>
      <td>1.918082e+11</td>
      <td>205.909091</td>
      <td>6.182796</td>
      <td>NaN</td>
      <td>54.376344</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.431302</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29350.0</td>
      <td>1.918092e+11</td>
      <td>190.142857</td>
      <td>9.444444</td>
      <td>NaN</td>
      <td>47.488889</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.604938</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29350.0</td>
      <td>1.918102e+11</td>
      <td>185.925926</td>
      <td>9.408602</td>
      <td>NaN</td>
      <td>42.913978</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.063321</td>
    </tr>
    <tr>
      <th>11</th>
      <td>29350.0</td>
      <td>1.918112e+11</td>
      <td>189.610390</td>
      <td>10.363636</td>
      <td>NaN</td>
      <td>34.602273</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.445707</td>
    </tr>
    <tr>
      <th>12</th>
      <td>29350.0</td>
      <td>1.918122e+11</td>
      <td>149.746835</td>
      <td>10.333333</td>
      <td>NaN</td>
      <td>22.032258</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-5.537634</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">1919</th>
      <th>1</th>
      <td>29350.0</td>
      <td>1.919012e+11</td>
      <td>129.589041</td>
      <td>6.526882</td>
      <td>NaN</td>
      <td>21.096774</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-6.057348</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350.0</td>
      <td>1.919021e+11</td>
      <td>241.551724</td>
      <td>7.702381</td>
      <td>NaN</td>
      <td>11.892857</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-11.170635</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350.0</td>
      <td>1.919032e+11</td>
      <td>202.750000</td>
      <td>12.688172</td>
      <td>NaN</td>
      <td>19.268817</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-7.072879</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350.0</td>
      <td>1.919042e+11</td>
      <td>198.030303</td>
      <td>9.149425</td>
      <td>NaN</td>
      <td>33.988372</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.104651</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29350.0</td>
      <td>1.919052e+11</td>
      <td>211.617647</td>
      <td>7.827957</td>
      <td>NaN</td>
      <td>51.053763</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.585424</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29350.0</td>
      <td>1.919062e+11</td>
      <td>189.846154</td>
      <td>8.275862</td>
      <td>NaN</td>
      <td>59.758621</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.421456</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">2017</th>
      <th>5</th>
      <td>29350.0</td>
      <td>2.017052e+11</td>
      <td>405.082453</td>
      <td>7.452416</td>
      <td>17.250000</td>
      <td>44.388564</td>
      <td>50.850000</td>
      <td>37.816667</td>
      <td>6.882535</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29350.0</td>
      <td>2.017062e+11</td>
      <td>406.696117</td>
      <td>7.273412</td>
      <td>18.533613</td>
      <td>54.419672</td>
      <td>60.683333</td>
      <td>48.683333</td>
      <td>12.455373</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29350.0</td>
      <td>2.017072e+11</td>
      <td>395.458746</td>
      <td>5.807256</td>
      <td>14.882353</td>
      <td>57.986042</td>
      <td>63.822581</td>
      <td>52.774194</td>
      <td>14.436690</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29350.0</td>
      <td>2.017082e+11</td>
      <td>425.223558</td>
      <td>5.856287</td>
      <td>15.767196</td>
      <td>57.368590</td>
      <td>62.032787</td>
      <td>52.327869</td>
      <td>14.093661</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29350.0</td>
      <td>2.017092e+11</td>
      <td>346.161481</td>
      <td>5.072941</td>
      <td>15.480000</td>
      <td>48.388811</td>
      <td>52.150000</td>
      <td>44.216667</td>
      <td>9.104895</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29350.0</td>
      <td>2.017102e+11</td>
      <td>305.445283</td>
      <td>6.762276</td>
      <td>16.729469</td>
      <td>38.473780</td>
      <td>40.862069</td>
      <td>36.068966</td>
      <td>3.596545</td>
    </tr>
    <tr>
      <th>11</th>
      <td>29350.0</td>
      <td>2.017112e+11</td>
      <td>363.135977</td>
      <td>6.149673</td>
      <td>15.989189</td>
      <td>33.404295</td>
      <td>34.983333</td>
      <td>31.016667</td>
      <td>0.780164</td>
    </tr>
    <tr>
      <th>12</th>
      <td>29350.0</td>
      <td>2.017122e+11</td>
      <td>353.396004</td>
      <td>7.093086</td>
      <td>16.781116</td>
      <td>29.600451</td>
      <td>31.258065</td>
      <td>27.774194</td>
      <td>-1.333083</td>
    </tr>
    <tr>
      <th rowspan="12" valign="top">2018</th>
      <th>1</th>
      <td>29350.0</td>
      <td>2.018012e+11</td>
      <td>343.304731</td>
      <td>6.006312</td>
      <td>16.835294</td>
      <td>22.588553</td>
      <td>25.016129</td>
      <td>18.806452</td>
      <td>-5.228581</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350.0</td>
      <td>2.018021e+11</td>
      <td>278.572392</td>
      <td>6.137827</td>
      <td>14.370968</td>
      <td>11.971642</td>
      <td>16.109091</td>
      <td>5.363636</td>
      <td>-11.126866</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350.0</td>
      <td>2.018032e+11</td>
      <td>357.101570</td>
      <td>6.394347</td>
      <td>25.312500</td>
      <td>18.948764</td>
      <td>24.096774</td>
      <td>10.387097</td>
      <td>-7.250687</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350.0</td>
      <td>2.018042e+11</td>
      <td>375.255561</td>
      <td>5.652785</td>
      <td>23.125000</td>
      <td>37.371362</td>
      <td>42.745763</td>
      <td>31.796610</td>
      <td>2.984090</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29350.0</td>
      <td>2.018052e+11</td>
      <td>421.332520</td>
      <td>6.625115</td>
      <td>24.476190</td>
      <td>56.599276</td>
      <td>64.966667</td>
      <td>48.166667</td>
      <td>13.666265</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29350.0</td>
      <td>2.018062e+11</td>
      <td>433.026392</td>
      <td>8.346118</td>
      <td>27.115942</td>
      <td>57.146104</td>
      <td>63.644068</td>
      <td>51.067797</td>
      <td>13.970058</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29350.0</td>
      <td>2.018072e+11</td>
      <td>363.347531</td>
      <td>6.089236</td>
      <td>20.000000</td>
      <td>68.339213</td>
      <td>75.065574</td>
      <td>62.081967</td>
      <td>20.188452</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29350.0</td>
      <td>2.018082e+11</td>
      <td>473.589453</td>
      <td>5.978913</td>
      <td>24.724138</td>
      <td>61.838182</td>
      <td>68.233333</td>
      <td>55.900000</td>
      <td>16.576768</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29350.0</td>
      <td>2.018092e+11</td>
      <td>445.613356</td>
      <td>6.511075</td>
      <td>23.695238</td>
      <td>52.572036</td>
      <td>57.092593</td>
      <td>47.796296</td>
      <td>11.428909</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29350.0</td>
      <td>2.018102e+11</td>
      <td>405.446437</td>
      <td>6.158283</td>
      <td>18.812500</td>
      <td>39.891125</td>
      <td>43.327869</td>
      <td>34.524590</td>
      <td>4.383959</td>
    </tr>
    <tr>
      <th>11</th>
      <td>29350.0</td>
      <td>2.018111e+11</td>
      <td>421.499102</td>
      <td>6.546313</td>
      <td>22.871795</td>
      <td>35.035861</td>
      <td>37.319149</td>
      <td>32.382979</td>
      <td>1.686590</td>
    </tr>
    <tr>
      <th>12</th>
      <td>29350.0</td>
      <td>2.018122e+11</td>
      <td>315.282321</td>
      <td>6.215385</td>
      <td>26.000000</td>
      <td>24.638078</td>
      <td>26.854839</td>
      <td>22.048387</td>
      <td>-4.089957</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">2019</th>
      <th>1</th>
      <td>29350.0</td>
      <td>2.019012e+11</td>
      <td>358.878037</td>
      <td>6.080845</td>
      <td>27.666667</td>
      <td>13.379667</td>
      <td>17.516129</td>
      <td>8.532258</td>
      <td>-10.344629</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29350.0</td>
      <td>2.019021e+11</td>
      <td>380.936620</td>
      <td>8.733899</td>
      <td>31.093333</td>
      <td>26.015928</td>
      <td>30.000000</td>
      <td>21.089286</td>
      <td>-3.324484</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29350.0</td>
      <td>2.019032e+11</td>
      <td>388.804775</td>
      <td>8.178588</td>
      <td>26.846154</td>
      <td>27.790942</td>
      <td>31.516129</td>
      <td>22.500000</td>
      <td>-2.338365</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29350.0</td>
      <td>2.019042e+11</td>
      <td>399.197218</td>
      <td>6.020893</td>
      <td>21.416667</td>
      <td>40.585002</td>
      <td>46.916667</td>
      <td>33.050000</td>
      <td>4.769446</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29350.0</td>
      <td>2.019052e+11</td>
      <td>426.542763</td>
      <td>7.283957</td>
      <td>26.754386</td>
      <td>46.267970</td>
      <td>51.870370</td>
      <td>41.481481</td>
      <td>7.926650</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29350.0</td>
      <td>2.019062e+11</td>
      <td>541.790176</td>
      <td>7.209586</td>
      <td>23.243902</td>
      <td>60.158397</td>
      <td>66.966102</td>
      <td>54.576271</td>
      <td>15.643554</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29350.0</td>
      <td>2.019072e+11</td>
      <td>516.388684</td>
      <td>6.825789</td>
      <td>18.555556</td>
      <td>59.726223</td>
      <td>66.967213</td>
      <td>53.766667</td>
      <td>15.403457</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29350.0</td>
      <td>2.019082e+11</td>
      <td>487.433531</td>
      <td>6.374659</td>
      <td>21.923077</td>
      <td>57.585788</td>
      <td>64.177419</td>
      <td>52.135593</td>
      <td>14.214327</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29350.0</td>
      <td>2.019092e+11</td>
      <td>435.173012</td>
      <td>5.931363</td>
      <td>16.500000</td>
      <td>47.557480</td>
      <td>52.650000</td>
      <td>43.033333</td>
      <td>8.643044</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29350.0</td>
      <td>2.019100e+11</td>
      <td>488.700000</td>
      <td>6.700000</td>
      <td>13.200000</td>
      <td>41.969231</td>
      <td>51.000000</td>
      <td>49.000000</td>
      <td>5.538462</td>
    </tr>
  </tbody>
</table>
<p>826 rows × 9 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Detecting-warm-months">
<h2>Detecting warm months<a class="headerlink" href="#Detecting-warm-months" title="Permalink to this headline">¶</a></h2>
<p>Now, we have aggregated our data on monthly level and all we need to do is to check which years had the warmest April temperatures. A simple approach is to select all aprils from the data, group the data and check which group(s) have the highest mean value:</p>
<ul class="simple">
<li>select all records that are from April (regardless of the year):</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">aprils</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;MONTH&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>take a subset of columns that might contain interesting information:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">aprils</span> <span class="o">=</span> <span class="n">aprils</span><span class="p">[[</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">,</span><span class="s1">&#39;YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;MONTH&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>group by year and month:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">aprils</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">,</span> <span class="s2">&quot;MONTH&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>calculate mean for each group:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">monthly_mean</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">monthly_mean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TEMP_F</th>
      <th>TEMP_C</th>
    </tr>
    <tr>
      <th>YEAR</th>
      <th>MONTH</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1917</th>
      <th>4</th>
      <td>29350</td>
      <td>33.344444</td>
      <td>0.746914</td>
    </tr>
    <tr>
      <th>1918</th>
      <th>4</th>
      <td>29350</td>
      <td>38.811111</td>
      <td>3.783951</td>
    </tr>
    <tr>
      <th>1919</th>
      <th>4</th>
      <td>29350</td>
      <td>33.988372</td>
      <td>1.104651</td>
    </tr>
    <tr>
      <th>1920</th>
      <th>4</th>
      <td>29350</td>
      <td>39.277778</td>
      <td>4.043210</td>
    </tr>
    <tr>
      <th>1921</th>
      <th>4</th>
      <td>29350</td>
      <td>45.144444</td>
      <td>7.302469</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<ul class="simple">
<li>check the highest temperature values (sort the data frame in a descending order):</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">monthly_mean</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TEMP_F</th>
      <th>TEMP_C</th>
    </tr>
    <tr>
      <th>YEAR</th>
      <th>MONTH</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1921</th>
      <th>4</th>
      <td>29350</td>
      <td>45.144444</td>
      <td>7.302469</td>
    </tr>
    <tr>
      <th>1925</th>
      <th>4</th>
      <td>29350</td>
      <td>40.777778</td>
      <td>4.876543</td>
    </tr>
    <tr>
      <th>2011</th>
      <th>4</th>
      <td>29350</td>
      <td>40.670108</td>
      <td>4.816727</td>
    </tr>
    <tr>
      <th>2019</th>
      <th>4</th>
      <td>29350</td>
      <td>40.585002</td>
      <td>4.769446</td>
    </tr>
    <tr>
      <th>2001</th>
      <th>4</th>
      <td>29350</td>
      <td>39.662827</td>
      <td>4.257126</td>
    </tr>
    <tr>
      <th>1920</th>
      <th>4</th>
      <td>29350</td>
      <td>39.277778</td>
      <td>4.043210</td>
    </tr>
    <tr>
      <th>1990</th>
      <th>4</th>
      <td>29350</td>
      <td>39.075949</td>
      <td>3.931083</td>
    </tr>
    <tr>
      <th>1999</th>
      <th>4</th>
      <td>29350</td>
      <td>38.983356</td>
      <td>3.879642</td>
    </tr>
    <tr>
      <th>1918</th>
      <th>4</th>
      <td>29350</td>
      <td>38.811111</td>
      <td>3.783951</td>
    </tr>
    <tr>
      <th>2007</th>
      <th>4</th>
      <td>29350</td>
      <td>38.713256</td>
      <td>3.729587</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>How did April 2019 rank at this observation station 🌡️?</p>
</div>
<div class="section" id="Repeating-the-data-analysis-with-larger-dataset">
<h2>Repeating the data analysis with larger dataset<a class="headerlink" href="#Repeating-the-data-analysis-with-larger-dataset" title="Permalink to this headline">¶</a></h2>
<p>Finally, let’s repeat the data analysis steps above for all the available data we have (!!). First, confirm the path to the <strong>folder</strong> where all the input data are located. The idea is, that we will repeat the analysis process for each input file using a (rather long) for-loop! Here are all the main alaysis steps with some additional print out info - all in one long code cell:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Read selected columns of  data using varying amount of spaces as separator and specifying * characters as NoData values</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;USAF&#39;</span><span class="p">,</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">,</span> <span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">],</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>

<span class="c1"># Rename the columns</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;USAF&#39;</span><span class="p">:</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">:</span> <span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">:</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">:</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">:</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">}</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_names</span><span class="p">)</span>

<span class="c1">#Print info about the current input file:</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;STATION NUMBER:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;STATION_NUMBER&quot;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;NUMBER OF OBSERVATIONS:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="c1"># Create column</span>
<span class="n">col_name</span> <span class="o">=</span> <span class="s1">&#39;TEMP_C&#39;</span>
<span class="n">data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c1"># Convert tempetarues from Fahrenheits to Celsius</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fahr_to_celsius</span><span class="p">)</span>

<span class="c1"># Convert TIME to string</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># Parse year and month</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Extract observations for the months of April</span>
<span class="n">aprils</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># Take a subset of columns</span>
<span class="n">aprils</span> <span class="o">=</span> <span class="n">aprils</span><span class="p">[[</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">,</span> <span class="s1">&#39;YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;MONTH&#39;</span><span class="p">]]</span>

<span class="c1"># Group by year and month</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">aprils</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">,</span> <span class="s2">&quot;MONTH&quot;</span><span class="p">])</span>

<span class="c1"># Get mean values for each group</span>
<span class="n">monthly_mean</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Print info</span>
<span class="k">print</span><span class="p">(</span><span class="n">monthly_mean</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
STATION NUMBER: 29350
NUMBER OF OBSERVATIONS: 559667
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1921 4               29350  45.144444  7.302469
1925 4               29350  40.777778  4.876543
2011 4               29350  40.670108  4.816727
2019 4               29350  40.585002  4.769446
2001 4               29350  39.662827  4.257126


</pre></div></div>
</div>
<p>We will use <code class="docutils literal notranslate"><span class="pre">glob()</span></code> -function from module <code class="docutils literal notranslate"><span class="pre">glob</span></code> to list our input files.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">glob</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\*txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of files in the list&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_list</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of files in the list 15
[&#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\028360.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\028690.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\028750.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\028970.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029070.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029110.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029170.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029350.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029440.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029500.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029700.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029720.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029740.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029810.txt&#39;, &#39;C:\\LocalData\\VUOKKHEI\\codes\\Geo-Python\\data\\weather_data\\029820.txt&#39;]
</pre></div></div>
</div>
<p>Now, you should have all the relevant file names in a list, and we can loop over the list using a for-loop:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\028360.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\028690.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\028750.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\028970.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029070.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029110.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029170.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029350.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029440.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029500.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029700.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029720.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029740.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029810.txt
C:\LocalData\VUOKKHEI\codes\Geo-Python\data\weather_data\029820.txt
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Repeat the analysis steps for each input file:</span>
<span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>

    <span class="c1"># Read selected columns of  data using varying amount of spaces as separator and specifying * characters as NoData values</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;USAF&#39;</span><span class="p">,</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">,</span> <span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">],</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>

    <span class="c1"># Rename the columns</span>
    <span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;USAF&#39;</span><span class="p">:</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">:</span> <span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">:</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">:</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">:</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_names</span><span class="p">)</span>

    <span class="c1">#Print info about the current input file:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;STATION NUMBER:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;STATION_NUMBER&quot;</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;NUMBER OF OBSERVATIONS:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="c1"># Create column</span>
    <span class="n">col_name</span> <span class="o">=</span> <span class="s1">&#39;TEMP_C&#39;</span>
    <span class="n">data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1"># Convert tempetarues from Fahrenheits to Celsius</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fahr_to_celsius</span><span class="p">)</span>

    <span class="c1"># Convert TIME to string</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1"># Parse year and month</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># Extract observations for the months of April</span>
    <span class="n">aprils</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>

    <span class="c1"># Take a subset of columns</span>
    <span class="n">aprils</span> <span class="o">=</span> <span class="n">aprils</span><span class="p">[[</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">,</span> <span class="s1">&#39;YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;MONTH&#39;</span><span class="p">]]</span>

    <span class="c1"># Group by year and month</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">aprils</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">,</span> <span class="s2">&quot;MONTH&quot;</span><span class="p">])</span>

    <span class="c1"># Get mean values for each group</span>
    <span class="n">monthly_mean</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># Print info</span>
    <span class="k">print</span><span class="p">(</span><span class="n">monthly_mean</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
STATION NUMBER: 28360
NUMBER OF OBSERVATIONS: 193825
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1937 4               28360  38.738095  3.743386
2011 4               28360  36.699571  2.610873
1921 4               28360  36.622222  2.567901
2002 4               28360  36.500000  2.500000
2019 4               28360  34.979138  1.655076


STATION NUMBER: 28690
NUMBER OF OBSERVATIONS: 542788
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2011 4               28690  35.430640  1.905911
2019 4               28690  35.215114  1.786174
2016 4               28690  35.031103  1.683946
1989 4               28690  34.612766  1.451537
2002 4               28690  34.279855  1.266586


STATION NUMBER: 28750
NUMBER OF OBSERVATIONS: 474562
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1989 4               28750  39.008403  3.893557
1983 4               28750  38.758475  3.754708
2019 4               28750  38.651599  3.695333
2002 4               28750  38.270419  3.483566
1994 4               28750  38.145833  3.414352


STATION NUMBER: 28970
NUMBER OF OBSERVATIONS: 555740
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1921 4               28970  41.688889  5.382716
1999 4               28970  39.073600  3.929778
2019 4               28970  38.706456  3.725809
1989 4               28970  38.362869  3.534927
2011 4               28970  38.094172  3.385651


STATION NUMBER: 29070
NUMBER OF OBSERVATIONS: 83567
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2014 4               29070  35.437326  1.909626
2015 4               29070  34.437209  1.354005
2004 4               29070  34.347032  1.303907
2016 4               29070  34.303199  1.279555
2008 4               29070  34.241667  1.245370


STATION NUMBER: 29110
NUMBER OF OBSERVATIONS: 483784
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1921 4               29110  42.166667  5.648148
2004 4               29110  41.682699  5.379277
1989 4               29110  41.420168  5.233427
1937 4               29110  40.671429  4.817460
2019 4               29110  40.636300  4.797945


STATION NUMBER: 29170
NUMBER OF OBSERVATIONS: 561097
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1937 4               29170  43.289157  6.271754
2019 4               29170  40.666820  4.814900
2011 4               29170  40.015962  4.453312
2001 4               29170  39.713228  4.285126
1906 4               29170  39.688889  4.271605


STATION NUMBER: 29350
NUMBER OF OBSERVATIONS: 559667
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1921 4               29350  45.144444  7.302469
1925 4               29350  40.777778  4.876543
2011 4               29350  40.670108  4.816727
2019 4               29350  40.585002  4.769446
2001 4               29350  39.662827  4.257126


STATION NUMBER: 29440
NUMBER OF OBSERVATIONS: 757983
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2019 4               29440  42.472030  5.817794
1990 4               29440  41.918084  5.510047
1989 4               29440  41.369647  5.205360
2011 4               29440  41.290730  5.161517
2004 4               29440  41.249676  5.138709


STATION NUMBER: 29500
NUMBER OF OBSERVATIONS: 103105
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2019 4               29500  41.639777  5.355432
2008 4               29500  40.838936  4.910520
2014 4               29500  40.226415  4.570231
2016 4               29500  39.176634  3.987019
2011 4               29500  38.647826  3.693237


STATION NUMBER: 29700
NUMBER OF OBSERVATIONS: 473881
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1921 4               29700  42.811111  6.006173
2000 4               29700  42.375587  5.764215
1990 4               29700  42.054167  5.585648
2019 4               29700  41.548747  5.304859
2004 4               29700  41.493392  5.274107


STATION NUMBER: 29720
NUMBER OF OBSERVATIONS: 843688
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2019 4               29720  43.558414  6.421341
1990 4               29720  43.313576  6.285320
2000 4               29720  42.663169  5.923983
2008 4               29720  42.349642  5.749801
2004 4               29720  41.903492  5.501940


STATION NUMBER: 29740
NUMBER OF OBSERVATIONS: 931767
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2000 4               29740  43.479793  6.377663
2019 4               29740  43.464070  6.368928
1990 4               29740  43.375078  6.319488
2008 4               29740  43.341429  6.300794
2011 4               29740  42.750702  5.972612


STATION NUMBER: 29810
NUMBER OF OBSERVATIONS: 199330
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1990 4               29810  41.157895  5.087719
2019 4               29810  40.783032  4.879462
2014 4               29810  40.058036  4.476687
2008 4               29810  40.044881  4.469378
2016 4               29810  39.270308  4.039060


STATION NUMBER: 29820
NUMBER OF OBSERVATIONS: 198334
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2019 4               29820  41.182197  5.101221
1990 4               29820  41.144681  5.080378
2014 4               29820  40.497908  4.721060
2008 4               29820  39.941423  4.411901
1913 4               29820  39.622222  4.234568


</pre></div></div>
</div>
<p>How about now, how did April 2019 rank across different stations?</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="errors.html" class="btn btn-neutral float-right" title="Dealing with errors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../lessons/L6/overview.html" class="btn btn-neutral float-left" title="Lesson overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, D. Whipp, H. Tenkanen and V. Heikinheimo, Department of Geosciences and Geography, University of Helsinki
      <span class="lastupdated">
        Last updated on Oct 08, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p> <br/> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /> </a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: develop
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../../2017/index.html">2017</a></dd>
            <dd><a href="../../../2018/index.html">2018</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="advanced-data-processing-with-pandas.html">develop</a></dd>
            <dd><a href="../../../master/notebooks/L6/advanced-data-processing-with-pandas.html">master</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
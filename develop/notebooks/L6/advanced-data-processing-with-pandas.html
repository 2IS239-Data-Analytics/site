

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-105019106-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data processing with Pandas, part 2 &mdash; Geo-Python site documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'site',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dealing with errors" href="errors.html" />
    <link rel="prev" title="Lesson overview" href="../../lessons/L6/overview.html" />
    <link href="../../_static/geo-python.css" rel="stylesheet" type="text/css">
     

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Geo-Python
          

          
            
            <img src="../../_static/HY-logo-2017.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2019
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/course-info.html">General info</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/course-info.html#course-meetings-in-period-i">Course meetings in Period I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/course-info.html#instructors">Instructors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/course-info.html#lecturers">Lecturers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/course-info.html#course-assistants">Course assistants</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/course-info.html#course-websites">Course websites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/learning-goals.html">Learning goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/grading.html">Grading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/grading.html#general-grading-breakdown">General grading breakdown</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/installing-anacondas.html">Installing Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#install-python-on-windows">Install Python on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#install-python-on-macos">Install Python on macOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#install-python-on-linux">Install Python on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#installing-packages-using-conda">Installing packages using Conda</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/installing-anacondas.html#the-easiest-way">The easiest way</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/installing-anacondas.html#installing-jupyter-lab-using-conda">Installing Jupyter Lab using conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/installing-anacondas.html#alternative-way-to-install-packages-if-typical-doesn-t-work">Alternative way to install packages if typical doesn’t work</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/python-vocabulary.html">Vocabulary - Basic terms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/python-vocabulary.html#python-vocabulary">Python vocabulary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/python-vocabulary.html#basic-vocabulary-of-version-control">Basic vocabulary of Version Control</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/resources.html">Resources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/resources.html#books">Books</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/resources.html#python-tutorials">Python tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/resources.html#git-github-tutorials">Git + Github tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/licensing.html">License and terms of usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/licensing.html#instructional-materials">Instructional materials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/licensing.html#you-are-free-to">you are free to</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/licensing.html#under-the-following-terms">Under the following terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/licensing.html#notices">Notices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/licensing.html#code-snippets-software">Code snippets / software</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/motivation.html">Motivation for the course</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/motivation.html#effective-data-visualization">Effective data visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/overview.html#lecture-video">Lecture video</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/overview.html#lecture-slides">Lecture slides</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/course-environment-components.html">Course environment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#jupyterlab">JupyterLab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#cloud-computing-environments">Cloud computing environments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#binder">Binder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#csc-notebooks">CSC Notebooks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#using-your-own-computer">Using your own computer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#git-and-github">Git and GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#slack">Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#voting-and-polling">Voting and polling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#page-summary">Page summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/slack-usage.html">Communicating with Slack</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#accessing-the-workspace-in-slack">Accessing the workspace in Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#overview-of-slack">Overview of Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#basic-usage-of-slack">Basic usage of Slack</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/slack-usage.html#notifying-a-user">Notifying a user</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/slack-usage.html#using-threads">Using threads</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#general-guidelines-for-communication">General guidelines for communication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L1/a-taste-of-python.html">A taste of Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/a-taste-of-python.html#General-information">General information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Sources">Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#About-this-document">About this document</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Getting-started">Getting started</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L1/a-taste-of-python.html#Variables,-math-and-functions">Variables, math and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Simple-Python-math">Simple Python math</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Math-operations">Math operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L1/a-taste-of-python.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Combining-functions">Combining functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Variables">Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L1/a-taste-of-python.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Updating-variables">Updating variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Variable-values">Variable values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Data-types">Data types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L1/a-taste-of-python.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Character-input">Character input</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L1/gcp-1-variable-naming.html">Good coding practices - Selecting “good” variable names</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/gcp-1-variable-naming.html#Some-&quot;not-so-good&quot;-variable-names">Some “not-so-good” variable names</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L1/gcp-1-variable-naming.html#Selecting-&quot;good&quot;-variable-names">Selecting “good” variable names</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L1/gcp-1-variable-naming.html#Formatting-&quot;good&quot;-variable-names">Formatting “good” variable names</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/exercise-1.html">Exercise 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/exercise-1.html#part-1-creating-a-github-com-account-and-using-slack">Part 1 - Creating a GitHub.com account and using Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/exercise-1.html#part-2-cooking-up-some-python">Part 2 - Cooking up some Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/exercise-1.html#summary-what-to-submit">Summary (what to submit)</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/overview.html#lecture-video">Lecture video</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L2/Python-basic-elements.html">Basic elements of Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L2/Python-basic-elements.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L2/Python-basic-elements.html#Data-types-revisited">Data types revisited</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Let's-start-with-some-data">Let’s start with some data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Reminder:-Data-types-and-their-compatibility">Reminder: Data types and their compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Converting-data-from-one-type-to-another">Converting data from one type to another</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Combining-text-and-numbers">Combining text and numbers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L2/Python-basic-elements.html#Lists-and-indices">Lists and indices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Creating-a-list">Creating a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Index-values">Index values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#A-useful-analog---Bill-the-vending-machine">A useful analog - Bill the vending machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Number-of-items-in-a-list">Number of items in a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Index-value-tips">Index value tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Modifying-list-values">Modifying list values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Data-types-in-lists">Data types in lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Adding-and-removing-values-from-lists">Adding and removing values from lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Appending-to-an-integer?-Not-so-fast...">Appending to an integer? Not so fast…</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Some-other-useful-list-methods">Some other useful list methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Reversing-a-list">Reversing a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Sorting-a-list">Sorting a list</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L2/gcp-2-describing-code.html">Good coding practices - Describing your code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Do-I-need-to-describe-my-code?">Do I need to describe my code?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#But-seriously,-the-Internet-says-I-shouldn't-comment-my-code">But seriously, the Internet says I shouldn’t comment my code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Code-comments">Code comments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Line-comments">Line comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Block-comments">Block comments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Markdown-text">Markdown text</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Data-source">Data source</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html">Introduction to Version Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#familiar">Familiar?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#what-is-version-control">What is version control?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#what-is-git">What is Git?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#what-is-github">What is GitHub?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#relies-on-git">Relies on Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#social-collaborative-network">Social (collaborative) network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#open-source-science">Open source / science</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#online-tools">Online tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#issue-tracking">Issue tracking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#basic-vocabulary">Basic vocabulary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/git-basics.html">Meet Git</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#overview-and-preparations">Overview and preparations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#key-concepts-and-tools">Key concepts and tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#using-git-from-the-command-line">Using Git from the command line</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#clone-a-repository-from-github">Clone a repository from GitHub</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#add-changes-to-the-staging-area">Add changes to the staging area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#commit-changes">Commit changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#publish-your-local-commits-to-github">Publish your local commits to GitHub</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#using-the-jupyterlab-git-plugin">Using the JupyterLab Git plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#preparations-in-the-terminal">Preparations in the Terminal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#stage-changes-in-the-plugin">Stage changes in the plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#commit-changes-in-the-plugin">Commit changes in the plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#pull-and-push-using-the-plugin">Pull and push using the plugin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#if-everything-else-fails">If everything else fails…</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/GitHub-classroom.html">Using Classroom for Github</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/GitHub-classroom.html#classroom-for-github">Classroom for GitHub</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/exercise-2.html">Exercise 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/exercise-2.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/exercise-2.html#exercise-2-hints">Exercise 2 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/exercise-2.html#git">Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/exercise-2.html#list-methods">List methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/exercise-2.html#indentation-woes">Indentation woes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L3/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/overview.html#lecture">Lecture</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/for-loops.html">for loops</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/for-loops.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/for-loops.html#Basics-of-for-loops">Basics of for loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#A-(bad)-example">A (bad) example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#Introducing-the-for-loop">Introducing the for loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#for-loop-format">for loop format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L3/for-loops.html#Your-daily-for-loop">Your daily for loop</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#for-loop-variables">for loop variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#for-loops-and-the-range()-function">for loops and the range() function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L3/for-loops.html#Poll-question-pause">Poll question pause</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#Looping-over-the-length-of-lists-using-index-values">Looping over the length of lists using index values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#Why-bother-looping-over-a-list-by-the-index-value?">Why bother looping over a list by the index value?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L3/for-loops.html#Poll-question-pause">Poll question pause</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/conditional-statements.html">Conditional statements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/conditional-statements.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/conditional-statements.html#Basics-of-conditional-statements">Basics of conditional statements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#A-simple-conditional-statement">A simple conditional statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#Comparison-operators-and-boolean-values">Comparison operators and boolean values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#if,-elif-and-else">if, elif and else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#Combining-conditions">Combining conditions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L3/conditional-statements.html#Combining-for-loops-and-conditional-statements">Combining for-loops and conditional statements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/gcp-3-pep8.html">Good coding practices - writing readable code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/gcp-3-pep8.html#Working-code-vs-readable-code">Working code vs readable code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/gcp-3-pep8.html#PEP-8-Style-Guide">PEP 8 Style Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Maximum-line-length">Maximum line length</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Indentation">Indentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Whitespace-and-binary-operators">Whitespace and binary operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Avoid-extraneous-whitespace">Avoid extraneous whitespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Write-one-statement-per-line">Write one statement per line</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L3/exercise-3.html">Exercise 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/exercise-3.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/exercise-3.html#exercise-3-hints">Exercise 3 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#general-tips">General tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#tests">Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#combining-strings">Combining strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#nested-if-statements">Nested if statements</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L4/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/overview.html#lecture">Lecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/overview.html#id1">Lecture</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L4/functions.html">Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#What-is-a-function?">What is a function?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Anatomy-of-a-function">Anatomy of a function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Our-first-function-(aww...)">Our first function (aww…)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Calling-functions">Calling functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-new-function">Using our new function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Let's-make-another-function">Let’s make another function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-second-function">Using our second function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Functions-within-a-function-(Yo-dawg...)">Functions within a function (Yo dawg…)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-combined-functions">Using our combined functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#An-introduction-to-script-files">An introduction to script files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#The-general-concept-of-a-.py-script-file">The general concept of a .py script file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Getting-started">Getting started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Saving-a-text-file-as-a-Python-file">Saving a text file as a Python file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Saving-and-loading-functions">Saving and loading functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Saving-functions-in-a-script-file">Saving functions in a script file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Calling-functions-from-a-script-file">Calling functions from a script file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Making-sure-we're-in-the-right-working-directory">Making sure we’re in the right working directory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Binder-users">Binder users</a></li>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#CSC-notebooks-users">CSC notebooks users</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Changing-the-working-directory">Changing the working directory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Binder-users">Binder users</a></li>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#CSC-notebooks-users">CSC notebooks users</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Importing-our-script-functions">Importing our script functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-script-functions">Using our script functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Importing-multiple-functions">Importing multiple functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Importing-all-functions-from-a-script">Importing all functions from a script</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Temperature-calculator-(optional,-advanced-topic)">Temperature calculator (<em>optional, advanced topic</em>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Defining-the-function">Defining the function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Adding-some-conditional-statements">Adding some conditional statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Returning-the-result">Returning the result</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Adding-a-docstring">Adding a docstring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Testing-the-new-function">Testing the new function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-the-tempCalculator">Using the tempCalculator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L4/modules.html">Loading and using modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Modules,-packages-and-libraries?">Modules, packages and libraries?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Loading-modules">Loading modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Renaming-imported-modules">Renaming imported modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Importing-a-single-function">Importing a single function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Importing-a-submodule">Importing a submodule</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Using-module-functions">Using module functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#What-should-I-not-do?">What should I not do?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#from-X-import-*">from X import *</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Poor-names-when-renaming-on-import">Poor names when renaming on import</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Extra:-installing-packages">Extra: installing packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L4/writing-scripts.html">Good coding practices - Writing our scripts the “right” way</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Inline-comments">Inline comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Use-line-breaks-wisely">Use line breaks wisely</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Use-a-docstring">Use a docstring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Advanced-topics">Advanced topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/writing-scripts.html#Adding-a-license">Adding a license</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/writing-scripts.html#Starting-with-a-shebang">Starting with a shebang</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Page-summary">Page summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L4/exercise-4.html">Exercise 4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/exercise-4.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/exercise-4.html#exercise-4-hints">Exercise 4 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L4/exercise-4.html#importing-variables-from-a-script">Importing variables from a script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L4/exercise-4.html#counting-values-from-a-list">Counting values from a list</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/overview.html#lecture-videos">Lecture videos</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/pandas-overview.html">What is Pandas?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/pandas-overview.html#easy-to-use-data-structures">Easy-to-use data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/pandas-overview.html#combines-functionalities-from-many-python-modules">Combines functionalities from many Python modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/pandas-overview.html#supports-data-read-write-from-multiple-formats">Supports data read/write from multiple formats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L5/exploring-data-using-pandas.html">Exploring data using Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Input-data:-weather-statistics">Input data: weather statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Reading-a-data-file-with-Pandas">Reading a data file with Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#DataFrame-properties">DataFrame properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Selecting-columns">Selecting columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Descriptive-statistics">Descriptive statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Extra:-Very-basic-plots">Extra: Very basic plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Extra:-From-lists-to-pandas-objects">Extra: From lists to pandas objects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L5/processing-data-with-pandas.html">Processing data with Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Basic-calculations">Basic calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Selecting-rows-and-columns">Selecting rows and columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Filtering-and-updating-data">Filtering and updating data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Dealing-with-missing-data">Dealing with missing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Data-type-conversions">Data type conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Unique-values">Unique values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Sorting-data">Sorting data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Writing-data-to-a-file">Writing data to a file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/exercise-5.html">Exercise 5</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/exercise-5.html#exercise-5-hints-for-pandas">Exercise 5 hints for Pandas</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 6</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L6/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/overview.html#lesson-videos">Lesson videos</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data processing with Pandas, part 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Motivation">Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Input-data">Input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Downloading-the-data">Downloading the data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#CSC-Notebooks-users">CSC Notebooks users</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Users-with-Jupyter-on-their-personal-computers">Users with Jupyter on their personal computers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Binder-users">Binder users</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#About-the-data">About the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Reading-the-data">Reading the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Renaming-columns">Renaming columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Check-dataframe-properties">Check dataframe properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Using-your-own-functions-in-pandas">Using your own functions in pandas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Iterating-over-rows">Iterating over rows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Applying-a-function">Applying a function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Parsing-dates">Parsing dates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#String-slicing">String slicing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#datetime">datetime</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Aggregating-data-in-Pandas-by-grouping">Aggregating data in Pandas by grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Detecting-warm-months">Detecting warm months</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Repeating-the-data-analysis-with-larger-dataset">Repeating the data analysis with larger dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">Dealing with errors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="errors.html#Interpreting-error-messages">Interpreting error messages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="errors.html#Reading-error-messages">Reading error messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="errors.html#Common-errors-and-exceptions">Common errors and exceptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="errors.html#IndexErrors">IndexErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#NameErrors">NameErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#IndentationErrors">IndentationErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#TypeErrors">TypeErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#Other-kinds-of-errors">Other kinds of errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="errors.html#More-information">More information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gcp-assertions.html">Good coding practices - Using assertions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gcp-assertions.html#Assertions">Assertions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gcp-assertions.html#Multiple-assertions">Multiple assertions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gcp-assertions.html#A-bad-example">A bad example</a></li>
<li class="toctree-l4"><a class="reference internal" href="gcp-assertions.html#A-better-example">A better example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gcp-assertions.html#More-information">More information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging your Python code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Source">Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Test-your-code-with-known-outputs">Test your code with known outputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="debugging.html#Testing-with-a-simplified-data-file">Testing with a simplified data file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Make-your-code-crash-quickly-and-regularly">Make your code crash quickly and regularly</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Make-small-changes-and-track-them">Make small changes and track them</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L6/exercise-6.html">Exercise 6</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/exercise-6.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/exercise-6.html#exercise-6-hints">Exercise 6 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#data-format-for-problems-1-3">Data format for problems 1-3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#reading-in-fixed-width-text-files">Reading in fixed-width text files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#skipping-the-second-row-of-a-file">Skipping the second row of a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#joining-data-from-one-dataframe-to-another">Joining data from one DataFrame to another</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 7</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L7/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L7/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L7/overview.html#lesson-videos">Lesson videos</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L7/python-plotting.html">Plotting in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L7/plot-anatomy.html">Anatomy of a plot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L7/plot-anatomy.html#common-terms-when-doing-plotting">Common terms when doing plotting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L7/matplotlib.html">Plotting with Pandas (…and Matplotlib…and Bokeh)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L7/matplotlib.html#Input-data">Input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L7/matplotlib.html#Downloading-the-data">Downloading the data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L7/matplotlib.html#Binder-users">Binder users</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L7/matplotlib.html#About-the-data">About the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L7/matplotlib.html#Getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L7/matplotlib.html#Basic-x-y-plot">Basic x-y plot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L7/matplotlib.html#Selecting-our-plotted-data">Selecting our plotted data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L7/matplotlib.html#Basic-plot-formatting">Basic plot formatting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L7/matplotlib.html#Embiggening*-the-plot">Embiggening* the plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L7/matplotlib.html#Other-common-plot-formatting-operations">Other common plot formatting operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L7/matplotlib.html#Adding-text-to-the-plot">Adding text to the plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../L7/matplotlib.html#Changing-the-axis-ranges">Changing the axis ranges</a></li>
<li class="toctree-l4"><a class="reference internal" href="../L7/matplotlib.html#Dealing-with-datetime-axes">Dealing with datetime axes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L7/matplotlib.html#Bar-plots-in-Pandas">Bar plots in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L7/matplotlib.html#Saving-your-plots-as-image-files">Saving your plots as image files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L7/matplotlib.html#Interactive-plotting-with-Pandas-Bokeh">Interactive plotting with Pandas-Bokeh</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L7/advanced-plotting.html">More advanced plotting with Pandas/Matplotlib</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L7/advanced-plotting.html#The-data">The data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L7/advanced-plotting.html#Getting-started">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L7/advanced-plotting.html#Loading-the-data">Loading the data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L7/advanced-plotting.html#Preparing-the-data">Preparing the data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L7/advanced-plotting.html#Converting-temperatures-to-Celsius">Converting temperatures to Celsius</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L7/advanced-plotting.html#Using-subplots">Using subplots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L7/advanced-plotting.html#Extracting-seasonal-temperatures">Extracting seasonal temperatures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L7/advanced-plotting.html#Finding-data-bounds">Finding data bounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L7/advanced-plotting.html#Creating-our-first-set-of-subplots">Creating our first set of subplots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L7/exercise-7.html">Exercise 7</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L7/exercise-7.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L7/exercise-7.html#hints-for-exercise-7">Hints for Exercise 7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L7/exercise-7.html#labels-and-legends">Labels and legends</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L7/exercise-7.html#using-enumerate">Using <code class="docutils literal notranslate"><span class="pre">enumerate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L7/exercise-7.html#saving-multiple-plots-into-a-directory">Saving multiple plots into a directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L7/exercise-7.html#settings-for-multiple-subplots">Settings for multiple subplots:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L7/exercise-7.html#preventing-plot-display">Preventing plot display</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L7/exercise-7.html#creating-an-animation-from-multiple-images">Creating an animation from multiple images</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L7/exercise-7.html#creating-the-animation">Creating the animation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L7/exercise-7.html#numpy-specific-hints">NumPy-specific hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L7/exercise-7.html#extracting-seasonal-dates-and-temperatures-in-many-years">Extracting seasonal dates and temperatures (in many years)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L7/exercise-7.html#finding-seasonal-average-temperatures-by-year">Finding seasonal average temperatures (by year)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Geo-Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Data processing with Pandas, part 2</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/geo-python/site/blob/develop/source/notebooks/L6/advanced-data-processing-with-pandas.ipynb" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  


    
    



    <p class="scv-banner scv-sphinx_rtd_theme"><a href="../../../master/notebooks/L6/advanced-data-processing-with-pandas.html"><b>Warning:</b> This document is for the development version of Geo-Python. The main version is master.</a></p>

<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
This page was generated from <a class="reference external" href="https://github.com/Geo-Python/site/blob/master/source/notebooks/L6/advanced-data-processing-with-pandas.ipynb">source/notebooks/L6/advanced-data-processing-with-pandas.ipynb</a>.
<span class="raw-html"><br/><a href="https://mybinder.org/v2/gh/geo-python/site/master?urlpath=lab/tree/source/notebooks/L6/advanced-data-processing-with-pandas.ipynb"><img alt="Binder badge" src="https://img.shields.io/badge/launch-full%20binder-red.svg" style="vertical-align:text-bottom"></a></span>
<span class="raw-html"><a href="https://mybinder.org/v2/gh/geo-python/notebooks/master?urlpath=lab/tree/notebooks/L6/advanced-data-processing-with-pandas.ipynb"><img alt="Binder badge" src="https://img.shields.io/badge/launch-student%20binder-red.svg" style="vertical-align:text-bottom"></a></span>
<span class="raw-html"><a href="https://notebooks.csc.fi/#/blueprint/df93f30d14e44b51907d135726eb6ef4"><img alt="CSC badge" src="https://img.shields.io/badge/launch-CSC%20notebook-blue.svg" style="vertical-align:text-bottom"></a></span></div>
<div class="section" id="Data-processing-with-Pandas,-part-2">
<h1>Data processing with Pandas, part 2<a class="headerlink" href="#Data-processing-with-Pandas,-part-2" title="Permalink to this headline">¶</a></h1>
<p>This week we will continue developing our skills using <a class="reference external" href="https://pandas.pydata.org/">Pandas</a> to process real data.</p>
<div class="section" id="Motivation">
<h2>Motivation<a class="headerlink" href="#Motivation" title="Permalink to this headline">¶</a></h2>
<p><img alt="Finland April 2019" src="../../_images/Finland-April-2019.png" /> <em>Source: https://weather.com/news/climate/news/2019-05-20-april-2019-global-temperatures-nasa-noaa</em></p>
<p>April 2019 was the <a class="reference external" href="https://weather.com/news/climate/news/2019-05-20-april-2019-global-temperatures-nasa-noaa">second warmest April on record globally</a>, and the warmest on record at 13 weather stations in Finland. In this lesson, we will use our data manipulation and analysis skills to analyze weather data from Finland, and investigate the claim that April 2019 was the warmest on record across Finland.</p>
<p>Along the way we will cover a number of useful techniques in pandas including:</p>
<ul class="simple">
<li>renaming columns</li>
<li>iterating data frame rows and applying functions</li>
<li>data aggregation</li>
<li>repeating the analysis task for several input files</li>
</ul>
</div>
<div class="section" id="Input-data">
<h2>Input data<a class="headerlink" href="#Input-data" title="Permalink to this headline">¶</a></h2>
<p>In the lesson this week we are using weather observation data from Finland <a class="reference external" href="https://www7.ncdc.noaa.gov/CDO/cdopoemain.cmd?datasetabbv=DS3505&amp;countryabbv=&amp;georegionabbv=&amp;resolution=40">downloaded from NOAA</a>. You will be working with data from either 15 or 4 different weather obsercation stations from Finland, depending on your environment.</p>
</div>
<div class="section" id="Downloading-the-data">
<h2>Downloading the data<a class="headerlink" href="#Downloading-the-data" title="Permalink to this headline">¶</a></h2>
<p>The first step for today’s lesson is to get the data. Which data files you download will depend on the platform you’re using for working through the lesson today.</p>
<div class="section" id="CSC-Notebooks-users">
<h3>CSC Notebooks users<a class="headerlink" href="#CSC-Notebooks-users" title="Permalink to this headline">¶</a></h3>
<p>If you’re working on the CSC Notebooks platform, you can download the data by opening a new terminal window in Jupyter Lab by going to <strong>File</strong> -&gt; <strong>New</strong> -&gt; <strong>Terminal</strong> in the Jupyter Lab menu bar. Once the terminal is open, you will need to navigate to the directory for Lesson 6 by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> notebooks/notebooks/L6/
</pre></div>
</div>
<p>Once in the correct directory, you can confirm this by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls
</pre></div>
</div>
<p>You should see something like the following output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>advanced-data-processing-with-pandas.ipynb errors.ipynb                               img
debugging.ipynb                            gcp-assertions.ipynb
</pre></div>
</div>
<p>If so, you’re in the correct directory and you can download the data files by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://davewhipp.github.io/data/Finland-weather-data-CSC.tar.gz
</pre></div>
</div>
<p>After the download completes, you can extract the data files by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar zxvf Finland-weather-data-CSC.tar.gz
</pre></div>
</div>
<p>At this stage you should have a new directory called <code class="docutils literal notranslate"><span class="pre">data</span></code> that contains the data for this week’s lesson. You can confirm this by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls data
</pre></div>
</div>
<p>You should see something like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">029440</span>.txt           <span class="m">029720</span>.txt           3505doc.txt          6367598020644stn.txt
<span class="m">029700</span>.txt           <span class="m">029740</span>.txt           6367598020644inv.txt
</pre></div>
</div>
<p>Now you should be all set to proceed with the lesson!</p>
</div>
<div class="section" id="Users-with-Jupyter-on-their-personal-computers">
<h3>Users with Jupyter on their personal computers<a class="headerlink" href="#Users-with-Jupyter-on-their-personal-computers" title="Permalink to this headline">¶</a></h3>
<p>If you’re working on your own computer, you can download the data by opening a new terminal window in Jupyter Lab by going to <strong>File</strong> -&gt; <strong>New</strong> -&gt; <strong>Terminal</strong> in the Jupyter Lab menu bar. Once the terminal is open, you will need to navigate to the directory for Lesson 6 by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> path/to/L6/
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">path/to/</span></code> should be replaced with the directories needed to locate the Lesson 6 materials in on your computer. Once in the correct directory, you can confirm this by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls
</pre></div>
</div>
<p>You should see something like the following output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>advanced-data-processing-with-pandas.ipynb errors.ipynb                               img
debugging.ipynb                            gcp-assertions.ipynb
</pre></div>
</div>
<p>If so, you’re in the correct directory and you can download the data files by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://davewhipp.github.io/data/Finland-weather-data-full.tar.gz
</pre></div>
</div>
<p>After the download completes, you can extract the data files by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar zxvf Finland-weather-data-full.tar.gz
</pre></div>
</div>
<p>At this stage you should have a new directory called <code class="docutils literal notranslate"><span class="pre">data</span></code> that contains the data for this week’s lesson. You can confirm this by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls data
</pre></div>
</div>
<p>You should see something like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">028360</span>.txt           <span class="m">029070</span>.txt           <span class="m">029440</span>.txt           <span class="m">029740</span>.txt  6367598020644inv.txt
<span class="m">028690</span>.txt           <span class="m">029110</span>.txt           <span class="m">029500</span>.txt           <span class="m">029810</span>.txt  6367598020644stn.txt
<span class="m">028750</span>.txt           <span class="m">029170</span>.txt           <span class="m">029700</span>.txt           <span class="m">029820</span>.txt
<span class="m">028970</span>.txt           <span class="m">029350</span>.txt           <span class="m">029720</span>.txt           3505doc.txt
</pre></div>
</div>
<p>Now you should be all set to proceed with the lesson!</p>
</div>
<div class="section" id="Binder-users">
<h3>Binder users<a class="headerlink" href="#Binder-users" title="Permalink to this headline">¶</a></h3>
<p>It is not recommended to complete this lesson using Binder.</p>
</div>
</div>
<div class="section" id="About-the-data">
<h2>About the data<a class="headerlink" href="#About-the-data" title="Permalink to this headline">¶</a></h2>
<p>As part of the download there are a number of files that describe the weather data. These <em>metadata</em> files include:</p>
<ul class="simple">
<li>A list of stations*: <a class="reference external" href="metadata/6367598020644stn.txt">data/6367598020644stn.txt</a></li>
<li>Details about weather observations at each station: <a class="reference external" href="metadata/6367598020644inv.txt">data/6367598020644inv.txt</a></li>
<li>A data description (i.e., column names): <a class="reference external" href="metadata/3505doc.txt">data/3505doc.txt</a></li>
</ul>
<p>*Note that the list of stations is for all 15 stations, even if you’re working with only the 4 stations on the CSC Notebooks platform.</p>
<p>The input data for this week are separated with varying number of spaces (i.e., fixed width). The first lines and columns of the data look like following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">USAF</span>  <span class="n">WBAN</span> <span class="n">YR</span><span class="o">--</span><span class="n">MODAHRMN</span> <span class="n">DIR</span> <span class="n">SPD</span> <span class="n">GUS</span> <span class="n">CLG</span> <span class="n">SKC</span> <span class="n">L</span> <span class="n">M</span> <span class="n">H</span>  <span class="n">VSB</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">W</span> <span class="n">TEMP</span> <span class="n">DEWP</span>    <span class="n">SLP</span>   <span class="n">ALT</span>    <span class="n">STP</span> <span class="n">MAX</span> <span class="n">MIN</span> <span class="n">PCP01</span> <span class="n">PCP06</span> <span class="n">PCP24</span> <span class="n">PCPXX</span> <span class="n">SD</span>
<span class="mi">029440</span> <span class="mi">99999</span> <span class="mi">190601010600</span> <span class="mi">090</span>   <span class="mi">7</span> <span class="o">***</span> <span class="o">***</span> <span class="n">OVC</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">0.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">27</span> <span class="o">****</span> <span class="mf">1011.0</span> <span class="o">*****</span> <span class="o">******</span> <span class="o">***</span> <span class="o">***</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">**</span>
<span class="mi">029440</span> <span class="mi">99999</span> <span class="mi">190601011300</span> <span class="o">***</span>   <span class="mi">0</span> <span class="o">***</span> <span class="o">***</span> <span class="n">OVC</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">0.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">27</span> <span class="o">****</span> <span class="mf">1015.5</span> <span class="o">*****</span> <span class="o">******</span> <span class="o">***</span> <span class="o">***</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">**</span>
<span class="mi">029440</span> <span class="mi">99999</span> <span class="mi">190601012000</span> <span class="o">***</span>   <span class="mi">0</span> <span class="o">***</span> <span class="o">***</span> <span class="n">OVC</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">0.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">25</span> <span class="o">****</span> <span class="mf">1016.2</span> <span class="o">*****</span> <span class="o">******</span> <span class="o">***</span> <span class="o">***</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">**</span>
<span class="mi">029440</span> <span class="mi">99999</span> <span class="mi">190601020600</span> <span class="o">***</span>   <span class="mi">0</span> <span class="o">***</span> <span class="o">***</span> <span class="n">CLR</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">0.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">26</span> <span class="o">****</span> <span class="mf">1016.2</span> <span class="o">*****</span> <span class="o">******</span> <span class="o">***</span> <span class="o">***</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">*****</span> <span class="o">**</span>
</pre></div>
</div>
<p>We will develop our analysis workflow using data for a single station. Then, we will repeat the same process for all the stations.</p>
</div>
<div class="section" id="Reading-the-data">
<h2>Reading the data<a class="headerlink" href="#Reading-the-data" title="Permalink to this headline">¶</a></h2>
<p>In order to get started, let’s import pandas:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<p>At this point, you can already have a quick look at the input file <code class="docutils literal notranslate"><span class="pre">029440.txt</span></code> for Tampere Pirkkala and how it is structured. We can notice at least two things we need to consider when reading in the data:</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>NOTE: Input data structure</strong></p>
<ul class="simple">
<li><strong>Delimiter:</strong> The data are <strong>separated with varying amount of spaces</strong>. If you check out the documentation for the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">read_csv() method</a>, you can see that there are two different ways of doing this. We can either use the <code class="docutils literal notranslate"><span class="pre">sep</span></code> or <code class="docutils literal notranslate"><span class="pre">delim_whitespace</span></code> parameter; <code class="docutils literal notranslate"><span class="pre">sep='\s+'</span></code> or <code class="docutils literal notranslate"><span class="pre">delim_whitespace=True</span></code> but not both. In this case, we prefer to use <code class="docutils literal notranslate"><span class="pre">delim_whitespace</span></code>.</li>
<li><strong>No Data values:</strong> No data values in the NOAA data are coded with varyingg number of <code class="docutils literal notranslate"><span class="pre">*</span></code>. We can tell pandas to consider those characters as NaNs by specifying <code class="docutils literal notranslate"><span class="pre">na_values=['*',</span> <span class="pre">'**',</span> <span class="pre">'***',</span> <span class="pre">'****',</span> <span class="pre">'*****',</span> <span class="pre">'******']</span></code>.</li>
</ul>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fp</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;data/029440.txt&quot;</span>

<span class="c1"># Read data using varying amount of spaces as separator and specifying * characters as NoData values</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\HYapp\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py:3058: DtypeWarning: Columns (29,30,31) have mixed types. Specify dtype option on import or set low_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)
</pre></div></div>
</div>
<ul class="simple">
<li>Let’s see how the data looks by printing the first five rows with the <code class="docutils literal notranslate"><span class="pre">head()</span></code> function</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    USAF   WBAN  YR--MODAHRMN    DIR  SPD  GUS  CLG  SKC   L   M ...     SLP  \
0  29440  99999  190601010600   90.0  7.0  NaN  NaN  OVC NaN NaN ...  1011.0
1  29440  99999  190601011300    NaN  0.0  NaN  NaN  OVC NaN NaN ...  1015.5
2  29440  99999  190601012000    NaN  0.0  NaN  NaN  OVC NaN NaN ...  1016.2
3  29440  99999  190601020600    NaN  0.0  NaN  NaN  CLR NaN NaN ...  1016.2
4  29440  99999  190601021300  270.0  7.0  NaN  NaN  OVC NaN NaN ...  1015.6

   ALT  STP  MAX  MIN  PCP01  PCP06  PCP24  PCPXX  SD
0  NaN  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN
1  NaN  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN
2  NaN  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN
3  NaN  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN
4  NaN  NaN  NaN  NaN    NaN    NaN    NaN    NaN NaN

[5 rows x 33 columns]
</pre></div></div>
</div>
<p>All seems ok. However, we won’t be needing all of the 33 columns for detecting warm temperatures in April. We can check all column names by running <code class="docutils literal notranslate"><span class="pre">data.columns</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;USAF&#39;, &#39;WBAN&#39;, &#39;YR--MODAHRMN&#39;, &#39;DIR&#39;, &#39;SPD&#39;, &#39;GUS&#39;, &#39;CLG&#39;, &#39;SKC&#39;, &#39;L&#39;,
       &#39;M&#39;, &#39;H&#39;, &#39;VSB&#39;, &#39;MW&#39;, &#39;MW.1&#39;, &#39;MW.2&#39;, &#39;MW.3&#39;, &#39;AW&#39;, &#39;AW.1&#39;, &#39;AW.2&#39;,
       &#39;AW.3&#39;, &#39;W&#39;, &#39;TEMP&#39;, &#39;DEWP&#39;, &#39;SLP&#39;, &#39;ALT&#39;, &#39;STP&#39;, &#39;MAX&#39;, &#39;MIN&#39;, &#39;PCP01&#39;,
       &#39;PCP06&#39;, &#39;PCP24&#39;, &#39;PCPXX&#39;, &#39;SD&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<p>A description for all these columns is available in the metadata file <a class="reference external" href="metadata/3505doc.txt">data/3505doc.txt</a>.</p>
<p><strong>Let’s read in the data one more time.</strong> This time, we will read in only some of the columns using the <code class="docutils literal notranslate"><span class="pre">usecols</span></code> parameter. Let’s read in columns that might be somehow useful to our analysis, or at least that contain some values that are meaningful to us, including the station name, timestamp, and data about wind and temperature: <code class="docutils literal notranslate"><span class="pre">'USAF','YR--MODAHRMN',</span> <span class="pre">'DIR',</span> <span class="pre">'SPD',</span> <span class="pre">'GUS','TEMP',</span> <span class="pre">'MAX',</span> <span class="pre">'MIN'</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;USAF&#39;</span><span class="p">,</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">,</span> <span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">],</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>USAF</th>
      <th>YR--MODAHRMN</th>
      <th>DIR</th>
      <th>SPD</th>
      <th>GUS</th>
      <th>TEMP</th>
      <th>MAX</th>
      <th>MIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29440</td>
      <td>190601010600</td>
      <td>90.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29440</td>
      <td>190601011300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440</td>
      <td>190601012000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440</td>
      <td>190601020600</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440</td>
      <td>190601021300</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Okay so we can see that the data was successfully read to the DataFrame and we also seemed to be able to convert the asterisk (*) characters into <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values.</p>
</div>
<div class="section" id="Renaming-columns">
<h2>Renaming columns<a class="headerlink" href="#Renaming-columns" title="Permalink to this headline">¶</a></h2>
<p>Check again the column names in our DataFrame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;USAF&#39;, &#39;YR--MODAHRMN&#39;, &#39;DIR&#39;, &#39;SPD&#39;, &#39;GUS&#39;, &#39;TEMP&#39;, &#39;MAX&#39;, &#39;MIN&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<p>The column names that we have are somewhat ackward. Let’s change them into more intuitive ones. This can be done easily using the <code class="docutils literal notranslate"><span class="pre">rename()</span></code> method and a dictionary that lists old and new column names.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Dictionaries</strong></p>
<p><a class="reference external" href="https://docs.python.org/2/tutorial/datastructures.html#dictionaries">Dictionary</a> is a spesific data structure in Python for storing key-value pairs. During this course, we will use dictionaries mainly when renaming columns in a pandas series, but dictionaries are useful for many different purposes! For more information about Python dictionaries, check out <a class="reference external" href="https://realpython.com/python-dicts/">this tutorial</a>.</p>
</div>
<p>We can define the new column names using a <a class="reference external" href="https://www.tutorialspoint.com/python/python_dictionary.htm">dictionary</a> where we determine “<code class="docutils literal notranslate"><span class="pre">key:</span> <span class="pre">value</span></code>” -pairs, in which the original column name (the one which will be replaced) is the key, and the new column name is the value.</p>
<ul class="simple">
<li>Let’s change:</li>
<li><code class="docutils literal notranslate"><span class="pre">YR--MODAHRMN</span></code> column into <code class="docutils literal notranslate"><span class="pre">TIME</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">SPD</span></code> into <code class="docutils literal notranslate"><span class="pre">SPEED</span></code>, and</li>
<li><code class="docutils literal notranslate"><span class="pre">GUS</span></code> into <code class="docutils literal notranslate"><span class="pre">GUST</span></code></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create the dictionary with old and new names</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">:</span> <span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">:</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">:</span> <span class="s1">&#39;GUST&#39;</span><span class="p">}</span>

<span class="c1"># Let&#39;s see what they look like and what is the type</span>
<span class="k">print</span><span class="p">(</span><span class="n">new_names</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new_names</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;SPD&#39;: &#39;SPEED&#39;, &#39;YR--MODAHRMN&#39;: &#39;TIME&#39;, &#39;GUS&#39;: &#39;GUST&#39;}
&lt;class &#39;dict&#39;&gt;
</pre></div></div>
</div>
<p>From above we can see that we have successfully created a dictionary that is of type <code class="docutils literal notranslate"><span class="pre">dict</span></code>.</p>
<ul class="simple">
<li>Now we can change the column names by passing that dictionary into parameter <code class="docutils literal notranslate"><span class="pre">columns</span></code> in <code class="docutils literal notranslate"><span class="pre">rename()</span></code> -function.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Rename the columns</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_names</span><span class="p">)</span>

<span class="c1"># Print the new columns</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;USAF&#39;, &#39;TIME&#39;, &#39;DIR&#39;, &#39;SPEED&#39;, &#39;GUST&#39;, &#39;TEMP&#39;, &#39;MAX&#39;, &#39;MIN&#39;], dtype=&#39;object&#39;)
</pre></div></div>
</div>
<p>Perfect, now our column names are more easy to understand and use.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>TASK: Renaming columns</strong></p>
<p>The temperature values are again in Fahrenheit. As you might guess, we will soon convert these temperatures in to Celsius. In order to avoid confusion with the columns, rename column <code class="docutils literal notranslate"><span class="pre">TEMP</span></code> into <code class="docutils literal notranslate"><span class="pre">TEMP_F</span></code>. Also, we could rename <code class="docutils literal notranslate"><span class="pre">USAF</span></code> as<code class="docutils literal notranslate"><span class="pre">STATION_NUMBER</span></code>.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create the dictionary with old and new names</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;USAF&#39;</span><span class="p">:</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">:</span> <span class="s1">&#39;TEMP_F&#39;</span><span class="p">}</span>

<span class="c1"># Rename the columns</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_names</span><span class="p">)</span>

<span class="c1"># Check the output</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29440</td>
      <td>190601010600</td>
      <td>90.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29440</td>
      <td>190601011300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440</td>
      <td>190601012000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440</td>
      <td>190601020600</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440</td>
      <td>190601021300</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Check-dataframe-properties">
<h2>Check dataframe properties<a class="headerlink" href="#Check-dataframe-properties" title="Permalink to this headline">¶</a></h2>
<p>As we learned last week, it’s always a good idea to check basic properties of the input data before proceeding with data analysis. Let’s check:</p>
<ul class="simple">
<li>How many rows and columns we have:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(757983, 8)
</pre></div>
</div>
</div>
<ul class="simple">
<li>Top and bottom rows:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29440</td>
      <td>190601010600</td>
      <td>90.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29440</td>
      <td>190601011300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440</td>
      <td>190601012000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440</td>
      <td>190601020600</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440</td>
      <td>190601021300</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>757978</th>
      <td>29440</td>
      <td>201910012220</td>
      <td>130.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>39.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>757979</th>
      <td>29440</td>
      <td>201910012250</td>
      <td>110.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>37.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>757980</th>
      <td>29440</td>
      <td>201910012300</td>
      <td>100.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>38.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>757981</th>
      <td>29440</td>
      <td>201910012320</td>
      <td>100.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>37.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>757982</th>
      <td>29440</td>
      <td>201910012350</td>
      <td>110.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>37.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<ul class="simple">
<li>Data types of the columns:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>STATION_NUMBER      int64
TIME                int64
DIR               float64
SPEED             float64
GUST              float64
TEMP_F            float64
MAX               float64
MIN               float64
dtype: object
</pre></div>
</div>
</div>
<ul class="simple">
<li>Descriptive statistics:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
       STATION_NUMBER          TIME            DIR          SPEED  \
count        757983.0  7.579830e+05  699256.000000  750143.000000
mean          29440.0  1.999974e+11     233.499846       6.742641
std               0.0  1.629544e+09     209.707258       4.296191
min           29440.0  1.906010e+11      10.000000       0.000000
25%           29440.0  1.989083e+11     130.000000       3.000000
50%           29440.0  2.004042e+11     200.000000       7.000000
75%           29440.0  2.012050e+11     270.000000       9.000000
max           29440.0  2.019100e+11     990.000000      61.000000

               GUST         TEMP_F           MAX           MIN
count  19906.000000  754862.000000  23869.000000  23268.000000
mean      20.147996      40.409778     45.373539     35.783737
std        7.415138      17.898715     18.242679     17.195427
min       11.000000     -33.000000    -26.000000    -32.000000
25%       14.000000      29.000000     32.000000     26.000000
50%       18.000000      39.000000     44.000000     36.000000
75%       26.000000      54.000000     60.000000     49.000000
max      108.000000      91.000000     91.000000     81.000000
</pre></div></div>
</div>
<p>Here we can see that there are varying number of observations per column (see the <code class="docutils literal notranslate"><span class="pre">count</span></code> information), because some of the columns have missing values.</p>
</div>
<div class="section" id="Using-your-own-functions-in-pandas">
<h2>Using your own functions in pandas<a class="headerlink" href="#Using-your-own-functions-in-pandas" title="Permalink to this headline">¶</a></h2>
<p>Now it’s again time to convert temperatures from Fahrenheit to Celsius! Yes, we have already done this many times before, but this time we will learn how to apply self-made functions to data in a pandas DataFrame. <strong>In short, our task is to define a function for the temperature conversion, and to apply this function for each Celsius value on each row of the DataFrame. Output celsius values should be stored in a new column called</strong> <code class="docutils literal notranslate"><span class="pre">TEMP_C</span></code>.</p>
<p>Knowing how to use your own function in pandas can be really useful when doing your own analyses. Here, we will introduce two different approaches for using function in pandas. First, we will see how we can apply the function row-by-row using a <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop and the <code class="docutils literal notranslate"><span class="pre">DataFrame.iterrows()</span></code>-method, and then we will learn how to apply the method to all rows at once using <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.apply.html">DataFrame.apply</a>.</p>
<p>For both of these approaches, we first need to define our temperature conversion function from Fahrenheit to Celsius:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">fahr_to_celsius</span><span class="p">(</span><span class="n">temp_fahrenheit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to convert Fahrenheit temperature into Celsius.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    temp_fahrenheit: int | float</span>
<span class="sd">        Input temperature in Fahrenheit (should be a number)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    Temperature in Celsius (float)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Convert the Fahrenheit into Celsius and return it</span>
    <span class="n">converted_temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_fahrenheit</span> <span class="o">-</span> <span class="mi">32</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.8</span>
    <span class="k">return</span> <span class="n">converted_temp</span>
</pre></div>
</div>
</div>
<p><strong>Note:</strong> with such a simple example, we could use the function direcly on a column in the DataFrame in order to conver the values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fahr_to_celsius</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_F&quot;</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29440</td>
      <td>190601010600</td>
      <td>90.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29440</td>
      <td>190601011300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440</td>
      <td>190601012000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.888889</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440</td>
      <td>190601020600</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.333333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440</td>
      <td>190601021300</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>If we want to do something more complicated, we need to know how to apply the function row-by-row.</p>
<div class="section" id="Iterating-over-rows">
<h3>Iterating over rows<a class="headerlink" href="#Iterating-over-rows" title="Permalink to this headline">¶</a></h3>
<p>We can iterate over the rows of Pandas DataFrame by using the <code class="docutils literal notranslate"><span class="pre">iterrows()</span></code> -method and use the function one row at a time.</p>
<p>When iterating over the rows in our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, it is noteworthy to understand that pandas actually keeps track on the <code class="docutils literal notranslate"><span class="pre">index</span></code> value as well. Hence, the contents of a single row actually contains not only the values, but also the <code class="docutils literal notranslate"><span class="pre">index</span></code> of that row (each row is a pandas Series!).</p>
<ul class="simple">
<li>Let’s see how <code class="docutils literal notranslate"><span class="pre">iterrows()</span></code> works by printing out the <code class="docutils literal notranslate"><span class="pre">TEMP</span></code> value on each row using a <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Iterate over the rows</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Print the index value</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Index:&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>

    <span class="c1"># Print the row</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Temp F:&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;TEMP_F&quot;</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index: 0
Temp F: 27.0

</pre></div></div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>break</strong></p>
<p>When developing a for-loop, you don’t always need to go trough the whole loop if you just want to test things out. <a class="reference external" href="https://www.tutorialspoint.com/python/python_break_statement.htm">break</a> statement in Python terminates the current loop after the first iteration and we used it here just to test check out the values on the first row. With a large data, you might not want to print out thousands of values to the screen!</p>
</div>
<p>We can see that the <code class="docutils literal notranslate"><span class="pre">idx</span></code> variable indeed contains the index value at position 0 (the first row) and the <code class="docutils literal notranslate"><span class="pre">row</span></code> variable contains all the data from that given row stored as a pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<ul class="simple">
<li>Let’s now create an empty column <code class="docutils literal notranslate"><span class="pre">TEMP_C</span></code> for the Celsius temperatures and update the values into that column using the <code class="docutils literal notranslate"><span class="pre">fahr_to_celsius</span></code> function we defined earlier:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty column for the DataFrame where the values will be stored</span>
<span class="n">new_column</span> <span class="o">=</span> <span class="s2">&quot;TEMP_C&quot;</span>
<span class="n">data</span><span class="p">[</span><span class="n">new_column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c1"># Iterate over the rows</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Convert the Fahrenheit to Celsius</span>
    <span class="n">celsius</span> <span class="o">=</span> <span class="n">fahr_to_celsius</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">])</span>

    <span class="c1"># Update the value of &#39;Celsius&#39; column with the converted value</span>
    <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">new_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">celsius</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Reminder: .at or .loc?</strong></p>
<p>Here, you could also use <code class="docutils literal notranslate"><span class="pre">data.loc[idx,</span> <span class="pre">new_column]</span> <span class="pre">=</span> <span class="pre">celsius</span></code> to achieve the same result.</p>
<p>If you only need to access a single value in a DataFrame, <a class="reference external" href="https://pandas.pydata.org/pandas-docs/version/0.25/reference/api/pandas.DataFrame.at.html">DataFrame.at</a> is faster compared to <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html">DataFrame.loc</a> which is designed for accessing groups of rows and columns.</p>
<p>Check out more examples for using <code class="docutils literal notranslate"><span class="pre">.at</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc</span></code> from lesson 5 materials.</p>
</div>
<ul class="simple">
<li>Let’s see what we have now.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29440</td>
      <td>190601010600</td>
      <td>90.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.77778</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29440</td>
      <td>190601011300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.77778</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440</td>
      <td>190601012000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.88889</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440</td>
      <td>190601020600</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.33333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440</td>
      <td>190601021300</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.77778</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29440</td>
      <td>190601022000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.77778</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29440</td>
      <td>190601030600</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.33333</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29440</td>
      <td>190601031300</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.88889</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29440</td>
      <td>190601032000</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>24.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-4.44444</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29440</td>
      <td>190601040600</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-7.77778</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Great! Now we have converted our temperatures into Celsius by using our self-made function.</p>
</div>
<div class="section" id="Applying-a-function">
<h3>Applying a function<a class="headerlink" href="#Applying-a-function" title="Permalink to this headline">¶</a></h3>
<p>Pandas DataFrames and Series also have a dedicated method <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> for applying functions on columns (or rows!). When using <code class="docutils literal notranslate"><span class="pre">.apply()</span></code>, we pass the function name (without parenthesis!) as an argument:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fahr_to_celsius</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29440</td>
      <td>190601010600</td>
      <td>90.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29440</td>
      <td>190601011300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440</td>
      <td>190601012000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.888889</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440</td>
      <td>190601020600</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.333333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440</td>
      <td>190601021300</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Note:</strong> pay attention which column you are applying the function on! Running this code: <code class="docutils literal notranslate"><span class="pre">data.apply(fahr_to_celsius)</span></code> would not give an error, but the results also don’t make much sense.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Should I use .iterrows() or .apply()?</strong></p>
<p>We are teaching the <code class="docutils literal notranslate"><span class="pre">.iterrows()</span></code> method because it helps to understand the structure of a DataFrame and the process of looping trough DataFrame rows. However, using <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> is often more efficient in terms of execution time.</p>
<p>At this point, the most important thing is that you understand what happens when you are modifying the values in a pandas DataFrame. When doing the course exercises, either of these approaches is ok!</p>
</div>
</div>
</div>
<div class="section" id="Parsing-dates">
<h2>Parsing dates<a class="headerlink" href="#Parsing-dates" title="Permalink to this headline">¶</a></h2>
<p>We will eventually want to group our data based on month in order to see if April temperatures in 2019 were higher than average. Currently, the date and time information is stored in the column <code class="docutils literal notranslate"><span class="pre">TIME</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">YR--MODAHRMN</span> <span class="pre">=</span> <span class="pre">YEAR-MONTH-DAY-HOUR-MINUTE</span> <span class="pre">IN</span> <span class="pre">GREENWICH</span> <span class="pre">MEAN</span> <span class="pre">TIME</span> <span class="pre">(GMT)</span></code></p>
<p>Let’s have a closer look at the date and time information we have by checking the values in that column, and their data type:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    190601010600
1    190601011300
2    190601012000
3    190601020600
4    190601021300
5    190601022000
6    190601030600
7    190601031300
8    190601032000
9    190601040600
Name: TIME, dtype: int64
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>757973    201910012050
757974    201910012100
757975    201910012120
757976    201910012150
757977    201910012200
757978    201910012220
757979    201910012250
757980    201910012300
757981    201910012320
757982    201910012350
Name: TIME, dtype: int64
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">TIME</span></code> column contains several observations per day (and even several observations per hour). The timestamp for the first observation is <code class="docutils literal notranslate"><span class="pre">190601010600</span></code>, i.e. from 1st of January 1906 (way back!), and the timestamp for the latest observation is <code class="docutils literal notranslate"><span class="pre">201910012350</span></code> (from last week, by the time of writing this!)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>dtype(&#39;int64&#39;)
</pre></div>
</div>
</div>
<p>And the information is stored as integer values.</p>
<p>There are several different options for proceeding from here. The bottom line is, that we would want to <strong>aggregate the data on a monthly level</strong>, and in order to do so we need to “label” each row of data based on the month when the record was observed. In practice, we could create a new column (or an index), which contains information about the month (including the year, but excluding days, hours and minutes).</p>
<div class="section" id="String-slicing">
<h3>String slicing<a class="headerlink" href="#String-slicing" title="Permalink to this headline">¶</a></h3>
<p>One approach would be to convert the date and time information into character strings and “cut” the needed information from the <a class="reference external" href="https://docs.python.org/3/tutorial/introduction.html#strings">string objects</a>. If we look at the latest time stamp in the data (<code class="docutils literal notranslate"><span class="pre">201910012350</span></code>), you can see that there is a systematic pattern <code class="docutils literal notranslate"><span class="pre">YEAR-MONTH-DAY-HOUR-MINUTE</span></code>. Four first characters represent the year, and six first characters are year + month!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">date</span> <span class="o">=</span> <span class="s2">&quot;201910012350&quot;</span>
<span class="n">date</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;201910&#39;
</pre></div>
</div>
</div>
<p>Doing this in pandas requires two steps: 1. Convert the <code class="docutils literal notranslate"><span class="pre">TIME</span></code> column from <code class="docutils literal notranslate"><span class="pre">int</span></code> into <code class="docutils literal notranslate"><span class="pre">str</span></code> datatype. 2. Slice the correct range of characters from the character string using <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.slice.html">pandas.Series.str.slice()</a></p>
<ul class="simple">
<li>Let’s convert the time into string. And check that the data type changes:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Convert to string</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># SLice the string</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;YEAR_MONTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   STATION_NUMBER          TIME    DIR  SPEED  GUST  TEMP_F  MAX  MIN  \
0           29440  190601010600   90.0    7.0   NaN    27.0  NaN  NaN
1           29440  190601011300    NaN    0.0   NaN    27.0  NaN  NaN
2           29440  190601012000    NaN    0.0   NaN    25.0  NaN  NaN
3           29440  190601020600    NaN    0.0   NaN    26.0  NaN  NaN
4           29440  190601021300  270.0    7.0   NaN    27.0  NaN  NaN

     TEMP_C      TIME_STR YEAR_MONTH
0 -2.777778  190601010600     190601
1 -2.777778  190601011300     190601
2 -3.888889  190601012000     190601
3 -3.333333  190601020600     190601
4 -2.777778  190601021300     190601
</pre></div></div>
</div>
<p>Nice! Now we have “labeled” the rows based on information about day of the year and hour of the day. However, let’s have a look at a more clever way of dealing with dates and times..</p>
</div>
<div class="section" id="datetime">
<h3>datetime<a class="headerlink" href="#datetime" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Pandas datetime</strong></p>
<p>In pandas, we can convert dates and times into a new data type <a class="reference external" href="https://docs.python.org/3.7/library/datetime.html">datetime</a> using <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html">pandas.to_datetime</a> function. First, it is important to understand the structure of the input data in order to avoid erroneous conversions, and that’s why we first learned string slicing before introducing the datetime functionalities.</p>
<p>Here is one example of how to convert the <code class="docutils literal notranslate"><span class="pre">TIME_STR</span></code>-column in our data set to datetime:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME_STR&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>If needed, you can use the <code class="docutils literal notranslate"><span class="pre">format</span></code> parameter to define the output datetime format according to <a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior">strftime(format) method</a>. together with <code class="docutils literal notranslate"><span class="pre">exact=False</span></code>, for example like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;YEAR_MONTH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME_STR&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y%m&#39;</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">exact=False</span></code> drops out days, hours and minutes, because they are not included in the specified formatting.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Convert to datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME_STR&quot;</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0   1906-01-01 06:00:00
1   1906-01-01 13:00:00
2   1906-01-01 20:00:00
3   1906-01-02 06:00:00
4   1906-01-02 13:00:00
Name: DATE, dtype: datetime64[ns]
</pre></div>
</div>
</div>
<p>Note: in this case, the data type of the values is <code class="docutils literal notranslate"><span class="pre">datetime</span></code>.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Pandas Series datetime properties</strong></p>
<p>There are several methods available for accessing information about the properties of datetime values. Read more from the pandas documentation about <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/series.html#datetime-properties">datetime properties</a>.</p>
</div>
<p>Now, we can extract different time units based on the datetime-column using the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.dt.html">pandas.Series.dt accessor</a>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0         1906
1         1906
2         1906
3         1906
4         1906
5         1906
6         1906
7         1906
8         1906
9         1906
10        1906
11        1906
12        1906
13        1906
14        1906
15        1906
16        1906
17        1906
18        1906
19        1906
20        1906
21        1906
22        1906
23        1906
24        1906
25        1906
26        1906
27        1906
28        1906
29        1906
          ...
757953    2019
757954    2019
757955    2019
757956    2019
757957    2019
757958    2019
757959    2019
757960    2019
757961    2019
757962    2019
757963    2019
757964    2019
757965    2019
757966    2019
757967    2019
757968    2019
757969    2019
757970    2019
757971    2019
757972    2019
757973    2019
757974    2019
757975    2019
757976    2019
757977    2019
757978    2019
757979    2019
757980    2019
757981    2019
757982    2019
Name: DATE, Length: 757983, dtype: int64
</pre></div>
</div>
</div>
<p>We can also combine the datetime functionalities with other methods from pandas. For example, we can check the number of unique years in our input data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>51
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>TASK:</strong></p>
<ul class="simple">
<li>Create two new columns: <code class="docutils literal notranslate"><span class="pre">YEAR</span></code> and <code class="docutils literal notranslate"><span class="pre">MONTH</span></code> based on the date column</li>
</ul>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
      <th>TIME_STR</th>
      <th>YEAR_MONTH</th>
      <th>DATE</th>
      <th>YEAR</th>
      <th>MONTH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29440</td>
      <td>190601010600</td>
      <td>90.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
      <td>190601010600</td>
      <td>190601</td>
      <td>1906-01-01 06:00:00</td>
      <td>1906</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29440</td>
      <td>190601011300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
      <td>190601011300</td>
      <td>190601</td>
      <td>1906-01-01 13:00:00</td>
      <td>1906</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440</td>
      <td>190601012000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.888889</td>
      <td>190601012000</td>
      <td>190601</td>
      <td>1906-01-01 20:00:00</td>
      <td>1906</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440</td>
      <td>190601020600</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.333333</td>
      <td>190601020600</td>
      <td>190601</td>
      <td>1906-01-02 06:00:00</td>
      <td>1906</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440</td>
      <td>190601021300</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
      <td>190601021300</td>
      <td>190601</td>
      <td>1906-01-02 13:00:00</td>
      <td>1906</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>
<div class="section" id="Aggregating-data-in-Pandas-by-grouping">
<h2>Aggregating data in Pandas by grouping<a class="headerlink" href="#Aggregating-data-in-Pandas-by-grouping" title="Permalink to this headline">¶</a></h2>
<p>Here, we will learn how to use <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">pandas.DataFrame.groupby</a> which is a handy method for compressing large amounts of data and computing statistics for subgroups.</p>
<p>Our practical task is to calculate the average temperatures for each month</p>
<p>This can be done by aggregating the data, i.e.:</p>
<ol class="arabic simple">
<li><strong>grouping the data</strong> based on year and month</li>
<li>Calculating the average for each month (each group) either by using a for-loop or directly from the grouped object</li>
<li>Storing those values into <strong>a new DataFrame</strong> <code class="docutils literal notranslate"><span class="pre">monthly_data</span></code></li>
</ol>
<p>Before we start grouping the data, let’s once more check how our input data looks like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;number of rows:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
number of rows: 757983
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
      <th>TIME_STR</th>
      <th>YEAR_MONTH</th>
      <th>DATE</th>
      <th>YEAR</th>
      <th>MONTH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29440</td>
      <td>190601010600</td>
      <td>90.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
      <td>190601010600</td>
      <td>190601</td>
      <td>1906-01-01 06:00:00</td>
      <td>1906</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29440</td>
      <td>190601011300</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
      <td>190601011300</td>
      <td>190601</td>
      <td>1906-01-01 13:00:00</td>
      <td>1906</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440</td>
      <td>190601012000</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.888889</td>
      <td>190601012000</td>
      <td>190601</td>
      <td>1906-01-01 20:00:00</td>
      <td>1906</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440</td>
      <td>190601020600</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.333333</td>
      <td>190601020600</td>
      <td>190601</td>
      <td>1906-01-02 06:00:00</td>
      <td>1906</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440</td>
      <td>190601021300</td>
      <td>270.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.777778</td>
      <td>190601021300</td>
      <td>190601</td>
      <td>1906-01-02 13:00:00</td>
      <td>1906</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We have quite a few rows of weather data, and several observations per day. <strong>Our goal is to create an aggreated data frame that would have only one row per month!</strong></p>
<p>Let’s <strong>group</strong> our data based on unique year and month combinations</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;YEAR&quot;</span><span class="p">,</span> <span class="s2">&quot;MONTH&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>NOTE:</strong></p>
<p>Here you could also group the data based on the <code class="docutils literal notranslate"><span class="pre">YEAR_MONTH</span></code> column to achieve the same result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Group the data</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;YEAR_MONTH&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>Let’s see what we have now.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># What is the type?</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Type:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">grouped</span><span class="p">))</span>

<span class="c1"># How many?</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Length:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Type:
 &lt;class &#39;pandas.core.groupby.groupby.DataFrameGroupBy&#39;&gt;
Length:
 601
</pre></div></div>
</div>
<p>Okey, interesting. Now we have a new object with type <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code>.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>TASK:</strong></p>
<p>Think: what does the number of groups (length of the grouped object) tell us?</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Answer: the length of the grouped object should be the same as</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;YEAR_MONTH&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="c1"># in other words, the number of groups is the number of unique year and month combinations in our data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>601
</pre></div>
</div>
</div>
<p>There are several methods we can use for extracting information from the grouped data. See <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/groupby.html">documentation for Pandas GroupBy objects</a> for a comprehensive overview.</p>
<p><strong>Checking group names:</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Check the &quot;names&quot; of each group (uncomment the next row if you want to print out all the keys)</span>
<span class="c1">#grouped.groups.keys()</span>
</pre></div>
</div>
</div>
<p><strong>Accessing data for one group:</strong></p>
<ul class="simple">
<li>Let’s check the contents for a group representing August 2019 (name of that group is <code class="docutils literal notranslate"><span class="pre">(2019,</span> <span class="pre">4)</span></code> if you grouped the data based on datetime columns <code class="docutils literal notranslate"><span class="pre">YEAR</span></code> and <code class="docutils literal notranslate"><span class="pre">MONTH</span></code>). We can get the values of that hour from the grouped object using the <code class="docutils literal notranslate"><span class="pre">get_group()</span></code> -method:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specify the time of the first hour (as text)</span>
<span class="n">month</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># Select the group</span>
<span class="n">group1</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">month</span><span class="p">)</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">group1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
        STATION_NUMBER          TIME    DIR  SPEED  GUST  TEMP_F   MAX   MIN  \
745098           29440  201904010000  280.0    6.0   NaN    30.0   NaN   NaN
745099           29440  201904010020  280.0    7.0   NaN    32.0   NaN   NaN
745100           29440  201904010050  280.0    6.0   NaN    30.0   NaN   NaN
745101           29440  201904010100  280.0    7.0   NaN    30.0   NaN   NaN
745102           29440  201904010120  280.0    6.0   NaN    30.0   NaN   NaN
745103           29440  201904010150  300.0    5.0   NaN    30.0   NaN   NaN
745104           29440  201904010200  290.0    6.0   NaN    30.0   NaN   NaN
745105           29440  201904010220  290.0    6.0   NaN    30.0   NaN   NaN
745106           29440  201904010250  290.0    6.0   NaN    28.0   NaN   NaN
745107           29440  201904010300  290.0    5.0   NaN    29.0   NaN   NaN
745108           29440  201904010320  280.0    6.0   NaN    30.0   NaN   NaN
745109           29440  201904010350  280.0    6.0   NaN    28.0   NaN   NaN
745110           29440  201904010400  280.0    5.0   NaN    29.0   NaN   NaN
745111           29440  201904010420  290.0    6.0   NaN    28.0   NaN   NaN
745112           29440  201904010450  270.0    7.0   NaN    30.0   NaN   NaN
745113           29440  201904010500  270.0    6.0   NaN    30.0   NaN   NaN
745114           29440  201904010520  280.0    8.0   NaN    30.0   NaN   NaN
745115           29440  201904010550  280.0    7.0   NaN    30.0   NaN   NaN
745116           29440  201904010600  290.0    6.0   NaN    31.0  35.0  29.0
745117           29440  201904010620  280.0    8.0   NaN    32.0   NaN   NaN
745118           29440  201904010650  290.0   10.0   NaN    32.0   NaN   NaN
745119           29440  201904010700  300.0    7.0  11.0    33.0   NaN   NaN
745120           29440  201904010720  990.0   10.0   NaN    34.0   NaN   NaN
745121           29440  201904010750  290.0    9.0   NaN    34.0   NaN   NaN
745122           29440  201904010800  290.0    7.0  11.0    35.0   NaN   NaN
745123           29440  201904010820  290.0    9.0   NaN    36.0   NaN   NaN
745124           29440  201904010850  250.0   13.0   NaN    37.0   NaN   NaN
745125           29440  201904010900  260.0    9.0  15.0    37.0   NaN   NaN
745126           29440  201904010920  250.0   14.0   NaN    37.0   NaN   NaN
745127           29440  201904010950  240.0   15.0   NaN    39.0   NaN   NaN
...                ...           ...    ...    ...   ...     ...   ...   ...
747231           29440  201904301400  260.0    6.0   NaN    57.0   NaN   NaN
747232           29440  201904301420  990.0    6.0   NaN    57.0   NaN   NaN
747233           29440  201904301450  990.0    7.0   NaN    59.0   NaN   NaN
747234           29440  201904301500  250.0    8.0  11.0    58.0   NaN   NaN
747235           29440  201904301520  240.0    9.0   NaN    59.0   NaN   NaN
747236           29440  201904301550  990.0    5.0   NaN    57.0   NaN   NaN
747237           29440  201904301600  360.0    0.0   NaN    58.0   NaN   NaN
747238           29440  201904301620  990.0    3.0   NaN    57.0   NaN   NaN
747239           29440  201904301650  190.0    3.0   NaN    57.0   NaN   NaN
747240           29440  201904301700  180.0    2.0   NaN    57.0   NaN   NaN
747241           29440  201904301720  190.0    2.0   NaN    55.0   NaN   NaN
747242           29440  201904301750  190.0    2.0   NaN    54.0   NaN   NaN
747243           29440  201904301800  360.0    0.0   NaN    51.0  58.0  42.0
747244           29440  201904301820  300.0    6.0   NaN    52.0   NaN   NaN
747245           29440  201904301850  280.0    3.0   NaN    50.0   NaN   NaN
747246           29440  201904301900  270.0    5.0   NaN    47.0   NaN   NaN
747247           29440  201904301920  230.0    2.0   NaN    46.0   NaN   NaN
747248           29440  201904301950  990.0    1.0   NaN    41.0   NaN   NaN
747249           29440  201904302000  360.0    0.0   NaN    42.0   NaN   NaN
747250           29440  201904302020  990.0    1.0   NaN    41.0   NaN   NaN
747251           29440  201904302050    NaN    0.0   NaN    39.0   NaN   NaN
747252           29440  201904302100  360.0    0.0   NaN    39.0   NaN   NaN
747253           29440  201904302120  990.0    1.0   NaN    37.0   NaN   NaN
747254           29440  201904302150    NaN    0.0   NaN    37.0   NaN   NaN
747255           29440  201904302200  360.0    0.0   NaN    36.0   NaN   NaN
747256           29440  201904302220  990.0    1.0   NaN    36.0   NaN   NaN
747257           29440  201904302250  990.0    1.0   NaN    36.0   NaN   NaN
747258           29440  201904302300  360.0    0.0   NaN    36.0   NaN   NaN
747259           29440  201904302320  990.0    1.0   NaN    34.0   NaN   NaN
747260           29440  201904302350  190.0    3.0   NaN    36.0   NaN   NaN

           TEMP_C      TIME_STR YEAR_MONTH                DATE  YEAR  MONTH
745098  -1.111111  201904010000     201904 2019-04-01 00:00:00  2019      4
745099   0.000000  201904010020     201904 2019-04-01 00:20:00  2019      4
745100  -1.111111  201904010050     201904 2019-04-01 00:50:00  2019      4
745101  -1.111111  201904010100     201904 2019-04-01 01:00:00  2019      4
745102  -1.111111  201904010120     201904 2019-04-01 01:20:00  2019      4
745103  -1.111111  201904010150     201904 2019-04-01 01:50:00  2019      4
745104  -1.111111  201904010200     201904 2019-04-01 02:00:00  2019      4
745105  -1.111111  201904010220     201904 2019-04-01 02:20:00  2019      4
745106  -2.222222  201904010250     201904 2019-04-01 02:50:00  2019      4
745107  -1.666667  201904010300     201904 2019-04-01 03:00:00  2019      4
745108  -1.111111  201904010320     201904 2019-04-01 03:20:00  2019      4
745109  -2.222222  201904010350     201904 2019-04-01 03:50:00  2019      4
745110  -1.666667  201904010400     201904 2019-04-01 04:00:00  2019      4
745111  -2.222222  201904010420     201904 2019-04-01 04:20:00  2019      4
745112  -1.111111  201904010450     201904 2019-04-01 04:50:00  2019      4
745113  -1.111111  201904010500     201904 2019-04-01 05:00:00  2019      4
745114  -1.111111  201904010520     201904 2019-04-01 05:20:00  2019      4
745115  -1.111111  201904010550     201904 2019-04-01 05:50:00  2019      4
745116  -0.555556  201904010600     201904 2019-04-01 06:00:00  2019      4
745117   0.000000  201904010620     201904 2019-04-01 06:20:00  2019      4
745118   0.000000  201904010650     201904 2019-04-01 06:50:00  2019      4
745119   0.555556  201904010700     201904 2019-04-01 07:00:00  2019      4
745120   1.111111  201904010720     201904 2019-04-01 07:20:00  2019      4
745121   1.111111  201904010750     201904 2019-04-01 07:50:00  2019      4
745122   1.666667  201904010800     201904 2019-04-01 08:00:00  2019      4
745123   2.222222  201904010820     201904 2019-04-01 08:20:00  2019      4
745124   2.777778  201904010850     201904 2019-04-01 08:50:00  2019      4
745125   2.777778  201904010900     201904 2019-04-01 09:00:00  2019      4
745126   2.777778  201904010920     201904 2019-04-01 09:20:00  2019      4
745127   3.888889  201904010950     201904 2019-04-01 09:50:00  2019      4
...           ...           ...        ...                 ...   ...    ...
747231  13.888889  201904301400     201904 2019-04-30 14:00:00  2019      4
747232  13.888889  201904301420     201904 2019-04-30 14:20:00  2019      4
747233  15.000000  201904301450     201904 2019-04-30 14:50:00  2019      4
747234  14.444444  201904301500     201904 2019-04-30 15:00:00  2019      4
747235  15.000000  201904301520     201904 2019-04-30 15:20:00  2019      4
747236  13.888889  201904301550     201904 2019-04-30 15:50:00  2019      4
747237  14.444444  201904301600     201904 2019-04-30 16:00:00  2019      4
747238  13.888889  201904301620     201904 2019-04-30 16:20:00  2019      4
747239  13.888889  201904301650     201904 2019-04-30 16:50:00  2019      4
747240  13.888889  201904301700     201904 2019-04-30 17:00:00  2019      4
747241  12.777778  201904301720     201904 2019-04-30 17:20:00  2019      4
747242  12.222222  201904301750     201904 2019-04-30 17:50:00  2019      4
747243  10.555556  201904301800     201904 2019-04-30 18:00:00  2019      4
747244  11.111111  201904301820     201904 2019-04-30 18:20:00  2019      4
747245  10.000000  201904301850     201904 2019-04-30 18:50:00  2019      4
747246   8.333333  201904301900     201904 2019-04-30 19:00:00  2019      4
747247   7.777778  201904301920     201904 2019-04-30 19:20:00  2019      4
747248   5.000000  201904301950     201904 2019-04-30 19:50:00  2019      4
747249   5.555556  201904302000     201904 2019-04-30 20:00:00  2019      4
747250   5.000000  201904302020     201904 2019-04-30 20:20:00  2019      4
747251   3.888889  201904302050     201904 2019-04-30 20:50:00  2019      4
747252   3.888889  201904302100     201904 2019-04-30 21:00:00  2019      4
747253   2.777778  201904302120     201904 2019-04-30 21:20:00  2019      4
747254   2.777778  201904302150     201904 2019-04-30 21:50:00  2019      4
747255   2.222222  201904302200     201904 2019-04-30 22:00:00  2019      4
747256   2.222222  201904302220     201904 2019-04-30 22:20:00  2019      4
747257   2.222222  201904302250     201904 2019-04-30 22:50:00  2019      4
747258   2.222222  201904302300     201904 2019-04-30 23:00:00  2019      4
747259   1.111111  201904302320     201904 2019-04-30 23:20:00  2019      4
747260   2.222222  201904302350     201904 2019-04-30 23:50:00  2019      4

[2163 rows x 14 columns]
</pre></div></div>
</div>
<p>Ahaa! As we can see, a single group contains a <strong>DataFrame</strong> with values only for that specific month. Let’s check the DataType of this group:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">type</span><span class="p">(</span><span class="n">group1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
<p>So, one group is a pandas DataFrame! This is really useful, because we can now use all the familiar DataFrame methods for calculating statistics etc for this spesific group. We can, for example, calculate the average values for all variables using the statistical functions that we have seen already (e.g. mean, std, min, max, median, etc.).</p>
<p>We can do that by using the <code class="docutils literal notranslate"><span class="pre">mean()</span></code> -function that we already used during the Lesson 5.</p>
<ul class="simple">
<li>Let’s calculate the mean for following attributes all at once:</li>
<li><code class="docutils literal notranslate"><span class="pre">DIR</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">SPEED</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">GUST</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">TEMP</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">TEMP_C</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">MONTH</span></code></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specify the columns that will be part of the calculation</span>
<span class="n">mean_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_F&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">,</span> <span class="s1">&#39;MONTH&#39;</span><span class="p">]</span>

<span class="c1"># Calculate the mean values all at one go</span>
<span class="n">mean_values</span> <span class="o">=</span> <span class="n">group1</span><span class="p">[</span><span class="n">mean_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">mean_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DIR       309.035306
SPEED       5.932188
GUST       15.868217
TEMP_F     42.472030
TEMP_C      5.817794
MONTH       4.000000
dtype: float64
</pre></div></div>
</div>
<p>Here we saw how you can access data from a single group. For getting information about all groups (all months) we can a <code class="docutils literal notranslate"><span class="pre">for</span></code> -loop or methods available in the grouped object.</p>
<p><strong>For-loops and grouped objects:</strong></p>
<p>When iterating over the groups in our <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> -object it is important to understand that a single group in our <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> actually contains not only the actual values, but also information about the <code class="docutils literal notranslate"><span class="pre">key</span></code> that was used to do the grouping. Hence, when iterating over the data we need to assign the <code class="docutils literal notranslate"><span class="pre">key</span></code> and the values into separate variables.</p>
<ul class="simple">
<li>Let’s see how we can iterate over the groups and print the key and the data from a single group (again using <code class="docutils literal notranslate"><span class="pre">break</span></code> to only see what is happening).</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Iterate over groups</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="c1"># Print key and group</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Key:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">First rows of data in this group:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

    <span class="c1"># Stop iteration with break command</span>
    <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Key:
 (1906, 1)

First rows of data in this group:
    STATION_NUMBER          TIME    DIR  SPEED  GUST  TEMP_F  MAX  MIN  \
0           29440  190601010600   90.0    7.0   NaN    27.0  NaN  NaN
1           29440  190601011300    NaN    0.0   NaN    27.0  NaN  NaN
2           29440  190601012000    NaN    0.0   NaN    25.0  NaN  NaN
3           29440  190601020600    NaN    0.0   NaN    26.0  NaN  NaN
4           29440  190601021300  270.0    7.0   NaN    27.0  NaN  NaN

     TEMP_C      TIME_STR YEAR_MONTH                DATE  YEAR  MONTH
0 -2.777778  190601010600     190601 1906-01-01 06:00:00  1906      1
1 -2.777778  190601011300     190601 1906-01-01 13:00:00  1906      1
2 -3.888889  190601012000     190601 1906-01-01 20:00:00  1906      1
3 -3.333333  190601020600     190601 1906-01-02 06:00:00  1906      1
4 -2.777778  190601021300     190601 1906-01-02 13:00:00  1906      1
</pre></div></div>
</div>
<p>Okey so from here we can see that the <code class="docutils literal notranslate"><span class="pre">key</span></code> contains the name of the group (year, month).</p>
<ul class="simple">
<li>Let’s see how we can create a DataFrame where we calculate the mean values for all those weather attributes that we were interested in. I will repeat slightly the earlier steps so that you can see and better understand what is happening.</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty DataFrame for the aggregated values</span>
<span class="n">monthly_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># The columns that we want to aggregate</span>
<span class="n">mean_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_F&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">,</span> <span class="s2">&quot;MONTH&quot;</span><span class="p">]</span>

<span class="c1"># Iterate over the groups</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>

   <span class="c1"># Calculate mean</span>
   <span class="n">mean_values</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="n">mean_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

   <span class="c1"># Add the ´key´ (i.e. the date+time information) into the aggregated values</span>
   <span class="n">mean_values</span><span class="p">[</span><span class="s1">&#39;YEAR_MONTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

   <span class="c1"># Append the aggregated values into the DataFrame</span>
   <span class="n">monthly_data</span> <span class="o">=</span> <span class="n">monthly_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_values</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>Let’s see what we have now:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">monthly_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
            DIR       GUST  MONTH      SPEED     TEMP_C     TEMP_F  YEAR_MONTH
0    218.181818        NaN    1.0  13.204301  -3.596177  25.526882   (1906, 1)
1    178.095238        NaN    2.0  13.142857  -3.445767  25.797619   (1906, 2)
2    232.043011        NaN    3.0  15.021505  -5.107527  22.806452   (1906, 3)
3    232.045455        NaN    4.0  13.811111   3.790123  38.822222   (1906, 4)
4    192.820513        NaN    5.0  10.333333  13.070490  55.526882   (1906, 5)
5    234.222222        NaN    6.0  12.922222  16.246914  61.244444   (1906, 6)
6    226.923077        NaN    7.0  10.827957  18.805257  65.849462   (1906, 7)
7    251.627907        NaN    8.0  11.623656  13.590203  56.462366   (1906, 8)
8    236.986301        NaN    9.0   9.988889   8.611111  47.500000   (1906, 9)
9    199.397590        NaN   10.0  12.365591   4.360812  39.849462  (1906, 10)
10   199.166667        NaN   11.0  14.211111   0.296296  32.533333  (1906, 11)
11   198.636364        NaN   12.0  15.516129  -4.086022  24.645161  (1906, 12)
12   190.930233        NaN    1.0  16.344086  -9.904421  14.172043   (1907, 1)
13   223.466667        NaN    2.0  15.108434  -5.535475  22.036145   (1907, 2)
14   238.051948        NaN    3.0  10.763441  -1.344086  29.580645   (1907, 3)
15   201.038961        NaN    4.0  10.433333   2.283951  36.111111   (1907, 4)
16   244.823529        NaN    5.0  12.913978   7.048984  44.688172   (1907, 5)
17   202.674419        NaN    6.0  11.633333  14.308642  57.755556   (1907, 6)
18   215.238095        NaN    7.0  10.473118  16.923536  62.462366   (1907, 7)
19   221.139241        NaN    8.0   9.645161  12.640382  54.752688   (1907, 8)
20   258.953488        NaN    9.0  16.466667   9.185185  48.533333   (1907, 9)
21   192.682927        NaN   10.0  10.408602   8.482676  47.268817  (1907, 10)
22   204.222222        NaN   11.0  15.744444   0.641975  33.155556  (1907, 11)
23   166.052632        NaN   12.0  11.000000 -11.992754  10.413043  (1907, 12)
24   221.547619        NaN    1.0  11.376344  -6.284349  20.688172   (1908, 1)
25   190.864198        NaN    2.0  10.546512  -5.245478  22.558140   (1908, 2)
26   169.315068        NaN    3.0   6.537634  -4.342891  24.182796   (1908, 3)
27   195.333333        NaN    4.0   6.222222   2.672840  36.811111   (1908, 4)
28   259.718310        NaN    5.0   6.709677   8.052569  46.494624   (1908, 5)
29   249.651163        NaN    6.0  20.011111  14.283951  57.711111   (1908, 6)
..          ...        ...    ...        ...        ...        ...         ...
571  340.875980  15.628492    5.0   6.872531   8.409816  47.137668   (2017, 5)
572  379.561190  17.014451    6.0   6.904539  12.733344  54.920019   (2017, 6)
573  359.269933  15.245136    7.0   6.318477  14.878319  58.780974   (2017, 7)
574  331.270588  15.627178    8.0   6.489526  14.526758  58.148165   (2017, 8)
575  304.676641  14.788660    9.0   5.399907  10.070834  50.127501   (2017, 9)
576  277.448502  16.598854   10.0   6.535569   3.963063  39.133514  (2017, 10)
577  215.835272  16.026846   11.0   7.165504   1.957475  35.523456  (2017, 11)
578  237.338195  15.927536   12.0   7.908435  -0.497221  31.105002  (2017, 12)
579  269.553613  17.351792    1.0   6.898274  -3.848810  25.072142   (2018, 1)
580  224.710831  14.937500    2.0   5.870871  -9.752473  14.445549   (2018, 2)
581  292.265435  15.392857    3.0   6.066968  -6.356461  20.558371   (2018, 3)
582  350.141509  15.216981    4.0   5.704087   3.862159  38.951887   (2018, 4)
583  422.810552  14.819095    5.0   5.387764  14.625079  58.325143   (2018, 5)
584  445.827233  18.480337    6.0   7.056325  14.357283  57.843109   (2018, 6)
585  408.614487  15.902778    7.0   5.607442  20.695197  69.251354   (2018, 7)
586  396.655422  16.764179    8.0   6.515248  16.888990  62.400182   (2018, 8)
587  290.531856  20.581481    9.0   7.879109  12.253005  54.055409   (2018, 9)
588  256.174656  17.902685   10.0   7.452370   5.609417  42.096950  (2018, 10)
589  303.893491  16.097473   11.0   6.950848   2.547624  36.585723  (2018, 11)
590  281.960321  14.872807   12.0   6.531746  -2.959591  26.672736  (2018, 12)
591  279.460600  17.300813    1.0   5.835289  -7.841929  17.884529   (2019, 1)
592  252.858576  17.908511    2.0   9.232639  -1.682650  28.971230   (2019, 2)
593  281.606481  17.462687    3.0   7.907805  -1.397007  29.485388   (2019, 3)
594  309.035306  15.868217    4.0   5.932188   5.817794  42.472030   (2019, 4)
595  367.198506  17.553719    5.0   7.738381   8.869752  47.965553   (2019, 5)
596  370.992008  17.251852    6.0   8.138490  16.524111  61.743400   (2019, 6)
597  294.433641  15.034722    7.0   5.785714  16.427753  61.569955   (2019, 7)
598  320.335766  15.751678    8.0   6.769447  15.888138  60.598649   (2019, 8)
599  306.491058  15.173285    9.0   6.363594   9.976743  49.958137   (2019, 9)
600  239.577465  17.470588   10.0  10.169014   5.985915  42.774648  (2019, 10)

[601 rows x 7 columns]
</pre></div></div>
</div>
<p>Awesome! Now we have aggregated our data and we have a new DataFrame called <code class="docutils literal notranslate"><span class="pre">monthly_data</span></code> where we have mean values for each month in the data set.</p>
<p><strong>Mean for all groups at once</strong></p>
<p>We can also achieve the same result by computing the mean of all columns for all groups in the grouped object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP_F</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
    <tr>
      <th>YEAR</th>
      <th>MONTH</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="12" valign="top">1906</th>
      <th>1</th>
      <td>29440.0</td>
      <td>1.906012e+11</td>
      <td>218.181818</td>
      <td>13.204301</td>
      <td>NaN</td>
      <td>25.526882</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.596177</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440.0</td>
      <td>1.906021e+11</td>
      <td>178.095238</td>
      <td>13.142857</td>
      <td>NaN</td>
      <td>25.797619</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.445767</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440.0</td>
      <td>1.906032e+11</td>
      <td>232.043011</td>
      <td>15.021505</td>
      <td>NaN</td>
      <td>22.806452</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-5.107527</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440.0</td>
      <td>1.906042e+11</td>
      <td>232.045455</td>
      <td>13.811111</td>
      <td>NaN</td>
      <td>38.822222</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.790123</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29440.0</td>
      <td>1.906052e+11</td>
      <td>192.820513</td>
      <td>10.333333</td>
      <td>NaN</td>
      <td>55.526882</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13.070490</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29440.0</td>
      <td>1.906062e+11</td>
      <td>234.222222</td>
      <td>12.922222</td>
      <td>NaN</td>
      <td>61.244444</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.246914</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29440.0</td>
      <td>1.906072e+11</td>
      <td>226.923077</td>
      <td>10.827957</td>
      <td>NaN</td>
      <td>65.849462</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.805257</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29440.0</td>
      <td>1.906082e+11</td>
      <td>251.627907</td>
      <td>11.623656</td>
      <td>NaN</td>
      <td>56.462366</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13.590203</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29440.0</td>
      <td>1.906092e+11</td>
      <td>236.986301</td>
      <td>9.988889</td>
      <td>NaN</td>
      <td>47.500000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.611111</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29440.0</td>
      <td>1.906102e+11</td>
      <td>199.397590</td>
      <td>12.365591</td>
      <td>NaN</td>
      <td>39.849462</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.360812</td>
    </tr>
    <tr>
      <th>11</th>
      <td>29440.0</td>
      <td>1.906112e+11</td>
      <td>199.166667</td>
      <td>14.211111</td>
      <td>NaN</td>
      <td>32.533333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.296296</td>
    </tr>
    <tr>
      <th>12</th>
      <td>29440.0</td>
      <td>1.906122e+11</td>
      <td>198.636364</td>
      <td>15.516129</td>
      <td>NaN</td>
      <td>24.645161</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-4.086022</td>
    </tr>
    <tr>
      <th rowspan="12" valign="top">1907</th>
      <th>1</th>
      <td>29440.0</td>
      <td>1.907012e+11</td>
      <td>190.930233</td>
      <td>16.344086</td>
      <td>NaN</td>
      <td>14.172043</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-9.904421</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440.0</td>
      <td>1.907021e+11</td>
      <td>223.466667</td>
      <td>15.108434</td>
      <td>NaN</td>
      <td>22.036145</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-5.535475</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440.0</td>
      <td>1.907032e+11</td>
      <td>238.051948</td>
      <td>10.763441</td>
      <td>NaN</td>
      <td>29.580645</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.344086</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440.0</td>
      <td>1.907042e+11</td>
      <td>201.038961</td>
      <td>10.433333</td>
      <td>NaN</td>
      <td>36.111111</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.283951</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29440.0</td>
      <td>1.907052e+11</td>
      <td>244.823529</td>
      <td>12.913978</td>
      <td>NaN</td>
      <td>44.688172</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.048984</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29440.0</td>
      <td>1.907062e+11</td>
      <td>202.674419</td>
      <td>11.633333</td>
      <td>NaN</td>
      <td>57.755556</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.308642</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29440.0</td>
      <td>1.907072e+11</td>
      <td>215.238095</td>
      <td>10.473118</td>
      <td>NaN</td>
      <td>62.462366</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.923536</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29440.0</td>
      <td>1.907082e+11</td>
      <td>221.139241</td>
      <td>9.645161</td>
      <td>NaN</td>
      <td>54.752688</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.640382</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29440.0</td>
      <td>1.907092e+11</td>
      <td>258.953488</td>
      <td>16.466667</td>
      <td>NaN</td>
      <td>48.533333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.185185</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29440.0</td>
      <td>1.907102e+11</td>
      <td>192.682927</td>
      <td>10.408602</td>
      <td>NaN</td>
      <td>47.268817</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.482676</td>
    </tr>
    <tr>
      <th>11</th>
      <td>29440.0</td>
      <td>1.907112e+11</td>
      <td>204.222222</td>
      <td>15.744444</td>
      <td>NaN</td>
      <td>33.155556</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.641975</td>
    </tr>
    <tr>
      <th>12</th>
      <td>29440.0</td>
      <td>1.907122e+11</td>
      <td>166.052632</td>
      <td>11.000000</td>
      <td>NaN</td>
      <td>10.413043</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-11.992754</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">1908</th>
      <th>1</th>
      <td>29440.0</td>
      <td>1.908012e+11</td>
      <td>221.547619</td>
      <td>11.376344</td>
      <td>NaN</td>
      <td>20.688172</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-6.284349</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440.0</td>
      <td>1.908022e+11</td>
      <td>190.864198</td>
      <td>10.546512</td>
      <td>NaN</td>
      <td>22.558140</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-5.245478</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440.0</td>
      <td>1.908032e+11</td>
      <td>169.315068</td>
      <td>6.537634</td>
      <td>NaN</td>
      <td>24.182796</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-4.342891</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440.0</td>
      <td>1.908042e+11</td>
      <td>195.333333</td>
      <td>6.222222</td>
      <td>NaN</td>
      <td>36.811111</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.672840</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29440.0</td>
      <td>1.908052e+11</td>
      <td>259.718310</td>
      <td>6.709677</td>
      <td>NaN</td>
      <td>46.494624</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.052569</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29440.0</td>
      <td>1.908062e+11</td>
      <td>249.651163</td>
      <td>20.011111</td>
      <td>NaN</td>
      <td>57.711111</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.283951</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">2017</th>
      <th>5</th>
      <td>29440.0</td>
      <td>2.017052e+11</td>
      <td>340.875980</td>
      <td>6.872531</td>
      <td>15.628492</td>
      <td>47.137668</td>
      <td>53.580645</td>
      <td>40.387097</td>
      <td>8.409816</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29440.0</td>
      <td>2.017062e+11</td>
      <td>379.561190</td>
      <td>6.904539</td>
      <td>17.014451</td>
      <td>54.920019</td>
      <td>60.566667</td>
      <td>49.516667</td>
      <td>12.733344</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29440.0</td>
      <td>2.017072e+11</td>
      <td>359.269933</td>
      <td>6.318477</td>
      <td>15.245136</td>
      <td>58.780974</td>
      <td>64.345455</td>
      <td>53.581818</td>
      <td>14.878319</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29440.0</td>
      <td>2.017082e+11</td>
      <td>331.270588</td>
      <td>6.489526</td>
      <td>15.627178</td>
      <td>58.148165</td>
      <td>62.229508</td>
      <td>53.590164</td>
      <td>14.526758</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29440.0</td>
      <td>2.017092e+11</td>
      <td>304.676641</td>
      <td>5.399907</td>
      <td>14.788660</td>
      <td>50.127501</td>
      <td>53.300000</td>
      <td>46.600000</td>
      <td>10.070834</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29440.0</td>
      <td>2.017102e+11</td>
      <td>277.448502</td>
      <td>6.535569</td>
      <td>16.598854</td>
      <td>39.133514</td>
      <td>41.918033</td>
      <td>36.098361</td>
      <td>3.963063</td>
    </tr>
    <tr>
      <th>11</th>
      <td>29440.0</td>
      <td>2.017112e+11</td>
      <td>215.835272</td>
      <td>7.165504</td>
      <td>16.026846</td>
      <td>35.523456</td>
      <td>37.200000</td>
      <td>33.368421</td>
      <td>1.957475</td>
    </tr>
    <tr>
      <th>12</th>
      <td>29440.0</td>
      <td>2.017122e+11</td>
      <td>237.338195</td>
      <td>7.908435</td>
      <td>15.927536</td>
      <td>31.105002</td>
      <td>33.016393</td>
      <td>28.758065</td>
      <td>-0.497221</td>
    </tr>
    <tr>
      <th rowspan="12" valign="top">2018</th>
      <th>1</th>
      <td>29440.0</td>
      <td>2.018012e+11</td>
      <td>269.553613</td>
      <td>6.898274</td>
      <td>17.351792</td>
      <td>25.072142</td>
      <td>26.816667</td>
      <td>21.637931</td>
      <td>-3.848810</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440.0</td>
      <td>2.018021e+11</td>
      <td>224.710831</td>
      <td>5.870871</td>
      <td>14.937500</td>
      <td>14.445549</td>
      <td>18.196429</td>
      <td>10.196429</td>
      <td>-9.752473</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440.0</td>
      <td>2.018032e+11</td>
      <td>292.265435</td>
      <td>6.066968</td>
      <td>15.392857</td>
      <td>20.558371</td>
      <td>25.491525</td>
      <td>12.423729</td>
      <td>-6.356461</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440.0</td>
      <td>2.018042e+11</td>
      <td>350.141509</td>
      <td>5.704087</td>
      <td>15.216981</td>
      <td>38.951887</td>
      <td>44.175439</td>
      <td>32.844828</td>
      <td>3.862159</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29440.0</td>
      <td>2.018052e+11</td>
      <td>422.810552</td>
      <td>5.387764</td>
      <td>14.819095</td>
      <td>58.325143</td>
      <td>63.512195</td>
      <td>48.658537</td>
      <td>14.625079</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29440.0</td>
      <td>2.018062e+11</td>
      <td>445.827233</td>
      <td>7.056325</td>
      <td>18.480337</td>
      <td>57.843109</td>
      <td>63.754717</td>
      <td>51.000000</td>
      <td>14.357283</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29440.0</td>
      <td>2.018072e+11</td>
      <td>408.614487</td>
      <td>5.607442</td>
      <td>15.902778</td>
      <td>69.251354</td>
      <td>75.262295</td>
      <td>63.688525</td>
      <td>20.695197</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29440.0</td>
      <td>2.018082e+11</td>
      <td>396.655422</td>
      <td>6.515248</td>
      <td>16.764179</td>
      <td>62.400182</td>
      <td>67.833333</td>
      <td>57.350000</td>
      <td>16.888990</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29440.0</td>
      <td>2.018092e+11</td>
      <td>290.531856</td>
      <td>7.879109</td>
      <td>20.581481</td>
      <td>54.055409</td>
      <td>57.833333</td>
      <td>49.648148</td>
      <td>12.253005</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29440.0</td>
      <td>2.018102e+11</td>
      <td>256.174656</td>
      <td>7.452370</td>
      <td>17.902685</td>
      <td>42.096950</td>
      <td>45.229508</td>
      <td>37.672131</td>
      <td>5.609417</td>
    </tr>
    <tr>
      <th>11</th>
      <td>29440.0</td>
      <td>2.018111e+11</td>
      <td>303.893491</td>
      <td>6.950848</td>
      <td>16.097473</td>
      <td>36.585723</td>
      <td>38.510638</td>
      <td>34.085106</td>
      <td>2.547624</td>
    </tr>
    <tr>
      <th>12</th>
      <td>29440.0</td>
      <td>2.018122e+11</td>
      <td>281.960321</td>
      <td>6.531746</td>
      <td>14.872807</td>
      <td>26.672736</td>
      <td>27.901961</td>
      <td>23.173077</td>
      <td>-2.959591</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">2019</th>
      <th>1</th>
      <td>29440.0</td>
      <td>2.019012e+11</td>
      <td>279.460600</td>
      <td>5.835289</td>
      <td>17.300813</td>
      <td>17.884529</td>
      <td>21.474576</td>
      <td>12.700000</td>
      <td>-7.841929</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29440.0</td>
      <td>2.019021e+11</td>
      <td>252.858576</td>
      <td>9.232639</td>
      <td>17.908511</td>
      <td>28.971230</td>
      <td>32.672727</td>
      <td>24.545455</td>
      <td>-1.682650</td>
    </tr>
    <tr>
      <th>3</th>
      <td>29440.0</td>
      <td>2.019032e+11</td>
      <td>281.606481</td>
      <td>7.907805</td>
      <td>17.462687</td>
      <td>29.485388</td>
      <td>32.870968</td>
      <td>24.870968</td>
      <td>-1.397007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29440.0</td>
      <td>2.019042e+11</td>
      <td>309.035306</td>
      <td>5.932188</td>
      <td>15.868217</td>
      <td>42.472030</td>
      <td>48.810345</td>
      <td>35.847458</td>
      <td>5.817794</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29440.0</td>
      <td>2.019052e+11</td>
      <td>367.198506</td>
      <td>7.738381</td>
      <td>17.553719</td>
      <td>47.965553</td>
      <td>52.907407</td>
      <td>43.462963</td>
      <td>8.869752</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29440.0</td>
      <td>2.019062e+11</td>
      <td>370.992008</td>
      <td>8.138490</td>
      <td>17.251852</td>
      <td>61.743400</td>
      <td>67.316667</td>
      <td>55.600000</td>
      <td>16.524111</td>
    </tr>
    <tr>
      <th>7</th>
      <td>29440.0</td>
      <td>2.019072e+11</td>
      <td>294.433641</td>
      <td>5.785714</td>
      <td>15.034722</td>
      <td>61.569955</td>
      <td>67.774194</td>
      <td>55.903226</td>
      <td>16.427753</td>
    </tr>
    <tr>
      <th>8</th>
      <td>29440.0</td>
      <td>2.019082e+11</td>
      <td>320.335766</td>
      <td>6.769447</td>
      <td>15.751678</td>
      <td>60.598649</td>
      <td>65.935484</td>
      <td>55.016129</td>
      <td>15.888138</td>
    </tr>
    <tr>
      <th>9</th>
      <td>29440.0</td>
      <td>2.019092e+11</td>
      <td>306.491058</td>
      <td>6.363594</td>
      <td>15.173285</td>
      <td>49.958137</td>
      <td>53.766667</td>
      <td>45.350000</td>
      <td>9.976743</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29440.0</td>
      <td>2.019100e+11</td>
      <td>239.577465</td>
      <td>10.169014</td>
      <td>17.470588</td>
      <td>42.774648</td>
      <td>48.500000</td>
      <td>41.000000</td>
      <td>5.985915</td>
    </tr>
  </tbody>
</table>
<p>601 rows × 9 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Detecting-warm-months">
<h2>Detecting warm months<a class="headerlink" href="#Detecting-warm-months" title="Permalink to this headline">¶</a></h2>
<p>Now, we have aggregated our data on monthly level and all we need to do is to check which years had the warmest April temperatures. A simple approach is to select all aprils from the data, group the data and check which group(s) have the highest mean value:</p>
<ul class="simple">
<li>select all records that are from April (regardless of the year):</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">aprils</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;MONTH&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>take a subset of columns that might contain interesting information:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">aprils</span> <span class="o">=</span> <span class="n">aprils</span><span class="p">[[</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">,</span><span class="s1">&#39;YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;MONTH&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>group by year and month:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">aprils</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">,</span> <span class="s2">&quot;MONTH&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>calculate mean for each group:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">monthly_mean</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">monthly_mean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TEMP_F</th>
      <th>TEMP_C</th>
    </tr>
    <tr>
      <th>YEAR</th>
      <th>MONTH</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1906</th>
      <th>4</th>
      <td>29440</td>
      <td>38.822222</td>
      <td>3.790123</td>
    </tr>
    <tr>
      <th>1907</th>
      <th>4</th>
      <td>29440</td>
      <td>36.111111</td>
      <td>2.283951</td>
    </tr>
    <tr>
      <th>1908</th>
      <th>4</th>
      <td>29440</td>
      <td>36.811111</td>
      <td>2.672840</td>
    </tr>
    <tr>
      <th>1909</th>
      <th>4</th>
      <td>29440</td>
      <td>31.977778</td>
      <td>-0.012346</td>
    </tr>
    <tr>
      <th>1910</th>
      <th>4</th>
      <td>29440</td>
      <td>39.833333</td>
      <td>4.351852</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<ul class="simple">
<li>check the highest temperature values (sort the data frame in a descending order):</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">monthly_mean</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>STATION_NUMBER</th>
      <th>TEMP_F</th>
      <th>TEMP_C</th>
    </tr>
    <tr>
      <th>YEAR</th>
      <th>MONTH</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019</th>
      <th>4</th>
      <td>29440</td>
      <td>42.472030</td>
      <td>5.817794</td>
    </tr>
    <tr>
      <th>1990</th>
      <th>4</th>
      <td>29440</td>
      <td>41.918084</td>
      <td>5.510047</td>
    </tr>
    <tr>
      <th>1989</th>
      <th>4</th>
      <td>29440</td>
      <td>41.369647</td>
      <td>5.205360</td>
    </tr>
    <tr>
      <th>2011</th>
      <th>4</th>
      <td>29440</td>
      <td>41.290730</td>
      <td>5.161517</td>
    </tr>
    <tr>
      <th>2004</th>
      <th>4</th>
      <td>29440</td>
      <td>41.249676</td>
      <td>5.138709</td>
    </tr>
    <tr>
      <th>2002</th>
      <th>4</th>
      <td>29440</td>
      <td>41.132353</td>
      <td>5.073529</td>
    </tr>
    <tr>
      <th>1983</th>
      <th>4</th>
      <td>29440</td>
      <td>41.016183</td>
      <td>5.008991</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>4</th>
      <td>29440</td>
      <td>40.962343</td>
      <td>4.979079</td>
    </tr>
    <tr>
      <th>2000</th>
      <th>4</th>
      <td>29440</td>
      <td>40.777778</td>
      <td>4.876543</td>
    </tr>
    <tr>
      <th>1999</th>
      <th>4</th>
      <td>29440</td>
      <td>40.695291</td>
      <td>4.830717</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>How did April 2019 rank at the Tampere Pirkkala observation station 🌡️?</p>
</div>
<div class="section" id="Repeating-the-data-analysis-with-larger-dataset">
<h2>Repeating the data analysis with larger dataset<a class="headerlink" href="#Repeating-the-data-analysis-with-larger-dataset" title="Permalink to this headline">¶</a></h2>
<p>Finally, let’s repeat the data analysis steps above for all the available data we have (!!). First, confirm the path to the <strong>folder</strong> where all the input data are located. The idea is, that we will repeat the analysis process for each input file using a (rather long) for loop! Here we have all the main analysis steps with some additional output info - all in one long code cell:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Read selected columns of  data using varying amount of spaces as separator and specifying * characters as NoData values</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;USAF&#39;</span><span class="p">,</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">,</span> <span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">],</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>

<span class="c1"># Rename the columns</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;USAF&#39;</span><span class="p">:</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">:</span> <span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">:</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">:</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">:</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">}</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_names</span><span class="p">)</span>

<span class="c1">#Print info about the current input file:</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;STATION NUMBER:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;STATION_NUMBER&quot;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;NUMBER OF OBSERVATIONS:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="c1"># Create column</span>
<span class="n">col_name</span> <span class="o">=</span> <span class="s1">&#39;TEMP_C&#39;</span>
<span class="n">data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c1"># Convert tempetarues from Fahrenheits to Celsius</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fahr_to_celsius</span><span class="p">)</span>

<span class="c1"># Convert TIME to string</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># Parse year and month</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Extract observations for the months of April</span>
<span class="n">aprils</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># Take a subset of columns</span>
<span class="n">aprils</span> <span class="o">=</span> <span class="n">aprils</span><span class="p">[[</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">,</span> <span class="s1">&#39;YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;MONTH&#39;</span><span class="p">]]</span>

<span class="c1"># Group by year and month</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">aprils</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">,</span> <span class="s2">&quot;MONTH&quot;</span><span class="p">])</span>

<span class="c1"># Get mean values for each group</span>
<span class="n">monthly_mean</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Print info</span>
<span class="k">print</span><span class="p">(</span><span class="n">monthly_mean</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
STATION NUMBER: 29440
NUMBER OF OBSERVATIONS: 757983
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2019 4               29440  42.472030  5.817794
1990 4               29440  41.918084  5.510047
1989 4               29440  41.369647  5.205360
2011 4               29440  41.290730  5.161517
2004 4               29440  41.249676  5.138709


</pre></div></div>
</div>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">glob()</span></code> function from the module <code class="docutils literal notranslate"><span class="pre">glob</span></code> to list our input files.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">glob</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;data/0*txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Note</strong></p>
<p>Note that we’re using the * character as a wildcard, so any file that starts with <code class="docutils literal notranslate"><span class="pre">data/0</span></code> and ends with <code class="docutils literal notranslate"><span class="pre">txt</span></code> will be added to the list of files we will iterate over. We specifically use <code class="docutils literal notranslate"><span class="pre">data/0</span></code> as the starting part of the file names to avoid having our metadata files included in the list!</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of files in the list&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_list</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of files in the list 15
[&#39;data\\028360.txt&#39;, &#39;data\\028690.txt&#39;, &#39;data\\028750.txt&#39;, &#39;data\\028970.txt&#39;, &#39;data\\029070.txt&#39;, &#39;data\\029110.txt&#39;, &#39;data\\029170.txt&#39;, &#39;data\\029350.txt&#39;, &#39;data\\029440.txt&#39;, &#39;data\\029500.txt&#39;, &#39;data\\029700.txt&#39;, &#39;data\\029720.txt&#39;, &#39;data\\029740.txt&#39;, &#39;data\\029810.txt&#39;, &#39;data\\029820.txt&#39;]
</pre></div></div>
</div>
<p>Now, you should have all the relevant file names in a list, and we can loop over the list using a for-loop:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
data\028360.txt
data\028690.txt
data\028750.txt
data\028970.txt
data\029070.txt
data\029110.txt
data\029170.txt
data\029350.txt
data\029440.txt
data\029500.txt
data\029700.txt
data\029720.txt
data\029740.txt
data\029810.txt
data\029820.txt
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Repeat the analysis steps for each input file:</span>
<span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>

    <span class="c1"># Read selected columns of  data using varying amount of spaces as separator and specifying * characters as NoData values</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;USAF&#39;</span><span class="p">,</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">,</span> <span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">],</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>

    <span class="c1"># Rename the columns</span>
    <span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;USAF&#39;</span><span class="p">:</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">:</span> <span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">:</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">:</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">:</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_names</span><span class="p">)</span>

    <span class="c1">#Print info about the current input file:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;STATION NUMBER:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;STATION_NUMBER&quot;</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;NUMBER OF OBSERVATIONS:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="c1"># Create column</span>
    <span class="n">col_name</span> <span class="o">=</span> <span class="s1">&#39;TEMP_C&#39;</span>
    <span class="n">data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1"># Convert tempetarues from Fahrenheits to Celsius</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_F&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fahr_to_celsius</span><span class="p">)</span>

    <span class="c1"># Convert TIME to string</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1"># Parse year and month</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># Extract observations for the months of April</span>
    <span class="n">aprils</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>

    <span class="c1"># Take a subset of columns</span>
    <span class="n">aprils</span> <span class="o">=</span> <span class="n">aprils</span><span class="p">[[</span><span class="s1">&#39;STATION_NUMBER&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP_F&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">,</span> <span class="s1">&#39;YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;MONTH&#39;</span><span class="p">]]</span>

    <span class="c1"># Group by year and month</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">aprils</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">,</span> <span class="s2">&quot;MONTH&quot;</span><span class="p">])</span>

    <span class="c1"># Get mean values for each group</span>
    <span class="n">monthly_mean</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># Print info</span>
    <span class="k">print</span><span class="p">(</span><span class="n">monthly_mean</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
STATION NUMBER: 28360
NUMBER OF OBSERVATIONS: 193825
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1937 4               28360  38.738095  3.743386
2011 4               28360  36.699571  2.610873
1921 4               28360  36.622222  2.567901
2002 4               28360  36.500000  2.500000
2019 4               28360  34.979138  1.655076


STATION NUMBER: 28690
NUMBER OF OBSERVATIONS: 542788
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2011 4               28690  35.430640  1.905911
2019 4               28690  35.215114  1.786174
2016 4               28690  35.031103  1.683946
1989 4               28690  34.612766  1.451537
2002 4               28690  34.279855  1.266586


STATION NUMBER: 28750
NUMBER OF OBSERVATIONS: 474562
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1989 4               28750  39.008403  3.893557
1983 4               28750  38.758475  3.754708
2019 4               28750  38.651599  3.695333
2002 4               28750  38.270419  3.483566
1994 4               28750  38.145833  3.414352


STATION NUMBER: 28970
NUMBER OF OBSERVATIONS: 555740
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1921 4               28970  41.688889  5.382716
1999 4               28970  39.073600  3.929778
2019 4               28970  38.706456  3.725809
1989 4               28970  38.362869  3.534927
2011 4               28970  38.094172  3.385651


STATION NUMBER: 29070
NUMBER OF OBSERVATIONS: 83567
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2014 4               29070  35.437326  1.909626
2015 4               29070  34.437209  1.354005
2004 4               29070  34.347032  1.303907
2016 4               29070  34.303199  1.279555
2008 4               29070  34.241667  1.245370


STATION NUMBER: 29110
NUMBER OF OBSERVATIONS: 483784
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1921 4               29110  42.166667  5.648148
2004 4               29110  41.682699  5.379277
1989 4               29110  41.420168  5.233427
1937 4               29110  40.671429  4.817460
2019 4               29110  40.636300  4.797945


STATION NUMBER: 29170
NUMBER OF OBSERVATIONS: 561097
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1937 4               29170  43.289157  6.271754
2019 4               29170  40.666820  4.814900
2011 4               29170  40.015962  4.453312
2001 4               29170  39.713228  4.285126
1906 4               29170  39.688889  4.271605


STATION NUMBER: 29350
NUMBER OF OBSERVATIONS: 559667
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1921 4               29350  45.144444  7.302469
1925 4               29350  40.777778  4.876543
2011 4               29350  40.670108  4.816727
2019 4               29350  40.585002  4.769446
2001 4               29350  39.662827  4.257126


STATION NUMBER: 29440
NUMBER OF OBSERVATIONS: 757983
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2019 4               29440  42.472030  5.817794
1990 4               29440  41.918084  5.510047
1989 4               29440  41.369647  5.205360
2011 4               29440  41.290730  5.161517
2004 4               29440  41.249676  5.138709


STATION NUMBER: 29500
NUMBER OF OBSERVATIONS: 103105
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2019 4               29500  41.639777  5.355432
2008 4               29500  40.838936  4.910520
2014 4               29500  40.226415  4.570231
2016 4               29500  39.176634  3.987019
2011 4               29500  38.647826  3.693237


STATION NUMBER: 29700
NUMBER OF OBSERVATIONS: 473881
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1921 4               29700  42.811111  6.006173
2000 4               29700  42.375587  5.764215
1990 4               29700  42.054167  5.585648
2019 4               29700  41.548747  5.304859
2004 4               29700  41.493392  5.274107


STATION NUMBER: 29720
NUMBER OF OBSERVATIONS: 843688
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2019 4               29720  43.558414  6.421341
1990 4               29720  43.313576  6.285320
2000 4               29720  42.663169  5.923983
2008 4               29720  42.349642  5.749801
2004 4               29720  41.903492  5.501940


STATION NUMBER: 29740
NUMBER OF OBSERVATIONS: 931767
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2000 4               29740  43.479793  6.377663
2019 4               29740  43.464070  6.368928
1990 4               29740  43.375078  6.319488
2008 4               29740  43.341429  6.300794
2011 4               29740  42.750702  5.972612


STATION NUMBER: 29810
NUMBER OF OBSERVATIONS: 199330
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
1990 4               29810  41.157895  5.087719
2019 4               29810  40.783032  4.879462
2014 4               29810  40.058036  4.476687
2008 4               29810  40.044881  4.469378
2016 4               29810  39.270308  4.039060


STATION NUMBER: 29820
NUMBER OF OBSERVATIONS: 198334
            STATION_NUMBER     TEMP_F    TEMP_C
YEAR MONTH
2019 4               29820  41.182197  5.101221
1990 4               29820  41.144681  5.080378
2014 4               29820  40.497908  4.721060
2008 4               29820  39.941423  4.411901
1913 4               29820  39.622222  4.234568


</pre></div></div>
</div>
<p>How about now, how did April 2019 rank across different stations?</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="errors.html" class="btn btn-neutral float-right" title="Dealing with errors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../lessons/L6/overview.html" class="btn btn-neutral float-left" title="Lesson overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, D. Whipp, H. Tenkanen and V. Heikinheimo, Department of Geosciences and Geography, University of Helsinki
      <span class="lastupdated">
        Last updated on Oct 17, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p> <br/> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /> </a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: develop
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../../2017/index.html">2017</a></dd>
            <dd><a href="../../../2018/index.html">2018</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="advanced-data-processing-with-pandas.html">develop</a></dd>
            <dd><a href="../../../master/notebooks/L6/advanced-data-processing-with-pandas.html">master</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
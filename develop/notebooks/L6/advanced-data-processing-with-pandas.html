

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-105019106-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data processing with Pandas, part 2 &mdash; Geo-Python site documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'site',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dealing with errors" href="errors.html" />
    <link rel="prev" title="Lesson overview" href="../../lessons/L6/overview.html" />
    <link href="../../_static/geo-python.css" rel="stylesheet" type="text/css">
     

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Geo-Python
          

          
            
            <img src="../../_static/HY-logo-2017.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2019
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/course-info.html">General info</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/course-info.html#course-meetings-in-period-i">Course meetings in Period I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/course-info.html#instructors">Instructors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/course-info.html#lecturers">Lecturers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/course-info.html#course-assistants">Course assistants</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/course-info.html#course-websites">Course websites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/learning-goals.html">Learning goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/grading.html">Grading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/grading.html#general-grading-breakdown">General grading breakdown</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/installing-anacondas.html">Installing Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#install-python-on-windows">Install Python on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#install-python-on-macos">Install Python on macOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#install-python-on-linux">Install Python on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/installing-anacondas.html#installing-packages-using-conda">Installing packages using Conda</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/installing-anacondas.html#the-easiest-way">The easiest way</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/installing-anacondas.html#installing-jupyter-lab-using-conda">Installing Jupyter Lab using conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/installing-anacondas.html#alternative-way-to-install-packages-if-typical-doesn-t-work">Alternative way to install packages if typical doesn’t work</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/python-vocabulary.html">Vocabulary - Basic terms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/python-vocabulary.html#python-vocabulary">Python vocabulary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/python-vocabulary.html#basic-vocabulary-of-version-control">Basic vocabulary of Version Control</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/resources.html">Resources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/resources.html#books">Books</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/resources.html#python-tutorials">Python tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/resources.html#git-github-tutorials">Git + Github tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/licensing.html">License and terms of usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/licensing.html#instructional-materials">Instructional materials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/licensing.html#you-are-free-to">you are free to</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/licensing.html#under-the-following-terms">Under the following terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-info/licensing.html#notices">Notices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../course-info/licensing.html#code-snippets-software">Code snippets / software</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/motivation.html">Motivation for the course</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/motivation.html#effective-data-visualization">Effective data visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/overview.html#lecture-video">Lecture video</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/overview.html#lecture-slides">Lecture slides</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/course-environment-components.html">Course environment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#jupyterlab">JupyterLab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#cloud-computing-environments">Cloud computing environments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#binder">Binder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#csc-notebooks">CSC Notebooks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#using-your-own-computer">Using your own computer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#git-and-github">Git and GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#slack">Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#voting-and-polling">Voting and polling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/course-environment-components.html#page-summary">Page summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/slack-usage.html">Communicating with Slack</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#accessing-the-workspace-in-slack">Accessing the workspace in Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#overview-of-slack">Overview of Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#basic-usage-of-slack">Basic usage of Slack</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/slack-usage.html#notifying-a-user">Notifying a user</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L1/slack-usage.html#using-threads">Using threads</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/slack-usage.html#general-guidelines-for-communication">General guidelines for communication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L1/a-taste-of-python.html">A taste of Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/a-taste-of-python.html#General-information">General information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Sources">Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#About-this-document">About this document</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Getting-started">Getting started</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L1/a-taste-of-python.html#Variables,-math-and-functions">Variables, math and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Simple-Python-math">Simple Python math</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Math-operations">Math operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L1/a-taste-of-python.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Combining-functions">Combining functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Variables">Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L1/a-taste-of-python.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Updating-variables">Updating variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Variable-values">Variable values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Data-types">Data types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L1/a-taste-of-python.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L1/a-taste-of-python.html#Character-input">Character input</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L1/gcp-1-variable-naming.html">Good coding practices - Selecting “good” variable names</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/gcp-1-variable-naming.html#Some-&quot;not-so-good&quot;-variable-names">Some “not-so-good” variable names</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L1/gcp-1-variable-naming.html#Selecting-&quot;good&quot;-variable-names">Selecting “good” variable names</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L1/gcp-1-variable-naming.html#Formatting-&quot;good&quot;-variable-names">Formatting “good” variable names</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L1/exercise-1.html">Exercise 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/exercise-1.html#part-1-creating-a-github-com-account-and-using-slack">Part 1 - Creating a GitHub.com account and using Slack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/exercise-1.html#part-2-cooking-up-some-python">Part 2 - Cooking up some Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L1/exercise-1.html#summary-what-to-submit">Summary (what to submit)</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/overview.html#lecture-video">Lecture video</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L2/Python-basic-elements.html">Basic elements of Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L2/Python-basic-elements.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L2/Python-basic-elements.html#Data-types-revisited">Data types revisited</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Let's-start-with-some-data">Let’s start with some data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Reminder:-Data-types-and-their-compatibility">Reminder: Data types and their compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Converting-data-from-one-type-to-another">Converting data from one type to another</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Combining-text-and-numbers">Combining text and numbers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L2/Python-basic-elements.html#Lists-and-indices">Lists and indices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Creating-a-list">Creating a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Index-values">Index values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#A-useful-analog---Bill-the-vending-machine">A useful analog - Bill the vending machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Number-of-items-in-a-list">Number of items in a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Index-value-tips">Index value tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Modifying-list-values">Modifying list values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Data-types-in-lists">Data types in lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Adding-and-removing-values-from-lists">Adding and removing values from lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Appending-to-an-integer?-Not-so-fast...">Appending to an integer? Not so fast…</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Some-other-useful-list-methods">Some other useful list methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Reversing-a-list">Reversing a list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/Python-basic-elements.html#Sorting-a-list">Sorting a list</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L2/gcp-2-describing-code.html">Good coding practices - Describing your code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Do-I-need-to-describe-my-code?">Do I need to describe my code?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#But-seriously,-the-Internet-says-I-shouldn't-comment-my-code">But seriously, the Internet says I shouldn’t comment my code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Code-comments">Code comments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Line-comments">Line comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Block-comments">Block comments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Markdown-text">Markdown text</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/gcp-2-describing-code.html#Data-source">Data source</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html">Introduction to Version Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#familiar">Familiar?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#what-is-version-control">What is version control?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#what-is-git">What is Git?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#what-is-github">What is GitHub?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#relies-on-git">Relies on Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#social-collaborative-network">Social (collaborative) network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#open-source-science">Open source / science</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#online-tools">Online tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#issue-tracking">Issue tracking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#basic-vocabulary">Basic vocabulary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/intro-to-GitHub.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/git-basics.html">Meet Git</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#overview-and-preparations">Overview and preparations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#key-concepts-and-tools">Key concepts and tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#using-git-from-the-command-line">Using Git from the command line</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#clone-a-repository-from-github">Clone a repository from GitHub</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#add-changes-to-the-staging-area">Add changes to the staging area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#commit-changes">Commit changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#publish-your-local-commits-to-github">Publish your local commits to GitHub</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#using-the-jupyterlab-git-plugin">Using the JupyterLab Git plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#preparations-in-the-terminal">Preparations in the Terminal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#stage-changes-in-the-plugin">Stage changes in the plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#commit-changes-in-the-plugin">Commit changes in the plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/git-basics.html#pull-and-push-using-the-plugin">Pull and push using the plugin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/git-basics.html#if-everything-else-fails">If everything else fails…</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/GitHub-classroom.html">Using Classroom for Github</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/GitHub-classroom.html#classroom-for-github">Classroom for GitHub</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L2/exercise-2.html">Exercise 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/exercise-2.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L2/exercise-2.html#exercise-2-hints">Exercise 2 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/exercise-2.html#git">Git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/exercise-2.html#list-methods">List methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L2/exercise-2.html#indentation-woes">Indentation woes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L3/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/overview.html#lecture">Lecture</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/for-loops.html">for loops</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/for-loops.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/for-loops.html#Basics-of-for-loops">Basics of for loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#A-(bad)-example">A (bad) example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#Introducing-the-for-loop">Introducing the for loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#for-loop-format">for loop format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L3/for-loops.html#Your-daily-for-loop">Your daily for loop</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#for-loop-variables">for loop variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#for-loops-and-the-range()-function">for loops and the range() function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L3/for-loops.html#Poll-question-pause">Poll question pause</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#Looping-over-the-length-of-lists-using-index-values">Looping over the length of lists using index values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/for-loops.html#Why-bother-looping-over-a-list-by-the-index-value?">Why bother looping over a list by the index value?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L3/for-loops.html#Poll-question-pause">Poll question pause</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/conditional-statements.html">Conditional statements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/conditional-statements.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/conditional-statements.html#Basics-of-conditional-statements">Basics of conditional statements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#A-simple-conditional-statement">A simple conditional statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#Comparison-operators-and-boolean-values">Comparison operators and boolean values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#if,-elif-and-else">if, elif and else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/conditional-statements.html#Combining-conditions">Combining conditions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L3/conditional-statements.html#Combining-for-loops-and-conditional-statements">Combining for-loops and conditional statements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/gcp-3-pep8.html">Good coding practices - writing readable code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/gcp-3-pep8.html#Working-code-vs-readable-code">Working code vs readable code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/gcp-3-pep8.html#PEP-8-Style-Guide">PEP 8 Style Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Maximum-line-length">Maximum line length</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Indentation">Indentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Whitespace-and-binary-operators">Whitespace and binary operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Avoid-extraneous-whitespace">Avoid extraneous whitespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/gcp-3-pep8.html#Write-one-statement-per-line">Write one statement per line</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L3/exercise-3.html">Exercise 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/exercise-3.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L3/exercise-3.html#exercise-3-hints">Exercise 3 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#general-tips">General tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#tests">Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#combining-strings">Combining strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L3/exercise-3.html#nested-if-statements">Nested if statements</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L4/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/overview.html#lecture">Lecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/overview.html#id1">Lecture</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L4/functions.html">Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#What-is-a-function?">What is a function?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Anatomy-of-a-function">Anatomy of a function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Our-first-function-(aww...)">Our first function (aww…)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Calling-functions">Calling functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-new-function">Using our new function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Let's-make-another-function">Let’s make another function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-second-function">Using our second function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Check-your-understanding">Check your understanding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Functions-within-a-function-(Yo-dawg...)">Functions within a function (Yo dawg…)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-combined-functions">Using our combined functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#An-introduction-to-script-files">An introduction to script files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#The-general-concept-of-a-.py-script-file">The general concept of a .py script file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Getting-started">Getting started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Saving-a-text-file-as-a-Python-file">Saving a text file as a Python file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Saving-and-loading-functions">Saving and loading functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Saving-functions-in-a-script-file">Saving functions in a script file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Calling-functions-from-a-script-file">Calling functions from a script file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Making-sure-we're-in-the-right-working-directory">Making sure we’re in the right working directory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Binder-users">Binder users</a></li>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#CSC-notebooks-users">CSC notebooks users</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Changing-the-working-directory">Changing the working directory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Binder-users">Binder users</a></li>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#CSC-notebooks-users">CSC notebooks users</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Importing-our-script-functions">Importing our script functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-our-script-functions">Using our script functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../L4/functions.html#Importing-multiple-functions">Importing multiple functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Importing-all-functions-from-a-script">Importing all functions from a script</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/functions.html#Temperature-calculator-(optional,-advanced-topic)">Temperature calculator (<em>optional, advanced topic</em>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Defining-the-function">Defining the function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Adding-some-conditional-statements">Adding some conditional statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Returning-the-result">Returning the result</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Adding-a-docstring">Adding a docstring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Testing-the-new-function">Testing the new function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/functions.html#Using-the-tempCalculator">Using the tempCalculator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L4/modules.html">Loading and using modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Modules,-packages-and-libraries?">Modules, packages and libraries?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Loading-modules">Loading modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Renaming-imported-modules">Renaming imported modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Importing-a-single-function">Importing a single function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Importing-a-submodule">Importing a submodule</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Using-module-functions">Using module functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#What-should-I-not-do?">What should I not do?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#from-X-import-*">from X import *</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/modules.html#Poor-names-when-renaming-on-import">Poor names when renaming on import</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/modules.html#Extra:-installing-packages">Extra: installing packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L4/writing-scripts.html">Good coding practices - Writing our scripts the “right” way</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Inline-comments">Inline comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Use-line-breaks-wisely">Use line breaks wisely</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Use-a-docstring">Use a docstring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Advanced-topics">Advanced topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L4/writing-scripts.html#Adding-a-license">Adding a license</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L4/writing-scripts.html#Starting-with-a-shebang">Starting with a shebang</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L4/writing-scripts.html#Page-summary">Page summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L4/exercise-4.html">Exercise 4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/exercise-4.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L4/exercise-4.html#exercise-4-hints">Exercise 4 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L4/exercise-4.html#importing-variables-from-a-script">Importing variables from a script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L4/exercise-4.html#counting-values-from-a-list">Counting values from a list</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/overview.html#lecture-videos">Lecture videos</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/pandas-overview.html">What is Pandas?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/pandas-overview.html#easy-to-use-data-structures">Easy-to-use data structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/pandas-overview.html#combines-functionalities-from-many-python-modules">Combines functionalities from many Python modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/pandas-overview.html#supports-data-read-write-from-multiple-formats">Supports data read/write from multiple formats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L5/exploring-data-using-pandas.html">Exploring data using Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Input-data:-weather-statistics">Input data: weather statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Reading-a-data-file-with-Pandas">Reading a data file with Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#DataFrame-properties">DataFrame properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Selecting-columns">Selecting columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Descriptive-statistics">Descriptive statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Extra:-Very-basic-plots">Extra: Very basic plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exploring-data-using-pandas.html#Extra:-From-lists-to-pandas-objects">Extra: From lists to pandas objects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L5/processing-data-with-pandas.html">Processing data with Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Basic-calculations">Basic calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Selecting-rows-and-columns">Selecting rows and columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Filtering-and-updating-data">Filtering and updating data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Dealing-with-missing-data">Dealing with missing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Data-type-conversions">Data type conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Unique-values">Unique values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Sorting-data">Sorting data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/processing-data-with-pandas.html#Writing-data-to-a-file">Writing data to a file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L5/exercise-5.html">Exercise 5</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L5/exercise-5.html#exercise-5-hints-for-pandas">Exercise 5 hints for Pandas</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 6</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L6/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/overview.html#learning-goals">Learning goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/overview.html#lesson-videos">Lesson videos</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data processing with Pandas, part 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Input-data">Input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Reading-the-data">Reading the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Renaming-columns">Renaming columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Reminder:-basic-calculations">Reminder: basic calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Using-your-own-functions-in-pandas">Using your own functions in pandas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Iterating-over-rows">Iterating over rows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Applying-a-function">Applying a function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#String-manipulation-in-Pandas">String manipulation in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Aggregating-data-in-Pandas-by-grouping">Aggregating data in Pandas by grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Extra:-datetime">Extra: datetime</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Finding-outliers-from-the-data">Finding outliers from the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Repeating-the-data-analysis-with-larger-dataset">Repeating the data analysis with larger dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">Dealing with errors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="errors.html#Interpreting-error-messages">Interpreting error messages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="errors.html#Reading-error-messages">Reading error messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="errors.html#Common-errors-and-exceptions">Common errors and exceptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="errors.html#IndexErrors">IndexErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#NameErrors">NameErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#IndentationErrors">IndentationErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#TypeErrors">TypeErrors</a></li>
<li class="toctree-l4"><a class="reference internal" href="errors.html#Other-kinds-of-errors">Other kinds of errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="errors.html#More-information">More information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gcp-assertions.html">Good coding practices - Using assertions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gcp-assertions.html#Assertions">Assertions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gcp-assertions.html#Multiple-assertions">Multiple assertions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="gcp-assertions.html#A-bad-example">A bad example</a></li>
<li class="toctree-l4"><a class="reference internal" href="gcp-assertions.html#A-better-example">A better example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gcp-assertions.html#More-information">More information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging your Python code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Source">Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Test-your-code-with-known-outputs">Test your code with known outputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="debugging.html#Testing-with-a-simplified-data-file">Testing with a simplified data file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Make-your-code-crash-quickly-and-regularly">Make your code crash quickly and regularly</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html#Make-small-changes-and-track-them">Make small changes and track them</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lessons/L6/exercise-6.html">Exercise 6</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/exercise-6.html#cloud-computing-environments">Cloud computing environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lessons/L6/exercise-6.html#exercise-6-hints">Exercise 6 hints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#data-format-for-problems-1-3">Data format for problems 1-3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#reading-in-fixed-width-text-files">Reading in fixed-width text files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#skipping-the-second-row-of-a-file">Skipping the second row of a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lessons/L6/exercise-6.html#joining-data-from-one-dataframe-to-another">Joining data from one DataFrame to another</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Geo-Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Data processing with Pandas, part 2</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/geo-python/site/blob/develop/source/notebooks/L6/advanced-data-processing-with-pandas.ipynb" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  


    
    



    <p class="scv-banner scv-sphinx_rtd_theme"><a href="../../../master/notebooks/L6/advanced-data-processing-with-pandas.html"><b>Warning:</b> This document is for the development version of Geo-Python. The main version is master.</a></p>

<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
This page was generated from <a class="reference external" href="https://github.com/Geo-Python/site/blob/master/source/notebooks/L6/advanced-data-processing-with-pandas.ipynb">source/notebooks/L6/advanced-data-processing-with-pandas.ipynb</a>.
<span class="raw-html"><br/><a href="https://mybinder.org/v2/gh/geo-python/site/master?urlpath=lab/tree/source/notebooks/L6/advanced-data-processing-with-pandas.ipynb"><img alt="Binder badge" src="https://img.shields.io/badge/launch-full%20binder-red.svg" style="vertical-align:text-bottom"></a></span>
<span class="raw-html"><a href="https://mybinder.org/v2/gh/geo-python/notebooks/master?urlpath=lab/tree/notebooks/L6/advanced-data-processing-with-pandas.ipynb"><img alt="Binder badge" src="https://img.shields.io/badge/launch-student%20binder-red.svg" style="vertical-align:text-bottom"></a></span>
<span class="raw-html"><a href="https://notebooks.csc.fi/#/blueprint/df93f30d14e44b51907d135726eb6ef4"><img alt="CSC badge" src="https://img.shields.io/badge/launch-CSC%20notebook-blue.svg" style="vertical-align:text-bottom"></a></span></div>
<div class="section" id="Data-processing-with-Pandas,-part-2">
<h1>Data processing with Pandas, part 2<a class="headerlink" href="#Data-processing-with-Pandas,-part-2" title="Permalink to this headline">¶</a></h1>
<p>This week we will continue developing our skills using <a class="reference external" href="https://pandas.pydata.org/">pandas</a> to process real data. The goal of this lesson is to use our data manipulation and analysis skills to detect weather anomalies (stormy winds) in Helsinki, during August 2017.</p>
<p>We will cover a number of useful techniques in pandas including:</p>
<ul class="simple">
<li>renaming columns</li>
<li>iterating data frame rows and applying functions</li>
<li>data aggregation</li>
<li>repeating the analysis task</li>
</ul>
<div class="section" id="Input-data">
<h2>Input data<a class="headerlink" href="#Input-data" title="Permalink to this headline">¶</a></h2>
<p>In the lesson this week we are using weather observation data from Helsinki, Finland from August 2017 when a severe thunderstorm “Kiira” hit souther Finland. <a class="reference external" href="https://yle.fi/uutiset/osasto/news/saturday_night_storm_downs_trees_cuts_electricity_in_the_south/9773250">Kiira caused major damage in different pars of Helsinki</a> (<em>Source:</em> <a class="reference external" href="https://yle.fi/uutiset/osasto/news/saturday_night_storm_downs_trees_cuts_electricity_in_the_south/9773250">YLE</a>).</p>
<p><img alt="Markku Sipi/ Yle" src="../../_images/Kiira-storm.PNG" /></p>
<p><em>Photo: Markku Sipi/YLE</em></p>
<p>Notice that this time, we will read the <strong>original data file</strong> obtained from NOAA without any modifications to the data file (week 5 input data had been modified after downloading it from NOAA). The input data for this week is separated with varying amount of spaces (fixed width). The first lines and columns of the data looks like following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">USAF</span>  <span class="n">WBAN</span> <span class="n">YR</span><span class="o">--</span><span class="n">MODAHRMN</span> <span class="n">DIR</span> <span class="n">SPD</span> <span class="n">GUS</span> <span class="n">CLG</span> <span class="n">SKC</span> <span class="n">L</span> <span class="n">M</span> <span class="n">H</span>  <span class="n">VSB</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">MW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">AW</span> <span class="n">W</span> <span class="n">TEMP</span> <span class="n">DEWP</span>    <span class="n">SLP</span>  <span class="o">...</span>
<span class="mi">029740</span> <span class="mi">99999</span> <span class="mi">201708040000</span> <span class="mi">114</span>   <span class="mi">6</span> <span class="o">***</span> <span class="o">***</span> <span class="n">BKN</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="mf">25.0</span> <span class="mi">03</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="mi">2</span>   <span class="mi">58</span>   <span class="mi">56</span> <span class="mf">1005.6</span>  <span class="o">...</span>
<span class="mi">029740</span> <span class="mi">99999</span> <span class="mi">201708040020</span> <span class="mi">100</span>   <span class="mi">6</span> <span class="o">***</span>  <span class="mi">75</span> <span class="o">***</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">6.2</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">59</span>   <span class="mi">57</span> <span class="o">******</span>  <span class="o">...</span>
<span class="mi">029740</span> <span class="mi">99999</span> <span class="mi">201708040050</span> <span class="mi">100</span>   <span class="mi">5</span> <span class="o">***</span>  <span class="mi">60</span> <span class="o">***</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>  <span class="mf">6.2</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">59</span>   <span class="mi">57</span> <span class="o">******</span>  <span class="o">...</span>
<span class="mi">029740</span> <span class="mi">99999</span> <span class="mi">201708040100</span> <span class="mi">123</span>   <span class="mi">8</span> <span class="o">***</span>  <span class="mi">63</span> <span class="n">OVC</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="mi">23</span> <span class="o">**</span> <span class="o">**</span> <span class="o">**</span> <span class="o">*</span>   <span class="mi">59</span>   <span class="mi">58</span> <span class="mf">1004.7</span>  <span class="o">...</span>
</pre></div>
</div>
<p><strong>We will first work with a subset of the data (data for one single day):</strong> <a class="reference external" href="data/6591337447542dat_sample.txt">data/6591337447542dat_sample.txt</a><strong>, before repeating the process on a bigger data set (data for the whole month of August):</strong> <a class="reference external" href="data/6591337447542dat_August.txt">data/6591337447542dat_August.txt</a>.</p>
</div>
<div class="section" id="Reading-the-data">
<h2>Reading the data<a class="headerlink" href="#Reading-the-data" title="Permalink to this headline">¶</a></h2>
<p>Because the data is <strong>separated with varying amount of spaces</strong>, we need to tell Pandas how to read it. We can control the delimiter with <code class="docutils literal notranslate"><span class="pre">sep</span></code> parameter following the documentation of the function <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">read_csv()</a>:</p>
<p><a href="#id2"><span class="problematic" id="id3">|read\_csv sep|</span></a></p>
<p>Based on this information, we should be able to separate the columns by varying number spaces of spaces with <code class="docutils literal notranslate"><span class="pre">sep='\s+'</span></code> -parameter.</p>
<p>Our data also included <strong>No Data values</strong> with varying number of <code class="docutils literal notranslate"><span class="pre">*</span></code> -characters which we also need to take into account when reading the data. We can tell pandas to consider those characters as NaNs by specifying <code class="docutils literal notranslate"><span class="pre">na_values=['*',</span> <span class="pre">'**',</span> <span class="pre">'***',</span> <span class="pre">'****',</span> <span class="pre">'*****',</span> <span class="pre">'******']</span></code>.</p>
<ul class="simple">
<li>Let’s start by importing pandas and reading the data:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;data/6591337447542dat_sample.txt&quot;</span>

<span class="c1"># Read data using varying amount of spaces as separator and specifying * characters as NoData values</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>Let’s see how the data looks by printing the first five rows with <code class="docutils literal notranslate"><span class="pre">head()</span></code> function</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    USAF   WBAN  YR--MODAHRMN  DIR  SPD  GUS   CLG  SKC   L   M ...      SLP  \
0  29740  99999  201708040000  114    6  NaN   NaN  BKN NaN NaN ...   1005.6
1  29740  99999  201708040020  100    6  NaN  75.0  NaN NaN NaN ...      NaN
2  29740  99999  201708040050  100    5  NaN  60.0  NaN NaN NaN ...      NaN
3  29740  99999  201708040100  123    8  NaN  63.0  OVC NaN NaN ...   1004.7
4  29740  99999  201708040120  110    7  NaN  70.0  NaN NaN NaN ...      NaN

     ALT    STP  MAX  MIN  PCP01  PCP06  PCP24  PCPXX   SD
0    NaN  999.2  NaN  NaN    NaN    NaN    NaN    NaN  0.0
1  29.68    NaN  NaN  NaN    NaN    NaN    NaN    NaN  NaN
2  29.65    NaN  NaN  NaN    NaN    NaN    NaN    NaN  NaN
3    NaN  998.4  NaN  NaN    NaN    NaN    NaN    NaN  0.0
4  29.65    NaN  NaN  NaN    NaN    NaN    NaN    NaN  NaN

[5 rows x 33 columns]
</pre></div></div>
</div>
</div>
<div class="section" id="Renaming-columns">
<h2>Renaming columns<a class="headerlink" href="#Renaming-columns" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Let’s continue and check what columns do we have.</li>
</ul>
<p>Okay so we can see that the data was successfully read to the DataFrame and we also seemed to be able to convert the asterix (*) characters into <code class="docutils literal notranslate"><span class="pre">NaN</span></code> -values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;USAF&#39;, &#39;WBAN&#39;, &#39;YR--MODAHRMN&#39;, &#39;DIR&#39;, &#39;SPD&#39;, &#39;GUS&#39;, &#39;CLG&#39;, &#39;SKC&#39;, &#39;L&#39;,
       &#39;M&#39;, &#39;H&#39;, &#39;VSB&#39;, &#39;MW&#39;, &#39;MW.1&#39;, &#39;MW.2&#39;, &#39;MW.3&#39;, &#39;AW&#39;, &#39;AW.1&#39;, &#39;AW.2&#39;,
       &#39;AW.3&#39;, &#39;W&#39;, &#39;TEMP&#39;, &#39;DEWP&#39;, &#39;SLP&#39;, &#39;ALT&#39;, &#39;STP&#39;, &#39;MAX&#39;, &#39;MIN&#39;, &#39;PCP01&#39;,
       &#39;PCP06&#39;, &#39;PCP24&#39;, &#39;PCPXX&#39;, &#39;SD&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<p>As we can see, there are quite many columns, however, we won’t be needing all of them in our thunderstorm analysis.</p>
<ul class="simple">
<li>Let’s select only columns that we might need for detecting unexceptional weather conditions: <code class="docutils literal notranslate"><span class="pre">'YR--MODAHRMN',</span> <span class="pre">'DIR',</span> <span class="pre">'SPD',</span> <span class="pre">'GUS','TEMP',</span> <span class="pre">'MAX',</span> <span class="pre">'MIN'</span></code></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specify a list of columns that will be selected from the DataFrame</span>
<span class="n">select_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">,</span> <span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">]</span>

<span class="c1"># Do the selection</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">select_cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>Let’s see what our data looks like now by printing <strong>last</strong> 5 rows and the datatypes.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Show last five rows</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>

<span class="c1"># Check the data types</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data-types:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    YR--MODAHRMN  DIR  SPD   GUS  TEMP  MAX  MIN
67  201708042220  180   11   NaN    61  NaN  NaN
68  201708042250  190    8   NaN    59  NaN  NaN
69  201708042300  200    9  11.0    60  NaN  NaN
70  201708042320  190    8   NaN    59  NaN  NaN
71  201708042350  190    8   NaN    59  NaN  NaN

Data-types:

YR--MODAHRMN      int64
DIR               int64
SPD               int64
GUS             float64
TEMP              int64
MAX             float64
MIN             float64
dtype: object
</pre></div></div>
</div>
<p>The column names that we have are somewhat ackward. Let’s change them into more intuitive ones. This can be done easily using the <code class="docutils literal notranslate"><span class="pre">rename()</span></code> -method and a dictionary that lists old and new column names.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>dictionaries</strong></p>
<p><a class="reference external" href="https://docs.python.org/2/tutorial/datastructures.html#dictionaries">Dictionary</a> is a spesific data structure in Python for storing key-value pairs. During this course, we will use dictionaries mainly when renaming columns in a pandas series, but dictionaries are useful for many different purposes! For more information about Python dictionaries, check out <a class="reference external" href="https://realpython.com/python-dicts/">this tutorial</a>.</p>
</div>
<p>We can define the new column names using a <a class="reference external" href="https://www.tutorialspoint.com/python/python_dictionary.htm">dictionary</a> where we determine “<code class="docutils literal notranslate"><span class="pre">key:</span> <span class="pre">value</span></code>” -pairs, in which the original column name (the one which will be replaced) is the key, and the new column name is the value.</p>
<ul class="simple">
<li>Let’s change:</li>
<li><code class="docutils literal notranslate"><span class="pre">YR--MODAHRMN</span></code> column into <code class="docutils literal notranslate"><span class="pre">TIME</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">SPD</span></code> into <code class="docutils literal notranslate"><span class="pre">SPEED</span></code>, and</li>
<li><code class="docutils literal notranslate"><span class="pre">GUS</span></code> into <code class="docutils literal notranslate"><span class="pre">GUST</span></code></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create the dictionary with old and new names</span>
<span class="n">name_conversion_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">:</span> <span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">:</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">:</span> <span class="s1">&#39;GUST&#39;</span><span class="p">}</span>

<span class="c1"># Let&#39;s see what they look like and what is the type</span>
<span class="k">print</span><span class="p">(</span><span class="n">name_conversion_dict</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">name_conversion_dict</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;GUS&#39;: &#39;GUST&#39;, &#39;YR--MODAHRMN&#39;: &#39;TIME&#39;, &#39;SPD&#39;: &#39;SPEED&#39;}
&lt;class &#39;dict&#39;&gt;
</pre></div></div>
</div>
<p>From above we can see that we have successfully created a dictionary that is of type <code class="docutils literal notranslate"><span class="pre">dict</span></code>.</p>
<ul class="simple">
<li>Now we can change the column names by passing that dictionary into parameter <code class="docutils literal notranslate"><span class="pre">columns</span></code> in <code class="docutils literal notranslate"><span class="pre">rename()</span></code> -function.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Rename the columns</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">name_conversion_dict</span><span class="p">)</span>

<span class="c1"># Print the new columns</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;TIME&#39;, &#39;DIR&#39;, &#39;SPEED&#39;, &#39;GUST&#39;, &#39;TEMP&#39;, &#39;MAX&#39;, &#39;MIN&#39;], dtype=&#39;object&#39;)
</pre></div></div>
</div>
<p>Perfect, now our column names are more easy to understand and use.</p>
</div>
<div class="section" id="Reminder:-basic-calculations">
<h2>Reminder: basic calculations<a class="headerlink" href="#Reminder:-basic-calculations" title="Permalink to this headline">¶</a></h2>
<p>Let’s convert the wind speeds into meters per second values (m/s) as they are more familiar to us in Finland. This can be done with a formula <strong>``m/s = mph x 0.44704``</strong>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Convert speeds from miles to meters</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;SPEED&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;SPEED&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">0.44704</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;GUST&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;GUST&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">0.44704</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP</th>
      <th>MAX</th>
      <th>MIN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>201708040000</td>
      <td>114</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>58</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>201708040020</td>
      <td>100</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>201708040050</td>
      <td>100</td>
      <td>2.23520</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>201708040100</td>
      <td>123</td>
      <td>3.57632</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>201708040120</td>
      <td>110</td>
      <td>3.12928</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>201708040150</td>
      <td>100</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>61</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>201708040200</td>
      <td>138</td>
      <td>4.47040</td>
      <td>5.81152</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>201708040220</td>
      <td>120</td>
      <td>4.47040</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>201708040250</td>
      <td>100</td>
      <td>4.02336</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>201708040300</td>
      <td>108</td>
      <td>4.02336</td>
      <td>5.36448</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<ul class="simple">
<li>Let’s check some basic statistics to understand our data better.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
               TIME         DIR      SPEED       GUST       TEMP        MAX  \
count  7.200000e+01   72.000000  72.000000  20.000000  72.000000   2.000000
mean   2.017080e+11  229.555556   5.153378   7.912608  61.513889  66.500000
std    6.973834e+02  215.759248   1.679342   2.266045   3.175580   3.535534
min    2.017080e+11   80.000000   2.235200   4.917440  58.000000  64.000000
25%    2.017080e+11  117.750000   4.023360   5.811520  59.000000  65.250000
50%    2.017080e+11  200.000000   4.917440   7.152640  61.000000  66.500000
75%    2.017080e+11  220.000000   6.705600   9.946640  64.000000  67.750000
max    2.017080e+11  990.000000   8.940800  12.964160  69.000000  69.000000

             MIN
count   2.000000
mean   57.000000
std     1.414214
min    56.000000
25%    56.500000
50%    57.000000
75%    57.500000
max    58.000000
</pre></div></div>
</div>
<p>Okey so from here we can see that there are varying number of observations per column (see the <code class="docutils literal notranslate"><span class="pre">count</span></code> -information).</p>
<p>For example <code class="docutils literal notranslate"><span class="pre">SPD</span></code> and <code class="docutils literal notranslate"><span class="pre">TEMP</span></code> columns have 72 observations whereas <code class="docutils literal notranslate"><span class="pre">GUST</span></code> has only 20 observations and <code class="docutils literal notranslate"><span class="pre">MAX</span></code> and <code class="docutils literal notranslate"><span class="pre">MIN</span></code> have only 2 observations. From here we can already guess that <code class="docutils literal notranslate"><span class="pre">MAX</span></code> and <code class="docutils literal notranslate"><span class="pre">MIN</span></code> attributes are most probably not going to be useful for us. However, <code class="docutils literal notranslate"><span class="pre">GUST</span></code> might be.</p>
<ul class="simple">
<li>Let’s explore further our data by checking the first 30 rows of it.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
            TIME  DIR    SPEED      GUST  TEMP   MAX   MIN
0   201708040000  114  2.68224       NaN    58   NaN   NaN
1   201708040020  100  2.68224       NaN    59   NaN   NaN
2   201708040050  100  2.23520       NaN    59   NaN   NaN
3   201708040100  123  3.57632       NaN    59   NaN   NaN
4   201708040120  110  3.12928       NaN    59   NaN   NaN
5   201708040150  100  2.68224       NaN    61   NaN   NaN
6   201708040200  138  4.47040   5.81152    59   NaN   NaN
7   201708040220  120  4.47040       NaN    59   NaN   NaN
8   201708040250  100  4.02336       NaN    59   NaN   NaN
9   201708040300  108  4.02336   5.36448    59   NaN   NaN
10  201708040320   90  3.57632       NaN    59   NaN   NaN
11  201708040350   80  4.02336       NaN    59   NaN   NaN
12  201708040400  102  4.91744   6.70560    58   NaN   NaN
13  201708040420   80  4.47040       NaN    59   NaN   NaN
14  201708040450   80  4.47040       NaN    59   NaN   NaN
15  201708040500  119  5.36448   7.59968    58   NaN   NaN
16  201708040520  990  4.91744       NaN    59   NaN   NaN
17  201708040550  100  5.81152       NaN    59   NaN   NaN
18  201708040600  121  7.15264  10.28192    58  64.0  56.0
19  201708040620  110  6.70560       NaN    59   NaN   NaN
20  201708040650  100  6.70560       NaN    59   NaN   NaN
21  201708040700  119  6.25856   9.83488    58   NaN   NaN
22  201708040720  990  6.25856       NaN    59   NaN   NaN
23  201708040750  100  5.81152       NaN    59   NaN   NaN
24  201708040800  125  4.47040   6.70560    58   NaN   NaN
25  201708040820  990  4.02336       NaN    59   NaN   NaN
26  201708040850  100  3.12928       NaN    59   NaN   NaN
27  201708040900  107  3.57632       NaN    59   NaN   NaN
28  201708040920  990  3.12928       NaN    59   NaN   NaN
29  201708040950  990  2.68224       NaN    61   NaN   NaN
</pre></div></div>
</div>
<p>Okey, so from here we can actually see that the <strong>``GUST``</strong> column contains information only on an hourly level. That might be useful! Let’s keep this in mind.</p>
<p><strong>REMEMBER</strong>: Whenever starting a data analysis with new dataset, it is highly useful to explore the data by calculating basic statistics from the data.</p>
</div>
<div class="section" id="Using-your-own-functions-in-pandas">
<h2>Using your own functions in pandas<a class="headerlink" href="#Using-your-own-functions-in-pandas" title="Permalink to this headline">¶</a></h2>
<p>Now it’s again time to convert temperatures from Fahrenheit to Celsius! Yes, we have already done this many times before, but this time we will learn how to apply self-made functions to data in a pandas DataFrame. <strong>In short, our task is to define a function for the temperature conversion, and to apply this function for each Celsius value on each row of the DataFrame. Output celsius values should be stored in a new column called</strong> <code class="docutils literal notranslate"><span class="pre">TEMP_C</span></code>.</p>
<p>Knowing how to use your own function in pandas can be really useful when doing your own analyses. Here, we will introduce two different approaches for using function in pandas. First, we will see how we can apply the function row-by-row using a <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop and the <code class="docutils literal notranslate"><span class="pre">DataFrame.iterrows()</span></code>-method, and then we will learn how to apply the method to all rows at once using <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.apply.html">DataFrame.apply</a>.</p>
<p>For both of these approaches, we first need to define our temperature conversion function from Fahrenheit to Celsius:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">fahr_to_celsius</span><span class="p">(</span><span class="n">temp_fahrenheit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to convert Fahrenheit temperature into Celsius.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    temp_fahrenheit: int | float</span>
<span class="sd">        Input temperature in Fahrenheit (should be a number)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    Temperature in Celsius (float)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Convert the Fahrenheit into Celsius and return it</span>
    <span class="n">converted_temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_fahrenheit</span> <span class="o">-</span> <span class="mi">32</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.8</span>
    <span class="k">return</span> <span class="n">converted_temp</span>
</pre></div>
</div>
</div>
<p><strong>Note:</strong> with such a simple example, we could use the function direcly on a column in the DataFrame in order to conver the values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fahr_to_celsius</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP&quot;</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>201708040000</td>
      <td>114</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>58</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.444444</td>
    </tr>
    <tr>
      <th>1</th>
      <td>201708040020</td>
      <td>100</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>201708040050</td>
      <td>100</td>
      <td>2.23520</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>201708040100</td>
      <td>123</td>
      <td>3.57632</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>201708040120</td>
      <td>110</td>
      <td>3.12928</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>If we want to do something more complicated, we need to know how to apply the function row-by-row.</p>
<div class="section" id="Iterating-over-rows">
<h3>Iterating over rows<a class="headerlink" href="#Iterating-over-rows" title="Permalink to this headline">¶</a></h3>
<p>We can iterate over the rows of Pandas DataFrame by using the <code class="docutils literal notranslate"><span class="pre">iterrows()</span></code> -method and use the function one row at a time.</p>
<p>When iterating over the rows in our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, it is noteworthy to understand that the Pandas actually keeps track on the <code class="docutils literal notranslate"><span class="pre">index</span></code> value as well. Hence, the contents of a single row actually contains not only the values, but also the <code class="docutils literal notranslate"><span class="pre">index</span></code> of that row (each row is a pandas Series!).</p>
<ul class="simple">
<li>Let’s see how <code class="docutils literal notranslate"><span class="pre">iterrows()</span></code> works by printing out the <code class="docutils literal notranslate"><span class="pre">TEMP</span></code> value on each row using a <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Iterate over the rows</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Print the index value</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Index:&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>

    <span class="c1"># Print the row</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Temp F:&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;TEMP&quot;</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index: 0
Temp F: 58.0

</pre></div></div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>break</strong></p>
<p>When developing a for-loop, you don’t always need to go trough the whole loop if you just want to test things out. <a class="reference external" href="https://www.tutorialspoint.com/python/python_break_statement.htm">break</a> statement in Python terminates the current loop after the first iteration and we used it here just to test check out the values on the first row.</p>
</div>
<p>We can see that the <code class="docutils literal notranslate"><span class="pre">idx</span></code> variable indeed contains the index value at position 0 (the first row) and the <code class="docutils literal notranslate"><span class="pre">row</span></code> variable contains all the data from that given row stored as a pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<ul class="simple">
<li>Let’s now create an empty column <code class="docutils literal notranslate"><span class="pre">TEMP_C</span></code> for the Celsius temperatures and update the values into that column using the <code class="docutils literal notranslate"><span class="pre">fahr_to_celsius</span></code> function we defined earlier:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty column for the DataFrame where the values will be stored</span>
<span class="n">new_column</span> <span class="o">=</span> <span class="s2">&quot;TEMP_C&quot;</span>
<span class="n">data</span><span class="p">[</span><span class="n">new_column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c1"># Iterate over the rows</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Convert the Fahrenheit to Celsius</span>
    <span class="n">celsius</span> <span class="o">=</span> <span class="n">fahr_to_celsius</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">])</span>

    <span class="c1"># Update the value of &#39;Celsius&#39; column with the converted value</span>
    <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">new_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">celsius</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>.at or .loc</strong></p>
<p>Here, you could also use <code class="docutils literal notranslate"><span class="pre">data.loc[idx,</span> <span class="pre">new_column]</span> <span class="pre">=</span> <span class="pre">celsius</span></code> to achieve the same result.</p>
</div>
<ul class="simple">
<li>Let’s see what we have now.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>201708040000</td>
      <td>114</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>58</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.4444</td>
    </tr>
    <tr>
      <th>1</th>
      <td>201708040020</td>
      <td>100</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>201708040050</td>
      <td>100</td>
      <td>2.23520</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>201708040100</td>
      <td>123</td>
      <td>3.57632</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>201708040120</td>
      <td>110</td>
      <td>3.12928</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>201708040150</td>
      <td>100</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>61</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.1111</td>
    </tr>
    <tr>
      <th>6</th>
      <td>201708040200</td>
      <td>138</td>
      <td>4.47040</td>
      <td>5.81152</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>201708040220</td>
      <td>120</td>
      <td>4.47040</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15</td>
    </tr>
    <tr>
      <th>8</th>
      <td>201708040250</td>
      <td>100</td>
      <td>4.02336</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15</td>
    </tr>
    <tr>
      <th>9</th>
      <td>201708040300</td>
      <td>108</td>
      <td>4.02336</td>
      <td>5.36448</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Great! Now we have converted our temperatures into Celsius by using our self-made function.</p>
</div>
<div class="section" id="Applying-a-function">
<h3>Applying a function<a class="headerlink" href="#Applying-a-function" title="Permalink to this headline">¶</a></h3>
<p>Pandas DataFrames and Series also have a dedicated method <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> for applying functions on columns (or rows!). When using <code class="docutils literal notranslate"><span class="pre">.apply()</span></code>, we pass the function name (without parenthesis!) as an argument:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">fahr_to_celsius</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>201708040000</td>
      <td>114</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>58</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.444444</td>
    </tr>
    <tr>
      <th>1</th>
      <td>201708040020</td>
      <td>100</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>201708040050</td>
      <td>100</td>
      <td>2.23520</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>201708040100</td>
      <td>123</td>
      <td>3.57632</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>201708040120</td>
      <td>110</td>
      <td>3.12928</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Note:</strong> pay attention which column you are applying the function on! Running this code: <code class="docutils literal notranslate"><span class="pre">data.apply(fahr_to_celsius)</span></code> would not give an error, but the results also don’t make much sense.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Should I use .iterrows() or .apply()?</strong></p>
<p>We are teaching the <code class="docutils literal notranslate"><span class="pre">.iterrows()</span></code> method because it helps to understand the structure of a DataFrame and the process of looping trough DataFrame rows. However, using <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> is often more efficient in terms of execution time.</p>
<p>At this point, the most important thing is that you understand what happens when you are modifying the values in a pandas DataFrame. When doing the course exercises, either of these approaches is ok!</p>
</div>
</div>
</div>
<div class="section" id="String-manipulation-in-Pandas">
<h2>String manipulation in Pandas<a class="headerlink" href="#String-manipulation-in-Pandas" title="Permalink to this headline">¶</a></h2>
<p>Let’s pay attention to columns <code class="docutils literal notranslate"><span class="pre">TIME</span></code>, <code class="docutils literal notranslate"><span class="pre">GUST</span></code>, <code class="docutils literal notranslate"><span class="pre">SPEED</span></code> and <code class="docutils literal notranslate"><span class="pre">TEMP</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>201708040000</td>
      <td>114</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>58</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.444444</td>
    </tr>
    <tr>
      <th>1</th>
      <td>201708040020</td>
      <td>100</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>201708040050</td>
      <td>100</td>
      <td>2.23520</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>201708040100</td>
      <td>123</td>
      <td>3.57632</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>201708040120</td>
      <td>110</td>
      <td>3.12928</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>201708040150</td>
      <td>100</td>
      <td>2.68224</td>
      <td>NaN</td>
      <td>61</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.111111</td>
    </tr>
    <tr>
      <th>6</th>
      <td>201708040200</td>
      <td>138</td>
      <td>4.47040</td>
      <td>5.81152</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>201708040220</td>
      <td>120</td>
      <td>4.47040</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>201708040250</td>
      <td>100</td>
      <td>4.02336</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>201708040300</td>
      <td>108</td>
      <td>4.02336</td>
      <td>5.36448</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>201708040320</td>
      <td>90</td>
      <td>3.57632</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>201708040350</td>
      <td>80</td>
      <td>4.02336</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>201708040400</td>
      <td>102</td>
      <td>4.91744</td>
      <td>6.70560</td>
      <td>58</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.444444</td>
    </tr>
    <tr>
      <th>13</th>
      <td>201708040420</td>
      <td>80</td>
      <td>4.47040</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>201708040450</td>
      <td>80</td>
      <td>4.47040</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>201708040500</td>
      <td>119</td>
      <td>5.36448</td>
      <td>7.59968</td>
      <td>58</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.444444</td>
    </tr>
    <tr>
      <th>16</th>
      <td>201708040520</td>
      <td>990</td>
      <td>4.91744</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>17</th>
      <td>201708040550</td>
      <td>100</td>
      <td>5.81152</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>18</th>
      <td>201708040600</td>
      <td>121</td>
      <td>7.15264</td>
      <td>10.28192</td>
      <td>58</td>
      <td>64.0</td>
      <td>56.0</td>
      <td>14.444444</td>
    </tr>
    <tr>
      <th>19</th>
      <td>201708040620</td>
      <td>110</td>
      <td>6.70560</td>
      <td>NaN</td>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Check also the column data types:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>TIME        int64
DIR         int64
SPEED     float64
GUST      float64
TEMP        int64
MAX       float64
MIN       float64
TEMP_C    float64
dtype: object
</pre></div>
</div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">TIME</span></code>column contains several timestamps per hour</li>
<li><code class="docutils literal notranslate"><span class="pre">GUST</span></code> seems to be measured only once an hour</li>
<li><code class="docutils literal notranslate"><span class="pre">SPEED</span></code> (wind speed), and <code class="docutils literal notranslate"><span class="pre">TEMP</span></code> seem to be measured every 20 minutes (at minutes XX:00, XX:20 and XX:50).</li>
</ul>
<p>The difference between the time intervals might be a problem as we might not be able to compare e.g. the average wind speeds and the speeds during the gust together as they are measured with different intervals. This kind of mismatch between sampling rates of measurements is actually quite typical when working with real data.</p>
<p>We can solve this issue by <strong>aggregating the wind speeds into hourly data</strong> so that the attributes become comparable. First we need to be able to group the values by hour. Let’s have a look how we can achieve this using the values in the <code class="docutils literal notranslate"><span class="pre">TIME</span></code> column.</p>
<p>Remember, that the original name of the <code class="docutils literal notranslate"><span class="pre">TIME</span></code> column was <code class="docutils literal notranslate"><span class="pre">'YR--MODAHRMN'</span></code>. Based on this information, the first observation in our data set <code class="docutils literal notranslate"><span class="pre">201708040000</span></code> is from 4th of August 2017 at 00:00. There is a systematic pattern in the character string values stored in the <code class="docutils literal notranslate"><span class="pre">TIME</span></code> column, and we can retrieve the information about date+hour by slicing the values in the <strong>``TIME``</strong> -column (i.e. removing the minutes from the end of the value).</p>
<p>Doing this requires two steps: 1. Convert the <code class="docutils literal notranslate"><span class="pre">TIME</span></code> column from <code class="docutils literal notranslate"><span class="pre">int</span></code> into <code class="docutils literal notranslate"><span class="pre">str</span></code> datatype. 2. Include only numbers up to hourly accuracy (exclude minutes) by slicing texts</p>
<ul class="simple">
<li>Let’s convert the time into string. And check that the data type changes:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Convert to string</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1"># Check data types</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Data type of the column:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data type of the first value in column:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;TIME_STR&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Data type of the column:
object

Data type of the first value in column:
&lt;class &#39;str&#39;&gt;
</pre></div></div>
</div>
<p>Okey it seems that now we indeed have the <code class="docutils literal notranslate"><span class="pre">TIME</span></code> as <code class="docutils literal notranslate"><span class="pre">str</span></code> datatype as well.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>String functions</strong></p>
<p><strong>Note:</strong> All the typical <code class="docutils literal notranslate"><span class="pre">str</span></code> functionalities can be applied to Series of text data with syntax <code class="docutils literal notranslate"><span class="pre">data['mySeries'].str.&lt;functionToUse&gt;()</span></code>.</p>
</div>
<ul class="simple">
<li>Now we can extract information about day and hour by including only 10 first characters from the text (i.e. excluding the minute-level information).</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># SLice the string</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_DH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           TIME  DIR    SPEED  GUST  TEMP  MAX  MIN     TEMP_C      TIME_STR  \
0  201708040000  114  2.68224   NaN    58  NaN  NaN  14.444444  201708040000
1  201708040020  100  2.68224   NaN    59  NaN  NaN  15.000000  201708040020
2  201708040050  100  2.23520   NaN    59  NaN  NaN  15.000000  201708040050
3  201708040100  123  3.57632   NaN    59  NaN  NaN  15.000000  201708040100
4  201708040120  110  3.12928   NaN    59  NaN  NaN  15.000000  201708040120

      TIME_DH
0  2017080400
1  2017080400
2  2017080400
3  2017080401
4  2017080401
</pre></div></div>
</div>
<p>Nice! Now we have “labeled” the rows based on information about day of the year and hour of the day.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>TASK:</strong></p>
<ul class="simple">
<li>Create a new column <code class="docutils literal notranslate"><span class="pre">TIME_H</span></code> which contains the hour of each row as an integer value. For example, the hour for the first row is <code class="docutils literal notranslate"><span class="pre">0</span></code>.</li>
</ul>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Slice the string to parse the hour from &#39;TIME_str&#39; column</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Convert the hour text into integer format</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_H&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           TIME  DIR    SPEED  GUST  TEMP  MAX  MIN     TEMP_C      TIME_STR  \
0  201708040000  114  2.68224   NaN    58  NaN  NaN  14.444444  201708040000
1  201708040020  100  2.68224   NaN    59  NaN  NaN  15.000000  201708040020
2  201708040050  100  2.23520   NaN    59  NaN  NaN  15.000000  201708040050
3  201708040100  123  3.57632   NaN    59  NaN  NaN  15.000000  201708040100
4  201708040120  110  3.12928   NaN    59  NaN  NaN  15.000000  201708040120

      TIME_DH  TIME_H
0  2017080400       0
1  2017080400       0
2  2017080400       0
3  2017080401       1
4  2017080401       1
</pre></div></div>
</div>
</div>
<div class="section" id="Aggregating-data-in-Pandas-by-grouping">
<h2>Aggregating data in Pandas by grouping<a class="headerlink" href="#Aggregating-data-in-Pandas-by-grouping" title="Permalink to this headline">¶</a></h2>
<p>Next we want to calculate the average temperatures, wind speeds, etc. on an hourly basis to enable us to compare all of them to each other.</p>
<p>This can be done by aggregating the data, i.e.:</p>
<ol class="arabic simple">
<li><strong>grouping the data</strong> based on hourly values</li>
<li>Iterating over those groups and calculating the average values of our attributes</li>
<li>Inserting those values into <strong>a new DataFrame</strong> where we store the aggregated data</li>
</ol>
<p><strong>–&gt; our input data has 3 rows per hour, the aggregated data frame should only have 1 row per hour!</strong></p>
<ul class="simple">
<li>Let’s first create a new <strong>empty</strong> DataFrame where we will store our aggregated data</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create a new empty DataFrame</span>
<span class="n">hourly_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Let’s then <strong>group</strong> our data based on <code class="docutils literal notranslate"><span class="pre">TIME_DH</span></code> attribute that contains the information about the date + hour.</p>
<ul class="simple">
<li>First, check how many unique values the <code class="docutils literal notranslate"><span class="pre">TIME_DH</span></code> column has using the <code class="docutils literal notranslate"><span class="pre">.nunique()</span></code> method:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of rows&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of unique day + hour combinations:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME_DH&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of rows 72
Number of unique day + hour combinations: 24
</pre></div></div>
</div>
<p>Indeed, we are currently dealing with data from one day, 3 observations per hour!</p>
<ul class="simple">
<li>Now, group the data based on <code class="docutils literal notranslate"><span class="pre">TIME_DH</span></code> column:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Group the data</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;TIME_DH&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>Let’s see what we have now.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># What is the type?</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Type:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">grouped</span><span class="p">))</span>

<span class="c1"># How many?</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Length:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">grouped</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Type:
 &lt;class &#39;pandas.core.groupby.groupby.DataFrameGroupBy&#39;&gt;
Length:
 24
</pre></div></div>
</div>
<p>Okey, interesting. Now we have a new object with type <strong>``DataFrameGroupBy``</strong>. And it seems that we have 24 individual groups in our data, i.e. <strong>one group for each hour of the day</strong>.</p>
<p>There are several methods we can use for extracting information from the grouped data. See <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/groupby.html">documentation for Pandas GroupBy objects</a> for a comprehensive overview.</p>
<p><strong>Checking group names:</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Check the &quot;names&quot; of each group</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>dict_keys([&#39;2017080417&#39;, &#39;2017080422&#39;, &#39;2017080421&#39;, &#39;2017080400&#39;, &#39;2017080408&#39;, &#39;2017080423&#39;, &#39;2017080412&#39;, &#39;2017080419&#39;, &#39;2017080418&#39;, &#39;2017080409&#39;, &#39;2017080407&#39;, &#39;2017080405&#39;, &#39;2017080411&#39;, &#39;2017080415&#39;, &#39;2017080401&#39;, &#39;2017080420&#39;, &#39;2017080404&#39;, &#39;2017080410&#39;, &#39;2017080402&#39;, &#39;2017080413&#39;, &#39;2017080416&#39;, &#39;2017080414&#39;, &#39;2017080406&#39;, &#39;2017080403&#39;])
</pre></div>
</div>
</div>
<p><strong>Accessing data for one group:</strong></p>
<p>As you might have noticed earlier, the first hour in hour data is <code class="docutils literal notranslate"><span class="pre">2017080400</span></code> (midnight at 4th of August in 2017).</p>
<ul class="simple">
<li>Let’s check the contents of the group named <code class="docutils literal notranslate"><span class="pre">2017080400</span></code>. We can get the values of that hour from the grouped object using the <code class="docutils literal notranslate"><span class="pre">get_group()</span></code> -method:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specify the time of the first hour (as text)</span>
<span class="n">time1</span> <span class="o">=</span> <span class="s1">&#39;2017080400&#39;</span>

<span class="c1"># Select the group</span>
<span class="n">group1</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">time1</span><span class="p">)</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">group1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           TIME  DIR    SPEED  GUST  TEMP  MAX  MIN     TEMP_C      TIME_STR  \
0  201708040000  114  2.68224   NaN    58  NaN  NaN  14.444444  201708040000
1  201708040020  100  2.68224   NaN    59  NaN  NaN  15.000000  201708040020
2  201708040050  100  2.23520   NaN    59  NaN  NaN  15.000000  201708040050

      TIME_DH  TIME_H
0  2017080400       0
1  2017080400       0
2  2017080400       0
</pre></div></div>
</div>
<p>Ahaa! As we can see, a single group contains a <strong>DataFrame</strong> with values only for that specific hour. Let’s check the DataType of this group:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">type</span><span class="p">(</span><span class="n">group1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
<p>So, one group is a pandas DataFrame! This is really useful, because we can now use all the familiar DataFrame methods for calculating statistics etc for this spesific group. We can, for example, calculate the average values for all variables using the statistical functions that we have seen already (e.g. mean, std, min, max, median, etc.).</p>
<p>We can do that by using the <code class="docutils literal notranslate"><span class="pre">mean()</span></code> -function that we already used during the Lesson 5.</p>
<ul class="simple">
<li>Let’s calculate the mean for following attributes all at once:</li>
<li><code class="docutils literal notranslate"><span class="pre">DIR</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">SPEED</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">GUST</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">TEMP</span></code>,</li>
<li><code class="docutils literal notranslate"><span class="pre">TEMP_C</span></code></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Specify the columns that will be part of the calculation</span>
<span class="n">mean_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">]</span>

<span class="c1"># Calculate the mean values all at one go</span>
<span class="n">mean_values</span> <span class="o">=</span> <span class="n">group1</span><span class="p">[</span><span class="n">mean_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">mean_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DIR       104.666667
SPEED       2.533227
GUST             NaN
TEMP       58.666667
TEMP_C     14.814815
dtype: float64
</pre></div></div>
</div>
<p>Nice, now we have averaged our data and e.g. the mean Celsius temperature seems to be about right when comparing to the original values above.</p>
<p>The last thing to do is to add these mean values into our DataFrame that we created. That can be done with <code class="docutils literal notranslate"><span class="pre">append()</span></code> -function in a quite similar manner as with Python lists. In Pandas the data insertion is not done <strong>inplace</strong> (as when appending to Python lists) so we need to specify that we are updating the aggr_data (using the <strong>``=``</strong> sign). We also need to specify that we ignore the index values of our original DataFrame (i.e. the indices of <code class="docutils literal notranslate"><span class="pre">mean_values</span></code>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Add the values into our aggr_data DataFrame that we created in the beginning</span>
<span class="n">hourly_data</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_values</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">hourly_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          DIR  GUST     SPEED       TEMP     TEMP_C
0  104.666667   NaN  2.533227  58.666667  14.814815
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mean_values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>DIR       104.666667
SPEED       2.533227
GUST             NaN
TEMP       58.666667
TEMP_C     14.814815
dtype: float64
</pre></div>
</div>
</div>
<p>As we can see, now we have a single row in our new DataFrame where we have aggregated the data based on hourly mean values. Next we could continue doing and insert the average values from other hours in a similar manner but, of course, that is not something that we want to do manually (would require repeating these same steps too many times). Luckily, we can actually iterate over all the groups that we have in our data and do these steps using a <strong>``for``</strong> -loop.</p>
<p>When iterating over the groups in our <strong>``DataFrameGroupBy``</strong> -object it is important to understand that a single group in our <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> actually contains not only the actual values, but also information about the <strong>``key``</strong> that was used to do the grouping. Hence, when iterating over the data we need to assign the <code class="docutils literal notranslate"><span class="pre">key</span></code> and the values into separate variables.</p>
<ul class="simple">
<li>Let’s see how we can iterate over the groups and print the key and the data from a single group (again using <strong>``break``</strong> to only see what is happening).</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Iterate over groups</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="c1"># Print key and group</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Key:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Group:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>

    <span class="c1"># Stop iteration with break command</span>
    <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Key:
 2017080400

Group:
            TIME  DIR    SPEED  GUST  TEMP  MAX  MIN     TEMP_C      TIME_STR  \
0  201708040000  114  2.68224   NaN    58  NaN  NaN  14.444444  201708040000
1  201708040020  100  2.68224   NaN    59  NaN  NaN  15.000000  201708040020
2  201708040050  100  2.23520   NaN    59  NaN  NaN  15.000000  201708040050

      TIME_DH  TIME_H
0  2017080400       0
1  2017080400       0
2  2017080400       0
</pre></div></div>
</div>
<p>Okey so from here we can see that the <strong>``key``</strong> contains the value <strong>``2017080400``</strong> that is the same as the values in <strong>``TIME_dh``</strong> column. Meaning that we, indeed, grouped the values based on that column.</p>
<ul class="simple">
<li>Let’s see how we can create a DataFrame where we calculate the mean values for all those weather attributes that we were interested in. I will repeate slightly the earlier steps so that you can see and better understand what is happening.</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty DataFrame for the aggregated values</span>
<span class="n">hourly_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># The columns that we want to aggregate</span>
<span class="n">mean_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">]</span>

<span class="c1"># Iterate over the groups</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
   <span class="c1"># Aggregate the data</span>
   <span class="n">mean_values</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="n">mean_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

   <span class="c1"># Add the ´key´ (i.e. the date+time information) into the aggregated values</span>
   <span class="n">mean_values</span><span class="p">[</span><span class="s1">&#39;TIME_DH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

   <span class="c1"># Append the aggregated values into the DataFrame</span>
   <span class="n">hourly_data</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_values</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li>Let’s see what we have now:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">hourly_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           DIR      GUST     SPEED       TEMP     TEMP_C     TIME_DH
0   104.666667       NaN  2.533227  58.666667  14.814815  2017080400
1   111.000000       NaN  3.129280  59.666667  15.370370  2017080401
2   119.333333   5.81152  4.321387  59.000000  15.000000  2017080402
3    92.666667   5.36448  3.874347  59.000000  15.000000  2017080403
4    87.333333   6.70560  4.619413  58.666667  14.814815  2017080404
5   403.000000   7.59968  5.364480  58.666667  14.814815  2017080405
6   110.333333  10.28192  6.854613  58.666667  14.814815  2017080406
7   403.000000   9.83488  6.109547  58.666667  14.814815  2017080407
8   405.000000   6.70560  3.874347  58.666667  14.814815  2017080408
9   695.666667       NaN  3.129280  59.666667  15.370370  2017080409
10  225.000000   5.81152  4.768427  61.666667  16.481481  2017080410
11  241.666667   8.49376  5.513493  64.000000  17.777778  2017080411
12  228.333333   6.70560  5.960533  66.000000  18.888889  2017080412
13  229.666667   8.94080  7.152640  67.333333  19.629630  2017080413
14  228.666667  12.96416  8.940800  68.333333  20.185185  2017080414
15  218.333333  10.72896  7.450667  66.333333  19.074074  2017080415
16  214.666667  10.28192  7.152640  65.666667  18.703704  2017080416
17  209.666667   8.94080  7.003627  63.666667  17.592593  2017080417
18  211.333333  10.28192  5.662507  62.333333  16.851852  2017080418
19  203.000000   5.81152  4.023360  61.000000  16.111111  2017080419
20  198.000000   5.36448  4.023360  60.666667  15.925926  2017080420
21  186.666667       NaN  3.874347  60.666667  15.925926  2017080421
22  189.000000   6.70560  4.619413  60.000000  15.555556  2017080422
23  193.333333   4.91744  3.725333  59.333333  15.185185  2017080423
</pre></div></div>
</div>
<p>Awesome! Now we have aggregated our data based on daily averages and we have a new DataFrame called <code class="docutils literal notranslate"><span class="pre">hourly_data</span></code> where all those aggregated values are stored.</p>
<p><strong>Shortcut: Mean for all groups</strong></p>
<p>We can also achieve the same result by computing the mean of all columns for all groups in the grouped object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
      <th>TIME_H</th>
    </tr>
    <tr>
      <th>TIME_DH</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017080400</th>
      <td>2.017080e+11</td>
      <td>104.666667</td>
      <td>2.533227</td>
      <td>NaN</td>
      <td>58.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.814815</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017080401</th>
      <td>2.017080e+11</td>
      <td>111.000000</td>
      <td>3.129280</td>
      <td>NaN</td>
      <td>59.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.370370</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2017080402</th>
      <td>2.017080e+11</td>
      <td>119.333333</td>
      <td>4.321387</td>
      <td>5.81152</td>
      <td>59.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2017080403</th>
      <td>2.017080e+11</td>
      <td>92.666667</td>
      <td>3.874347</td>
      <td>5.36448</td>
      <td>59.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2017080404</th>
      <td>2.017080e+11</td>
      <td>87.333333</td>
      <td>4.619413</td>
      <td>6.70560</td>
      <td>58.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.814815</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2017080405</th>
      <td>2.017080e+11</td>
      <td>403.000000</td>
      <td>5.364480</td>
      <td>7.59968</td>
      <td>58.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.814815</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2017080406</th>
      <td>2.017080e+11</td>
      <td>110.333333</td>
      <td>6.854613</td>
      <td>10.28192</td>
      <td>58.666667</td>
      <td>64.0</td>
      <td>56.0</td>
      <td>14.814815</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2017080407</th>
      <td>2.017080e+11</td>
      <td>403.000000</td>
      <td>6.109547</td>
      <td>9.83488</td>
      <td>58.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.814815</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2017080408</th>
      <td>2.017080e+11</td>
      <td>405.000000</td>
      <td>3.874347</td>
      <td>6.70560</td>
      <td>58.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.814815</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2017080409</th>
      <td>2.017080e+11</td>
      <td>695.666667</td>
      <td>3.129280</td>
      <td>NaN</td>
      <td>59.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.370370</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2017080410</th>
      <td>2.017080e+11</td>
      <td>225.000000</td>
      <td>4.768427</td>
      <td>5.81152</td>
      <td>61.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.481481</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2017080411</th>
      <td>2.017080e+11</td>
      <td>241.666667</td>
      <td>5.513493</td>
      <td>8.49376</td>
      <td>64.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.777778</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2017080412</th>
      <td>2.017080e+11</td>
      <td>228.333333</td>
      <td>5.960533</td>
      <td>6.70560</td>
      <td>66.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.888889</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2017080413</th>
      <td>2.017080e+11</td>
      <td>229.666667</td>
      <td>7.152640</td>
      <td>8.94080</td>
      <td>67.333333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.629630</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2017080414</th>
      <td>2.017080e+11</td>
      <td>228.666667</td>
      <td>8.940800</td>
      <td>12.96416</td>
      <td>68.333333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20.185185</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2017080415</th>
      <td>2.017080e+11</td>
      <td>218.333333</td>
      <td>7.450667</td>
      <td>10.72896</td>
      <td>66.333333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.074074</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2017080416</th>
      <td>2.017080e+11</td>
      <td>214.666667</td>
      <td>7.152640</td>
      <td>10.28192</td>
      <td>65.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.703704</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2017080417</th>
      <td>2.017080e+11</td>
      <td>209.666667</td>
      <td>7.003627</td>
      <td>8.94080</td>
      <td>63.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.592593</td>
      <td>17</td>
    </tr>
    <tr>
      <th>2017080418</th>
      <td>2.017080e+11</td>
      <td>211.333333</td>
      <td>5.662507</td>
      <td>10.28192</td>
      <td>62.333333</td>
      <td>69.0</td>
      <td>58.0</td>
      <td>16.851852</td>
      <td>18</td>
    </tr>
    <tr>
      <th>2017080419</th>
      <td>2.017080e+11</td>
      <td>203.000000</td>
      <td>4.023360</td>
      <td>5.81152</td>
      <td>61.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.111111</td>
      <td>19</td>
    </tr>
    <tr>
      <th>2017080420</th>
      <td>2.017080e+11</td>
      <td>198.000000</td>
      <td>4.023360</td>
      <td>5.36448</td>
      <td>60.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.925926</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2017080421</th>
      <td>2.017080e+11</td>
      <td>186.666667</td>
      <td>3.874347</td>
      <td>NaN</td>
      <td>60.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.925926</td>
      <td>21</td>
    </tr>
    <tr>
      <th>2017080422</th>
      <td>2.017080e+11</td>
      <td>189.000000</td>
      <td>4.619413</td>
      <td>6.70560</td>
      <td>60.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.555556</td>
      <td>22</td>
    </tr>
    <tr>
      <th>2017080423</th>
      <td>2.017080e+11</td>
      <td>193.333333</td>
      <td>3.725333</td>
      <td>4.91744</td>
      <td>59.333333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.185185</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Extra:-datetime">
<h2>Extra: datetime<a class="headerlink" href="#Extra:-datetime" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Pandas datetime</strong></p>
<p>So far, we have been operating with time using integers and character strings. Python (and pandas) come with more advanced approaches for handling dates and times. In pandas, we can convert dates and times into a new data type <a class="reference external" href="https://docs.python.org/3.7/library/datetime.html">datetime</a> using <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html">pandas.to_datetime</a> function. First, it is important to understand the structure of the input data in order to
avoid erroneous conversions, and that’s why we first focus on string slicing before introducing the datetime functionalities.</p>
<p>Here is one example of how to convert the <code class="docutils literal notranslate"><span class="pre">TIME_STR</span></code>-column in our data set to datetime:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME_STR&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H&#39;</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">format</span></code> defines the output datetime format according to strftime(format) method: <a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior">https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior</a>. <code class="docutils literal notranslate"><span class="pre">exact=False</span></code> drops out minutes and secods, because they are not included in the specified formatting.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Convert to datetime</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TIME_STR&quot;</span><span class="p">],</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H&#39;</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;DATE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0   2017-08-04 00:00:00
1   2017-08-04 00:00:00
2   2017-08-04 00:00:00
3   2017-08-04 01:00:00
4   2017-08-04 01:00:00
Name: DATE, dtype: datetime64[ns]
</pre></div>
</div>
</div>
<p>Note: in this case, the data type of the values is <code class="docutils literal notranslate"><span class="pre">datetime</span></code>.</p>
<p>Furthermore, we could group the data based on the new datetime column and retrieve the mean values for each column:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;DATE&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TIME</th>
      <th>DIR</th>
      <th>SPEED</th>
      <th>GUST</th>
      <th>TEMP</th>
      <th>MAX</th>
      <th>MIN</th>
      <th>TEMP_C</th>
      <th>TIME_H</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-08-04 00:00:00</th>
      <td>2.017080e+11</td>
      <td>104.666667</td>
      <td>2.533227</td>
      <td>NaN</td>
      <td>58.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.814815</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2017-08-04 01:00:00</th>
      <td>2.017080e+11</td>
      <td>111.000000</td>
      <td>3.129280</td>
      <td>NaN</td>
      <td>59.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.370370</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2017-08-04 02:00:00</th>
      <td>2.017080e+11</td>
      <td>119.333333</td>
      <td>4.321387</td>
      <td>5.81152</td>
      <td>59.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2017-08-04 03:00:00</th>
      <td>2.017080e+11</td>
      <td>92.666667</td>
      <td>3.874347</td>
      <td>5.36448</td>
      <td>59.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.000000</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2017-08-04 04:00:00</th>
      <td>2.017080e+11</td>
      <td>87.333333</td>
      <td>4.619413</td>
      <td>6.70560</td>
      <td>58.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.814815</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2017-08-04 05:00:00</th>
      <td>2.017080e+11</td>
      <td>403.000000</td>
      <td>5.364480</td>
      <td>7.59968</td>
      <td>58.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.814815</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2017-08-04 06:00:00</th>
      <td>2.017080e+11</td>
      <td>110.333333</td>
      <td>6.854613</td>
      <td>10.28192</td>
      <td>58.666667</td>
      <td>64.0</td>
      <td>56.0</td>
      <td>14.814815</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2017-08-04 07:00:00</th>
      <td>2.017080e+11</td>
      <td>403.000000</td>
      <td>6.109547</td>
      <td>9.83488</td>
      <td>58.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.814815</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2017-08-04 08:00:00</th>
      <td>2.017080e+11</td>
      <td>405.000000</td>
      <td>3.874347</td>
      <td>6.70560</td>
      <td>58.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.814815</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2017-08-04 09:00:00</th>
      <td>2.017080e+11</td>
      <td>695.666667</td>
      <td>3.129280</td>
      <td>NaN</td>
      <td>59.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.370370</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2017-08-04 10:00:00</th>
      <td>2.017080e+11</td>
      <td>225.000000</td>
      <td>4.768427</td>
      <td>5.81152</td>
      <td>61.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.481481</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2017-08-04 11:00:00</th>
      <td>2.017080e+11</td>
      <td>241.666667</td>
      <td>5.513493</td>
      <td>8.49376</td>
      <td>64.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.777778</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2017-08-04 12:00:00</th>
      <td>2.017080e+11</td>
      <td>228.333333</td>
      <td>5.960533</td>
      <td>6.70560</td>
      <td>66.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.888889</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2017-08-04 13:00:00</th>
      <td>2.017080e+11</td>
      <td>229.666667</td>
      <td>7.152640</td>
      <td>8.94080</td>
      <td>67.333333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.629630</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2017-08-04 14:00:00</th>
      <td>2.017080e+11</td>
      <td>228.666667</td>
      <td>8.940800</td>
      <td>12.96416</td>
      <td>68.333333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20.185185</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2017-08-04 15:00:00</th>
      <td>2.017080e+11</td>
      <td>218.333333</td>
      <td>7.450667</td>
      <td>10.72896</td>
      <td>66.333333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.074074</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2017-08-04 16:00:00</th>
      <td>2.017080e+11</td>
      <td>214.666667</td>
      <td>7.152640</td>
      <td>10.28192</td>
      <td>65.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.703704</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2017-08-04 17:00:00</th>
      <td>2.017080e+11</td>
      <td>209.666667</td>
      <td>7.003627</td>
      <td>8.94080</td>
      <td>63.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.592593</td>
      <td>17</td>
    </tr>
    <tr>
      <th>2017-08-04 18:00:00</th>
      <td>2.017080e+11</td>
      <td>211.333333</td>
      <td>5.662507</td>
      <td>10.28192</td>
      <td>62.333333</td>
      <td>69.0</td>
      <td>58.0</td>
      <td>16.851852</td>
      <td>18</td>
    </tr>
    <tr>
      <th>2017-08-04 19:00:00</th>
      <td>2.017080e+11</td>
      <td>203.000000</td>
      <td>4.023360</td>
      <td>5.81152</td>
      <td>61.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.111111</td>
      <td>19</td>
    </tr>
    <tr>
      <th>2017-08-04 20:00:00</th>
      <td>2.017080e+11</td>
      <td>198.000000</td>
      <td>4.023360</td>
      <td>5.36448</td>
      <td>60.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.925926</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2017-08-04 21:00:00</th>
      <td>2.017080e+11</td>
      <td>186.666667</td>
      <td>3.874347</td>
      <td>NaN</td>
      <td>60.666667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.925926</td>
      <td>21</td>
    </tr>
    <tr>
      <th>2017-08-04 22:00:00</th>
      <td>2.017080e+11</td>
      <td>189.000000</td>
      <td>4.619413</td>
      <td>6.70560</td>
      <td>60.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.555556</td>
      <td>22</td>
    </tr>
    <tr>
      <th>2017-08-04 23:00:00</th>
      <td>2.017080e+11</td>
      <td>193.333333</td>
      <td>3.725333</td>
      <td>4.91744</td>
      <td>59.333333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.185185</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>This should be the same result we achieved earlier based on string slicing!</p>
</div>
<div class="section" id="Finding-outliers-from-the-data">
<h2>Finding outliers from the data<a class="headerlink" href="#Finding-outliers-from-the-data" title="Permalink to this headline">¶</a></h2>
<p>Finally, we are ready to do some real data analytics and check whether we are able to find out if there are any outliers in our data suggesting to have a storm (meaning strong winds in this case).</p>
<p>Here, we define an outlier if the <strong>wind speed is 2 times the standard deviation higher than the average wind speed</strong> (column <code class="docutils literal notranslate"><span class="pre">SPEED</span></code>).</p>
<ul class="simple">
<li>Let’s first find out what is the standard deviation and the mean of the Wind speed.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate standard deviation and average wind speed</span>
<span class="n">std_wind</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;SPEED&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">avg_wind</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;SPEED&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Std:&#39;</span><span class="p">,</span> <span class="n">std_wind</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">avg_wind</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Std: 1.6405694308360985
Mean: 5.153377777777777
</pre></div></div>
</div>
<p>Okey, so the variance in the windspeed tend to be approximately 1.6 meters per second, and the wind speed is approximately 5.2 m/s.</p>
<ul class="simple">
<li>Hence, the threshold for a wind speed to be an outlier with our criteria is:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate the upper threshold for an outlier</span>
<span class="n">upper_threshold</span> <span class="o">=</span> <span class="n">avg_wind</span> <span class="o">+</span> <span class="p">(</span><span class="n">std_wind</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Upper threshold for outlier:&#39;</span><span class="p">,</span> <span class="n">upper_threshold</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Upper threshold for outlier: 8.434516639449974
</pre></div></div>
</div>
<ul class="simple">
<li>Let’s finally create a column called <code class="docutils literal notranslate"><span class="pre">OUTLIER</span></code> which we update with <code class="docutils literal notranslate"><span class="pre">True</span></code> value, if the windspeed is an outlier, and <code class="docutils literal notranslate"><span class="pre">False</span></code>, if it is not. We do this again by iterating over the rows.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create an empty column for outlier info</span>
<span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;OUTLIER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c1"># Iterate over rows</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1"># Update the &#39;Outlier&#39; column with True if the wind speed is higher than our threshold value</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SPEED&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_threshold</span> <span class="p">:</span>
        <span class="n">hourly_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;OUTLIER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hourly_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;OUTLIER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">hourly_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           DIR      GUST     SPEED       TEMP     TEMP_C     TIME_DH  OUTLIER
0   104.666667       NaN  2.533227  58.666667  14.814815  2017080400    False
1   111.000000       NaN  3.129280  59.666667  15.370370  2017080401    False
2   119.333333   5.81152  4.321387  59.000000  15.000000  2017080402    False
3    92.666667   5.36448  3.874347  59.000000  15.000000  2017080403    False
4    87.333333   6.70560  4.619413  58.666667  14.814815  2017080404    False
5   403.000000   7.59968  5.364480  58.666667  14.814815  2017080405    False
6   110.333333  10.28192  6.854613  58.666667  14.814815  2017080406    False
7   403.000000   9.83488  6.109547  58.666667  14.814815  2017080407    False
8   405.000000   6.70560  3.874347  58.666667  14.814815  2017080408    False
9   695.666667       NaN  3.129280  59.666667  15.370370  2017080409    False
10  225.000000   5.81152  4.768427  61.666667  16.481481  2017080410    False
11  241.666667   8.49376  5.513493  64.000000  17.777778  2017080411    False
12  228.333333   6.70560  5.960533  66.000000  18.888889  2017080412    False
13  229.666667   8.94080  7.152640  67.333333  19.629630  2017080413    False
14  228.666667  12.96416  8.940800  68.333333  20.185185  2017080414     True
15  218.333333  10.72896  7.450667  66.333333  19.074074  2017080415    False
16  214.666667  10.28192  7.152640  65.666667  18.703704  2017080416    False
17  209.666667   8.94080  7.003627  63.666667  17.592593  2017080417    False
18  211.333333  10.28192  5.662507  62.333333  16.851852  2017080418    False
19  203.000000   5.81152  4.023360  61.000000  16.111111  2017080419    False
20  198.000000   5.36448  4.023360  60.666667  15.925926  2017080420    False
21  186.666667       NaN  3.874347  60.666667  15.925926  2017080421    False
22  189.000000   6.70560  4.619413  60.000000  15.555556  2017080422    False
23  193.333333   4.91744  3.725333  59.333333  15.185185  2017080423    False
</pre></div></div>
</div>
<p>Okey now we have at least many False values in our <code class="docutils literal notranslate"><span class="pre">OUTLIER</span></code> -column but there seems to be also one True!</p>
<ul class="simple">
<li>Let’s select the rows with potential storm:</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Select rows that were determined as outliers</span>
<span class="n">storm</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;OUTLIER&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">True</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">storm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           DIR      GUST   SPEED       TEMP     TEMP_C     TIME_DH  OUTLIER
14  228.666667  12.96416  8.9408  68.333333  20.185185  2017080414     True
</pre></div></div>
</div>
<p>Okey, so indeed, there was one outlier in our data but the wind during that time wasn’t that strong as the average speed was only approximately 9 m/s. This is not too strange as we were only looking at data from a single day.</p>
</div>
<div class="section" id="Repeating-the-data-analysis-with-larger-dataset">
<h2>Repeating the data analysis with larger dataset<a class="headerlink" href="#Repeating-the-data-analysis-with-larger-dataset" title="Permalink to this headline">¶</a></h2>
<p>Let’s continue by executing the steps that we have written this far and use it to explore outlier winds based on whole month of August 2017. So far, we have only processed data for one single day (4th of August).</p>
<p>For this purpose, we change the input file to be <strong>``6591337447542dat_August.txt``</strong> (full record for August 2017). You can find the file in here: <a class="reference external" href="data/6591337447542dat_August.txt">data/6591337447542dat_August.txt</a>.</p>
<ul class="simple">
<li>Here we will repeat all the steps that we did earlier in one code block so that you can see the full picture:</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Filepath</span>
<span class="n">fp</span> <span class="o">=</span> <span class="s2">&quot;data/6591337447542dat_August.txt&quot;</span>

<span class="c1"># Read data using varying amount of spaces as separator and specifying * characters as NoData values</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="s1">&#39;******&#39;</span><span class="p">])</span>

<span class="c1"># Select only specific columns</span>
<span class="n">select_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">,</span> <span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">,</span><span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">select_cols</span><span class="p">]</span>

<span class="c1"># Rename the columns</span>
<span class="n">name_conversion_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;YR--MODAHRMN&#39;</span><span class="p">:</span> <span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;SPD&#39;</span><span class="p">:</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUS&#39;</span><span class="p">:</span> <span class="s1">&#39;GUST&#39;</span><span class="p">}</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">name_conversion_dict</span><span class="p">)</span>

<span class="c1"># Create column</span>
<span class="n">col_name</span> <span class="o">=</span> <span class="s1">&#39;TEMP_C&#39;</span>
<span class="n">data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c1"># Iterete over rows and convert tempetarues from Fahrenheits to Celsius</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">celsius</span> <span class="o">=</span> <span class="n">fahr_to_celsius</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;TEMP&#39;</span><span class="p">])</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">celsius</span>

<span class="c1"># Convert wind speeds from miles to meters per second</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;SPEED&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;SPEED&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">0.44704</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;GUST&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;GUST&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">0.44704</span>

<span class="c1"># Convert TIME to string and parse date and hour info from the time</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_DH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TIME_STR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Create empty column for aggregated data</span>
<span class="n">hourly_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># Specify the columns which will be used in calculation</span>
<span class="n">mean_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;SPEED&#39;</span><span class="p">,</span> <span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_C&#39;</span><span class="p">]</span>

<span class="c1"># Group the values by hour</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;TIME_DH&#39;</span><span class="p">)</span>

<span class="c1"># Iterate over groups and update the aggregated DataFrame</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="c1"># Calculate the mean values</span>
    <span class="n">mean_values</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="n">mean_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># Add the time to the Series</span>
    <span class="n">mean_values</span><span class="p">[</span><span class="s1">&#39;TIME_DH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

    <span class="c1"># Add the aggregated values into the DataFrame</span>
    <span class="n">hourly_data</span>  <span class="o">=</span> <span class="n">hourly_data</span> <span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_values</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Calculate the outlier threshold for the new dataset</span>
<span class="n">std_wind</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;SPEED&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">avg_wind</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;SPEED&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">upper_threshold</span> <span class="o">=</span> <span class="n">avg_wind</span> <span class="o">+</span> <span class="p">(</span><span class="n">std_wind</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Detect the outliers</span>
<span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;OUTLIER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SPEED&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_threshold</span><span class="p">:</span>
        <span class="n">hourly_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;OUTLIER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hourly_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;OUTLIER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>

<span class="c1"># Select days with strong winds</span>
<span class="n">storm</span> <span class="o">=</span> <span class="n">hourly_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hourly_data</span><span class="p">[</span><span class="s1">&#39;OUTLIER&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">True</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>After running the analysis with our new dataset, let’s explore and see we have.</p>
<ul class="simple">
<li>Let’s start by checking if the average and standard deviation of the windspeed differ from the previous ones</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Windspeed statistics</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Std:&#39;</span><span class="p">,</span> <span class="n">std_wind</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">avg_wind</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Std: 2.1405899770297245
Mean: 4.1990832704402505
</pre></div></div>
</div>
<p>Okey so they are indeed different now! With larger dataset the average wind speed is 4.2 m/s (compared to 5.2 m/s previously).</p>
<ul class="simple">
<li>Let’s see what we have now in our <strong>``storm``</strong> -variable.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">storm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
            DIR      GUST      SPEED       TEMP     TEMP_C     TIME_DH  \
10   210.666667  12.51712   9.089813  73.000000  22.777778  2017080110
11   212.000000  11.62304   8.940800  73.000000  22.777778  2017080111
12   205.666667  12.51712   9.089813  72.333333  22.407407  2017080112
86   228.666667  12.96416   8.940800  68.333333  20.185185  2017080414
104  204.333333  11.17600   8.791787  67.666667  19.814815  2017080508
132  237.666667  13.85824   9.387840  61.333333  16.296296  2017080612
230  217.000000  12.51712   8.642773  71.000000  21.666667  2017081014
280  700.666667  26.82240   8.791787  66.333333  19.074074  2017081216
301  210.000000       NaN   9.611360  69.000000  20.555556  2017081313
302  200.000000       NaN   8.493760  67.000000  19.444444  2017081314
444  195.666667  10.72896   8.493760  71.666667  22.037037  2017081914
445  204.666667  12.51712   8.940800  69.666667  20.925926  2017081915
559  328.666667  13.41120   8.493760  58.666667  14.814815  2017082409
560  329.333333  13.85824   8.493760  60.666667  15.925926  2017082410
563  329.666667  13.41120   9.238827  61.333333  16.296296  2017082413
564  550.000000       NaN   8.493760  59.333333  15.185185  2017082414
686  214.000000  13.41120   9.089813  63.000000  17.222222  2017082916
687  210.666667  11.62304   8.791787  62.666667  17.037037  2017082917
704  203.666667   8.04672   8.493760  65.333333  18.518519  2017083010
705  218.333333  13.41120   8.940800  66.000000  18.888889  2017083011
706  215.666667  14.52880  10.579947  64.333333  17.962963  2017083012
707  217.666667  12.07008   9.089813  64.333333  17.962963  2017083013

     OUTLIER
10      True
11      True
12      True
86      True
104     True
132     True
230     True
280     True
301     True
302     True
444     True
445     True
559     True
560     True
563     True
564     True
686     True
687     True
704     True
705     True
706     True
707     True
</pre></div></div>
</div>
<p>Okey, interesting! Now we can see the the days and hours when it has been stormy in August 2017. It seems that the storms have usually been during the day time. Let’s check if this is the case.</p>
<p>We can easily count how many stormy observations for different hour of the day there has been by using a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.value_counts.html">**``value_counts()``**</a> -function that calculates how many observations per certain value there are in a certain column (works best for categorigal data).</p>
<ul class="simple">
<li>Let’s see the counts for different hours of the day</li>
</ul>
<p>The average wind speed may not be the perfect measure to find extreme weather conditions. Gust might usually be a better measure for that purpose.</p>
<ul class="simple">
<li>Let’s see what were the strongest gust winds in our dataset by sorting the values using <strong>``sort_values()``</strong> -function.</li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Sort values in descending order</span>
<span class="n">gust_sort</span> <span class="o">=</span> <span class="n">storm</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;GUST&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># Let&#39;s see what we have</span>
<span class="k">print</span><span class="p">(</span><span class="n">gust_sort</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
            DIR      GUST      SPEED       TEMP     TEMP_C     TIME_DH  \
280  700.666667  26.82240   8.791787  66.333333  19.074074  2017081216
706  215.666667  14.52880  10.579947  64.333333  17.962963  2017083012
132  237.666667  13.85824   9.387840  61.333333  16.296296  2017080612
560  329.333333  13.85824   8.493760  60.666667  15.925926  2017082410
559  328.666667  13.41120   8.493760  58.666667  14.814815  2017082409
705  218.333333  13.41120   8.940800  66.000000  18.888889  2017083011
686  214.000000  13.41120   9.089813  63.000000  17.222222  2017082916
563  329.666667  13.41120   9.238827  61.333333  16.296296  2017082413
86   228.666667  12.96416   8.940800  68.333333  20.185185  2017080414
10   210.666667  12.51712   9.089813  73.000000  22.777778  2017080110
445  204.666667  12.51712   8.940800  69.666667  20.925926  2017081915
230  217.000000  12.51712   8.642773  71.000000  21.666667  2017081014
12   205.666667  12.51712   9.089813  72.333333  22.407407  2017080112
707  217.666667  12.07008   9.089813  64.333333  17.962963  2017083013
11   212.000000  11.62304   8.940800  73.000000  22.777778  2017080111
687  210.666667  11.62304   8.791787  62.666667  17.037037  2017082917
104  204.333333  11.17600   8.791787  67.666667  19.814815  2017080508
444  195.666667  10.72896   8.493760  71.666667  22.037037  2017081914
704  203.666667   8.04672   8.493760  65.333333  18.518519  2017083010
301  210.000000       NaN   9.611360  69.000000  20.555556  2017081313
302  200.000000       NaN   8.493760  67.000000  19.444444  2017081314
564  550.000000       NaN   8.493760  59.333333  15.185185  2017082414

     OUTLIER
280     True
706     True
132     True
560     True
559     True
705     True
686     True
563     True
86      True
10      True
445     True
230     True
12      True
707     True
11      True
687     True
104     True
444     True
704     True
301     True
302     True
564     True
</pre></div></div>
</div>
<p>There! There was one hour with quite extraordinary gust wind in our data happening at 12th of August in 2017 - the day when <a class="reference external" href="https://yle.fi/uutiset/osasto/news/saturday_night_storm_downs_trees_cuts_electricity_in_the_south/9773250">Kiira hit Helsinki</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="errors.html" class="btn btn-neutral float-right" title="Dealing with errors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../lessons/L6/overview.html" class="btn btn-neutral float-left" title="Lesson overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, D. Whipp, H. Tenkanen and V. Heikinheimo, Department of Geosciences and Geography, University of Helsinki
      <span class="lastupdated">
        Last updated on Oct 07, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p> <br/> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /> </a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: develop
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../../../2017/index.html">2017</a></dd>
            <dd><a href="../../../2018/index.html">2018</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="advanced-data-processing-with-pandas.html">develop</a></dd>
            <dd><a href="../../../master/notebooks/L6/advanced-data-processing-with-pandas.html">master</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>